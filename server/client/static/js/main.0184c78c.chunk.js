(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{1053:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),c=n(111),i=n.n(c),o=(n(554),n(555),n(219)),s=n(492),l=n(491),u=n(12),d=n(91),j="SET_AUTH_USER",b="SET_AUTH_ERRORS",p="SET_AUTH_LOADING",v={isAuthenticated:!1,loading:!1,user:null,errors:null},f="GET_USERS",O="GET_USER",h="SET_USERS_ERRORS",m="SET_USERS_LOADING",x="UPDATE_USERS_LAYOUT",g={loading:!1,users:null,user:null,errors:null,layout:{openCreateDrawer:!1}},y="GET_CUSTOMERS",w="GET_CUSTOMER",S="SET_CUSTOMERS_ERRORS",C="SET_CUSTOMERS_LOADING",T="UPDATE_CUSTOMER_LAYOUT",E={loading:!1,customers:null,customer:null,errors:null,layout:{openCreateDrawer:!1}},D="GET_SUPPLIERS",I="GET_SUPPLIER",A="SET_SUPPLIERS_ERRORS",k="SET_SUPPLIERS_LOADING",_="UPDATE_SUPPLIERS_LAYOUT",R={loading:!1,suppliers:null,supplier:null,errors:null,layout:{openCreateDrawer:!1}},N="GET_INVOICES",M="GET_INVOICE",P="SET_INVOICES_ERRORS",U="SET_INVOICES_LOADING",F="GET_GROUPED_INVOICES",L="UPDATE_INVOICES_LAYOUT",V={loading:!1,invoices:null,invoice:null,grouped:{byMonth:null,byDate:null},layout:{openCreateDrawer:!1},errors:null},Y="GET_PURCHASES",H="GET_PURCHASE",q="SET_PURCHASES_ERRORS",B="SET_PURCHASES_LOADING",z="UPDATE_PURCHASES_LAYOUT",G={loading:!1,purchases:null,purchase:null,errors:null,layout:{openCreateDrawer:!1}},W="GET_PURCHASE_CATEGORIES",Q="GET_PURCHASE_CATEGORY",K="SET_PURCHASE_CATEGORIES_ERRORS",J="SET_PURCHASE_CATEGORIES_LOADING",X="UPDATE_PURCHASE_CATEGORY_LAYOUT",Z={loading:!1,purchaseCategories:null,purchaseCategory:null,layout:{openCreateDrawer:!1},errors:null},$="GET_SERVICES",ee="GET_SERVICE",te="SET_SERVICES_ERRORS",ne="SET_SERVICES_LOADING",re="UPDATE_SERVICE_LAYOUT",ae={loading:!1,services:null,service:null,layout:{openCreateDrawer:!1},errors:null},ce="GET_PRODUCTS",ie="GET_PRODUCT",oe="SET_PRODUCTS_ERRORS",se="SET_PRODUCTS_LOADING",le="UPDATE_PRODUCT_LAYOUT",ue={loading:!1,products:null,product:null,layout:{openCreateDrawer:!1},errors:null},de="DS_UPDATE_INVOICE_STATS",je="DS_UPDATE_CUSTOMER_STATS",be="DS_UPDATE_SUPPLIER_STATS",pe="DS_UPDATE_SERVICE_STATS",ve="DS_UPDATE_PURCHASES_STATS",fe="DS_UPDATE_PURCHASE_CATEGORIES_STATS",Oe="DATA_SERVICE_LOADING",he="DATA_SERVICE_ERRORS",me={loading:!1,errors:null,invoices:{},customers:{},suppliers:{},purchases:{},purchaseCategories:{},products:{}},xe="GET_QUOTES",ge="GET_QUOTE",ye="SET_QUOTES_ERRORS",we="SET_QUOTES_LOADING",Se="GET_GROUPED_QUOTES",Ce="UPDATE_QUOTES_LAYOUT",Te={loading:!1,quotes:null,quote:null,grouped:{byMonth:null,byDate:null},layout:{openCreateDrawer:!1},errors:null},Ee="GET_TRANSACTIONS",De="GET_TRANSACTION",Ie="SET_TRANSACTIONS_ERRORS",Ae="SET_TRANSACTIONS_LOADING",ke="UPDATE_TRANSACTION_LAYOUT",_e={loading:!1,transactions:null,transaction:null,layout:{openCreateDrawer:!1},errors:null},Re=Object(o.combineReducers)({AUTH:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case j:return{loading:!1,isAuthenticated:!Object(d.isEmpty)(n),user:n,errors:null};case p:return Object(u.a)({loading:!0,errors:null},e);case b:return Object(u.a)({loading:!0,errors:n},e);default:return e}},USERS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case f:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,users:n,errors:null});case O:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,user:n,errors:null});case x:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case m:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case h:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},CUSTOMERS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case y:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,customers:n,errors:null});case w:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,customer:n,errors:null});case C:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case S:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});case T:return Object(u.a)(Object(u.a)({},e),{},{layout:n,loading:!1,errors:null});default:return e}},SUPPLIERS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case D:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,suppliers:n,errors:null});case I:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,supplier:n,errors:null});case _:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case k:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case A:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},INVOICES:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case N:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,invoices:n,errors:null});case M:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,invoice:n,errors:null});case F:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,grouped:n,errors:null});case L:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case U:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case P:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},PURCHASES:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case Y:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,purchases:n,errors:null});case H:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,purchase:n,errors:null});case z:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case B:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case q:return Object(u.a)({loading:!0,errors:n},e);default:return e}},PURCHASE_CATEGORIES:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case W:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,purchaseCategories:n,errors:null});case Q:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,purchaseCategory:n,errors:null});case X:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case J:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case K:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},SERVICES:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case $:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,services:n,errors:null});case ee:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,service:n,errors:null});case re:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case ne:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case te:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},PRODUCTS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case ce:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,products:n,errors:null});case ie:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,product:n,errors:null});case le:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case se:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case oe:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},DATA_SERVICES:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case de:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:null,invoices:n});case je:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:null,customers:n});case be:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:null,suppliers:n});case pe:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:null,services:n});case ve:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:null,purchases:n});case fe:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:null,purchaseCategories:n});case Oe:return Object(u.a)(Object(u.a)({},e),{},{loading:!0});case he:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},QUOTES:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case xe:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,quotes:n,errors:null});case ge:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,quote:n,errors:null});case Se:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,grouped:n,errors:null});case Ce:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case we:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case ye:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}},TRANSACTIONS:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0,n=t.payload,r=t.type;switch(r){case Ee:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,transactions:n,errors:null});case De:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,transaction:n,errors:null});case ke:return Object(u.a)(Object(u.a)({},e),{},{layout:n});case Ae:return Object(u.a)(Object(u.a)({},e),{},{loading:!0,errors:null});case Ie:return Object(u.a)(Object(u.a)({},e),{},{loading:!1,errors:n});default:return e}}}),Ne=Object(o.createStore)(Re,{},Object(l.composeWithDevTools)(Object(o.applyMiddleware)(s.a))),Me=n(47),Pe=n(17),Ue=function(e){return e.AUTH},Fe=function(e){return e.USERS},Le=function(e){return e.CUSTOMERS},Ve=function(e){return e.SUPPLIERS},Ye=function(e){return e.INVOICES},He=function(e){return e.PURCHASES},qe=function(e){return e.PURCHASE_CATEGORIES},Be=function(e){return e.SERVICES},ze=function(e){return e.PRODUCTS},Ge=function(e){return e.DATA_SERVICES},We=function(e){return e.QUOTES},Qe=function(e){return e.TRANSACTIONS},Ke=n(22),Je=n(108),Xe=n(517),Ze=n(0),$e=["name"],et=function(e){var t=e.name,n=Object(Je.a)(e,$e),r=Xe[t];return Object(Ze.jsx)(r,Object(u.a)({},n))},tt=n(518),nt={type:"light",primary:{main:"#102C51"},secondary:{main:"#ffc018",contrastText:"#ffffff"},error:{main:"#f07b7b",contrastText:"#ffffff"},warning:{main:"#ffc018",contrastText:"#ffffff"},info:{main:"#4e4d91",contrastText:"#ffffff"},success:{main:"#9fe691",contrastText:"#ffffff"},accent:{main:"#add8e6",contrastText:"#000000"},contrastThreshold:3,tonalOffset:.1},rt={fontFamily:["Quicksand","Nixie One","Text Me One","Faster One","Russo One",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(",")},at="'Russo One', sans-serif",ct={MuiCssBaseline:{"@global":{body:{backgroundColor:"#cccccc"},html:{webkitFontSmoothing:"auto"},"*":{"scrollbar-width":"thin"},"*::-webkit-scrollbar":{width:"4px",height:"4px"}}},MuiTypography:{h2:{fontFamily:at,fontWeight:400},h3:{fontFamily:at,fontWeight:400},h4:{fontFamily:at,fontWeight:200},h5:{color:"#7b88aa !important",fontFamily:at,fontWeight:400},body1:{fontWeight:300},body2:{fontWeight:300}},MuiOutlinedInput:{root:{borderRadius:20}},MuiButton:{root:{paddingTop:8,paddingBottom:8,borderRadius:20}}},it=n(11),ot=n(1132),st=n(1146),lt=Object(st.a)((function(e){var t;return Object(u.a)({grow:{flexGrow:1},menuButton:Object(it.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),appBar:Object(it.a)({zIndex:e.zIndex.drawer+1,height:67,justifyContent:"center"},e.breakpoints.up("md"),{marginRight:e.spacing(3),borderRadius:e.spacing(2),top:e.spacing(1)}),styledDrawer:{top:"80px !important",paddingBottom:100,height:"calc(100% - 100px) !important",right:e.spacing(2),borderRadius:e.spacing(2)},styledMenuBar:Object(it.a)({},e.breakpoints.up("md"),{borderTopLeftRadius:e.spacing(2),borderTopRightRadius:e.spacing(2),left:e.spacing(3),top:e.spacing(1),border:"solid ".concat(e.palette.primary.main," !important ")}),styledSelectedMenuItem:{backgroundColor:"#F4F4F5 !important",paddingTop:e.spacing(2),paddingBottom:e.spacing(2),color:e.palette.primary.main,textTransform:"uppercase",fontWeight:900},layoutContainer:Object(it.a)({marginTop:4*e.spacing(2)},e.breakpoints.up("sm"),{marginLeft:300,width:"auto"}),title:Object(it.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),rounded:{borderRadius:e.spacing(2)},logoText:{fontFamily:"'Faster One', cursive !important"},search:Object(it.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(ot.a)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(ot.a)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(it.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"}),sectionDesktop:Object(it.a)({display:"none"},e.breakpoints.up("md"),{display:"flex"}),sectionMobile:Object(it.a)({display:"flex"},e.breakpoints.up("md"),{display:"none"}),productPageContainer:{marginTop:100,padding:e.spacing(2)},productGalleryContainer:(t={},Object(it.a)(t,e.breakpoints.up("sm"),{height:510}),Object(it.a)(t,e.breakpoints.down("sm"),{height:280}),t),productDescriptionContainer:{overflowY:"scroll",height:160},productTitleContainer:{textOverflow:"ellipsis",overflow:"hidden",maxHeight:50},hoverOverlay:{height:"100%",width:"100%",backgroundColor:e.palette.primary.main,opacity:.8},rowCenterContent:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"},columnCenterContent:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},rowLeftContent:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"left"}},function(e){for(var t={},n=1;n<10;n++)t["p".concat(n)]={padding:e.spacing(n)},t["pt".concat(n)]={paddingTop:e.spacing(n)},t["pb".concat(n)]={paddingBottom:e.spacing(n)},t["pl".concat(n)]={paddingLeft:e.spacing(n)},t["pr".concat(n)]={paddingRight:e.spacing(n)},t["pv".concat(n)]={paddingTop:e.spacing(n),paddingBottom:e.spacing(n)},t["ph".concat(n)]={paddingRight:e.spacing(n),paddingLeft:e.spacing(n)},t["fw".concat(n)]={fontWeight:100*n},t["fs".concat(n)]={fontSize:"".concat(10*n,"px !important")},t["m".concat(n)]={margin:e.spacing(n)},t["mt".concat(n)]={marginTop:e.spacing(n)},t["mb".concat(n)]={marginBottom:e.spacing(n)},t["ml".concat(n)]={marginLeft:e.spacing(n)},t["mr".concat(n)]={marginRight:e.spacing(n)};return t}(e))})),ut=Object(tt.a)({palette:nt,typography:rt,overrides:ct,props:{MuiTypography:{variantMapping:{h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h3",subtitle2:"h5",body1:"p",body2:"span"}}},spacing:8,shape:{borderRadius:10}}),dt=n(1163),jt=n(1068),bt={line1:"24 Wood Street",line2:"Park Village",city:"Wolverhampton",postalCode:"WV10 9DS"},pt={name:"AutoPro Fit",appLogo:"https://maneja-assets.s3.eu-west-2.amazonaws.com/appLogo.jpeg",address:bt,departments:[{name:"AutoPro Fit",displayName:"AutoPro Fit Ltd",defaultServiceId:"615f23ebb8720fd0a1f5a874",logo:"https://maneja-assets.s3.eu-west-2.amazonaws.com/appLogo.jpeg",showOnInvoice:!0,invoicesVatExempt:!1,invoice:{address:bt,email:"autoprofit@hotmail.co.uk",phone:"01902 863641",vatNo:"175754180",bank:{name:"HSBC",account:"02798662",sortCode:"40-47-11"}}},{name:"MOT",displayName:"MOTS Testing Ltd",defaultServiceId:"615f23d32644b6080380bb97",logo:"https://maneja-assets.s3.eu-west-2.amazonaws.com/motLogo.png",showOnInvoice:!0,invoicesVatExempt:!0,invoice:{address:bt,email:"mottestingltd@hotmail.com",phone:"",vatNo:"",bank:{name:"Natwest",account:"83311467",sortCode:"55-70-46"}}}]},vt=!0,ft=function(){var e=lt();return Object(Ze.jsx)(dt.a,{children:pt.appLogo?Object(Ze.jsx)("img",{src:pt.appLogo,alt:"app logo",width:"100%",className:e.rounded}):Object(Ze.jsx)(jt.a,{className:e.logoText,variant:"h6",color:"primary",children:pt.name})})},Ot=function(){return Object(Ze.jsx)(dt.a,{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:"LOADING PLEASE WAIT"})},ht=n(1147),mt=["variant","fullWidth","errors"],xt=function(e){var t=e.variant,n=e.fullWidth,r=e.errors,a=Object(Je.a)(e,mt);return Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(ht.a,Object(u.a)(Object(u.a)({},a),{},{size:"small",variant:t,fullWidth:n,error:Boolean(r),helperText:r}))})};xt.defaultProps={value:"",variant:"outlined",fullWidth:!0,errors:null};var gt=xt,yt=n(1166),wt=n(1151),St=["checked","handleChange","name","label"],Ct=function(e){var t=e.checked,n=e.handleChange,r=e.name,a=e.label,c=Object(Je.a)(e,St);return Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(yt.a,{control:Object(Ze.jsx)(wt.a,Object(u.a)({checked:t,onChange:n,name:r,color:"primary"},c)),label:a})})};Ct.defaultProps={checked:!1};var Tt=Ct,Et=n(1152),Dt=["name","label","handleChange","options","placeholder","defaultValue","isMulti"],It=function(e){var t=e.name,n=e.label,r=e.handleChange,a=e.options,c=e.placeholder,i=e.defaultValue,o=e.isMulti,s=Object(Je.a)(e,Dt);return delete s.value,Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(Et.a,Object(u.a)(Object(u.a)({multiple:o,id:t,size:"small",options:[{label:"Select One",value:""}].concat(Object(Me.a)(a)),getOptionLabel:function(e){return e.label||""},value:(i?a.filter((function(e){return e.value===i}))[0]:null)||{},onChange:r},s),{},{renderInput:function(e){return Object(Ze.jsx)(ht.a,Object(u.a)(Object(u.a)({},e),{},{label:n,placeholder:c,variant:"outlined"}))}}))})};It.defaultProps={isMulti:!1,placeholder:"Select One",defaultValue:null};var At=It,kt=n(1143),_t=n(519),Rt=n(1144),Nt=function(e){var t=e.label,n=e.name,r=e.errors,a=e.value,c=e.onChange;return Object(Ze.jsx)(_t.a,{dateAdapter:kt.a,children:Object(Ze.jsx)(Rt.a,{mask:"__/__/____",label:t,displayStaticWrapperAs:"desktop",openTo:"day",name:n,value:a,onChange:c,allowKeyboardControl:!1,inputFormat:"dd/MM/yyyy",renderInput:function(e){return Object(Ze.jsx)(ht.a,Object(u.a)({fullWidth:!0,error:Boolean(r),helperText:r,size:"small"},e))}})})},Mt=n(1150),Pt=n(1158),Ut=n(1164),Ft=n(1134),Lt=function(e){var t=e.options,n=e.onChange,r=e.label,a=e.name,c=e.value;return Object(Ze.jsxs)(Ut.a,{component:"fieldset",children:[r&&Object(Ze.jsx)(Ft.a,{component:"legend",children:r}),Object(Ze.jsx)(Pt.a,{row:!0,"aria-label":r||a,name:a,onChange:n,value:c,children:null===t||void 0===t?void 0:t.map((function(e){var t=e.value,n=e.label,r=e.isDisabled;return Object(Ze.jsx)(yt.a,{value:t,control:Object(Ze.jsx)(Mt.a,{}),disabled:r,label:n},t)}))})]})};Lt.defaultProps={label:null};var Vt=Lt,Yt=n(1157),Ht=n(1159),qt=n(1167),Bt=n(1160),zt=function(e){var t=e.openButtonText,n=e.openButtonIcon,a=e.children,c=e.open,i=e.handleOpen,o=e.handleClose,s=e.tooltip,l=e.width,u=Object(r.useState)(c),d=Object(Pe.a)(u,2),j=d[0],b=d[1],p=lt();return Object(r.useEffect)((function(){b(c)}),[c]),Object(Ze.jsxs)("div",{children:[t&&Object(Ze.jsx)(Yt.a,{onClick:function(){b(!0),i&&i()},color:"primary",variant:"contained",children:t}),n&&Object(Ze.jsx)(Ht.a,{title:s,children:Object(Ze.jsx)(qt.a,{size:"small",onClick:function(){b(!0),i&&i()},children:Object(Ze.jsx)(et,{size:"small",color:"primary",name:n})})}),Object(Ze.jsx)(Bt.a,{anchor:"right",open:j,classes:{paper:p.styledDrawer},children:Object(Ze.jsxs)(dt.a,{width:l,p:2,height:"inherit",children:[Object(Ze.jsx)(dt.a,{style:{position:"absolute",top:10,right:10},children:Object(Ze.jsx)(qt.a,{onClick:function(){b(!1),o&&o()},children:Object(Ze.jsx)(et,{name:"Close"})})}),Object(Ze.jsx)(dt.a,{styles:{paddingBottom:400},children:a})]})})]})};zt.defaultProps={open:!1,handleOpen:null,handleClose:null,width:450,tooltip:""};var Gt=zt,Wt=n(1156),Qt=n(1170),Kt=n(113),Jt=["label","size","options","name","component"],Xt=function(e){var t=e.title,n=e.formFields,r=e.submitButtonText,a=e.initialValues,c=e.validationSchema,i=e.handleSubmit,o=lt();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsxs)(Wt.a,{container:!0,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,className:o.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Kt.b,{validationSchema:c,initialValues:a,onSubmit:i,children:function(e){var t=e.errors,a=e.values,c=e.handleChange,i=e.setFieldValue,s=e.handleSubmit;return Object(Ze.jsxs)(Kt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,spacing:1,children:n.map((function(e){var n=e.label,r=e.size,s=e.options,l=e.name,d=e.component,j=Object(Je.a)(e,Jt);return Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,sm:(null===r||void 0===r?void 0:r.sm)||12,md:(null===r||void 0===r?void 0:r.md)||12,children:["MuiTextField"===d&&Object(Ze.jsx)(gt,Object(u.a)({className:o.mt2,label:n,value:a[l],errors:t[l],onChange:c,name:l,fullWidth:!0},j)),"MuiSelectField"===d&&Object(Ze.jsx)(At,Object(u.a)({className:o.mt2,label:n,handleChange:function(e,t){return i(l,(null===t||void 0===t?void 0:t.value)||"")},defaultValue:a[l],name:l,options:s},j)),"MuiCheckBox"===d&&Object(Ze.jsx)(dt.a,{className:o.pt2,children:Object(Ze.jsx)(Tt,Object(u.a)({label:n,handleChange:function(e,t){i(l,t)},checked:a[l],name:l},j))}),"MuiDatepicker"===d&&Object(Ze.jsx)(dt.a,{className:o.pt2,children:Object(Ze.jsx)(Nt,Object(u.a)({label:n,onChange:function(e){i(l,e)},name:l,value:a[l]},j))})]},l)}))}),Object(Ze.jsx)(Yt.a,{className:o.mt2,onClick:s,variant:"contained",color:"primary",type:"submit",fullWidth:!0,children:r})]})}})})]})})};Xt.defaultProps={submitButtonText:"Submit"};var Zt=Xt,$t=n(1148),en=n(1171),tn=["children","value","index"],nn=function(e){var t=e.children,n=e.value,r=e.index,a=Object(Je.a)(e,tn);return Object(Ze.jsx)("div",Object(u.a)(Object(u.a)({role:"tabpanel",hidden:n!==r,id:r,"aria-labelledby":"tab-".concat(r)},a),{},{children:n===r&&Object(Ze.jsx)(dt.a,{children:t})}))},rn=function(e){var t=e.content,n=r.useState(0),a=Object(Pe.a)(n,2),c=a[0],i=a[1];return Object(Ze.jsxs)(dt.a,{sx:{width:"100%"},children:[Object(Ze.jsx)(dt.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(Ze.jsx)($t.a,{value:c,onChange:function(e,t){i(t)},"aria-label":"basic tabs example",children:t.map((function(e,t){var n=e.label;return Object(Ze.jsx)(en.a,{label:n,id:t,"aria-controls":"tab-".concat(t)},t)}))})}),t.map((function(e,t){var n=e.tabContent;return Object(Ze.jsx)(nn,{value:c,index:t,children:n},t)}))]})},an=function(e){var t=e.title,n=e.info,r=lt();return Object(Ze.jsxs)(Ze.Fragment,{children:[Object(Ze.jsxs)(dt.a,{className:r.pt1,display:"flex",flexDirection:"row",justifyContent:"space-between",children:[Object(Ze.jsx)(jt.a,{children:t}),Object(Ze.jsx)(jt.a,{children:n})]}),Object(Ze.jsx)(Qt.a,{})]})},cn=function(e){var t=e.data;return Object(Ze.jsx)(Ze.Fragment,{children:t.map((function(e){var t=e.title,n=e.info;return Object(Ze.jsx)(an,{title:t,info:n},t)}))})},on=n(1153),sn=n(1172),ln=n(1173),un=function(e){var t=e.items;return Object(Ze.jsx)("div",{children:null===t||void 0===t?void 0:t.map((function(e){return Object(Ze.jsxs)(on.a,{children:[Object(Ze.jsx)(sn.a,{expandIcon:Object(Ze.jsx)(et,{name:"ExpandMore"}),"aria-controls":"panel1a-content",id:"panel1a-header",children:Object(Ze.jsx)(jt.a,{children:e.title})}),Object(Ze.jsx)(ln.a,{children:e.details})]},e.key)}))})},dn=n(523),jn=n(110),bn=n(499),pn=n.n(bn),vn=function(e){var t=e.placeholder,n=e.handleSearch,a=e.handleClear,c=Object(r.useState)(""),i=Object(Pe.a)(c,2),o=i[0],s=i[1];return Object(Ze.jsxs)(dn.a,{component:"form",variant:"outlined",elevation:0,sx:{p:"2px 4px",display:"flex",alignItems:"center",width:"100%"},children:[Object(Ze.jsx)(jn.c,{sx:{ml:1,flex:1},placeholder:t,inputProps:{"aria-label":"search google maps"},value:o,onChange:function(e){return s(e.target.value)}}),Object(Ze.jsx)(qt.a,{type:"submit",sx:{p:"10px"},"aria-label":"search",onClick:function(){return n(o)},children:Object(Ze.jsx)(pn.a,{})}),Object(Ze.jsx)(Qt.a,{sx:{height:28,m:.5},orientation:"vertical"}),Object(Ze.jsx)(qt.a,{color:"primary",sx:{p:"10px"},"aria-label":"directions",onClick:function(){s(""),a()},children:Object(Ze.jsx)(et,{name:"Clear"})})]})},fn=n(1139),On=n(1168),hn=n(1169),mn=n(1174),xn=n(1140),gn=function(e){var t=e.content,n=e.title,a=e.handleConfirm,c=e.ActionButton,i=e.confirmButton,o=e.declineButton,s=Object(r.useState)(!1),l=Object(Pe.a)(s,2),u=l[0],d=l[1],j=function(){d(!1)};return Object(Ze.jsxs)(dt.a,{p:2,children:[c.icon&&Object(Ze.jsx)(qt.a,{onClick:function(){return d(!0)},children:Object(Ze.jsx)(et,{size:"small",color:"primary",name:"Delete"})}),Object(Ze.jsxs)(fn.a,{open:u,onClose:j,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[n&&Object(Ze.jsx)(xn.a,{id:"alert-dialog-title",children:n}),t&&Object(Ze.jsx)(hn.a,{children:Object(Ze.jsx)(mn.a,{id:"alert-dialog-description",children:t})}),Object(Ze.jsxs)(On.a,{children:[Object(Ze.jsx)(Yt.a,{variant:"outlines",color:"primary",onClick:j,children:o}),Object(Ze.jsx)(Yt.a,{variant:"contained",color:"primary",onClick:function(){j(),a()},children:i})]})]})]})};gn.defaultProps={actionButton:"Open",confirmButton:"Agree",declineButton:"Close"};var yn=gn,wn=function(e){var t=e.children,n=Object(r.useState)(!0),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(Ke.c)(Ue).loading;return Object(r.useEffect)((function(){i(o)}),[o]),c?Object(Ze.jsx)(Ot,{}):Object(Ze.jsx)("div",{children:t})},Sn=n(80),Cn=function(){var e=Object(Sn.g)();return Object(Ze.jsx)(Yt.a,{variant:"contained",color:"primary",onClick:function(){return e.goBack()},children:"BACK"})},Tn=n(75),En=["component"],Dn=function(e){var t=e.component,n=Object(Je.a)(e,En),r=Object(Ke.c)(Ue).isAuthenticated;return Object(Ze.jsx)(Sn.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){return function(e){return r?Object(Ze.jsx)(Sn.a,{to:"/home"}):Object(Ze.jsx)(t,Object(u.a)({},e))}(e)}}))},In=n(9),An=n(20),kn=n(36),_n=n.n(kn),Rn=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("authentication/sign-in",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Nn=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("authentication/request-password-reset",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mn=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("authentication/reset-password/".concat(t.token),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Pn=function(e){e?_n.a.defaults.headers.common.Authorization=e:delete _n.a.defaults.headers.common.Authorization},Un=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n?(null===e||void 0===e?void 0:e.reduce((function(e,r){return r[t]?e+r[t][n]:e}),0))||0:(null===e||void 0===e?void 0:e.reduce((function(e,n){return e+n[t]}),0))||0},Fn=function(e){if("number"!==typeof parseInt(e)||!e)return"0";if(e<999)return e;var t=Math.floor((""+e.toFixed(0)).length/3),n=parseFloat((0!=t?e/Math.pow(1e3,t):e).toPrecision(2));return n%1!=0&&(n=n.toFixed(1)),n+[""," K"," M"," N"," T"][t]},Ln=function(e){return Fn(e)},Vn=function(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e-1]},Yn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e;return n&&(r-=40),t&&(r-=40),r},Hn=function(e){return[{title:"Email",info:e.email},{title:"Phone",info:e.phone},{title:"Location",info:"\n            ".concat((null===e||void 0===e?void 0:e.addessLine1)||""," \n            ").concat((null===e||void 0===e?void 0:e.addessLine2)||"","\n            ").concat((null===e||void 0===e?void 0:e.town)||""," \n \n            ").concat(e.postalCode||"")},{title:"Account Type",info:e.customerType},{title:"Is Credit Account",info:e.creditAccount?"Yes":"No"},{title:"Payment Terms",info:e.paymentTerms},{title:"Account Status",info:e.active?"Active":"In Active"},{title:"High Value Customer",info:e.highValue?"Yes":"No"}]},qn=function(e){var t=e.payments,n=e.balancePayable;return!(!t.paidInFull||n>0)},Bn=function(e,t,n,r){return e({type:n,payload:Object(u.a)(Object(u.a)({},t),{},{openCreateDrawer:r})})},zn=function(e){return e?e.map((function(e){var t=e._id,n=e.name,r=e.email;return{value:t,label:"".concat(n," - ").concat(r)}})):[]},Gn=function(e){return e?e.map((function(e){return{value:e._id,label:e.title}})):[{label:"Select One",value:"-"}]},Wn=function(e,t,n){return e?e.map((function(e){return{value:e[n],label:e[t]}})):[{label:"Select One",value:"-"}]},Qn=function(e){return e.match(/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im)},Kn=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return 0;if(r)t=Fn(e);else{var a=e&&e.toFixed(n);t=new Intl.NumberFormat("en-GB").format(a)}return t},Jn=function(e){window.open(e,"_blank").focus()};function Xn(e,t,n){var r=document.createElement("CANVAS"),a=r.getContext("2d"),c=new Image;c.crossOrigin="Anonymous",c.onload=function(){r.height=c.height,r.width=c.width,a.drawImage(c,0,0);var e=r.toDataURL(n||"image/png");t(e),r=null},c.src=e}var Zn=function(e){return Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")},$n=n(299),er=n(37),tr=function(e){return function(t){t({type:b,payload:e})}},nr=function(){return function(e){e({type:j,payload:null})}},rr=function(e){return function(t){t({type:j,payload:e})}},ar=n(42),cr=ar.object().shape({email:ar.string().email("Invalid Email").required("Email is Required"),password:ar.string().min(12,"Password must be more than 12 Characters long.")}),ir=ar.object().shape({email:ar.string().email("Invalid Email").required("Email is Required")}),or=ar.object().shape({email:ar.string().email("Invalid Email").required("Email is Required"),password:ar.string().min(12,"Password must be more than 12 Characters long."),passwordConfirmation:ar.string().oneOf([ar.ref("password"),null],"Passwords must match").required("Required")}),sr=(n(160),ar.object().shape({name:ar.string().required("Full Name is Required"),phone:ar.string().phone("GB",!0,"Invalid Mobile Phone").required(),email:ar.string().email("Invalid Email").required("Email is Required"),password:ar.string().required().min(12,"Week password"),passwordConfirmation:ar.string().oneOf([ar.ref("password"),null],"Passwords must match").required("Required")})),lr=n(505),ur=n(504),dr=ar.object().shape({name:ar.string().required("Full Name is Required"),phone:ar.string().test("phone","Invalid Phone Number",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(ur.phone)(e,{country:"GB"}),n=t.isValid;return n||Qn(e)})).required(),email:ar.string().email("Invalid Email").required("Email is Required"),postalCode:ar.string().test("postalCode","Invalid Post Code ",(function(e){return Object(lr.isPostalCode)(String(e),["GB"])}))}),jr=ar.object().shape({name:ar.string().required("Full Name is Required"),town:ar.string(),phone:ar.string(),email:ar.string()}),br={customer:ar.string().required("Customer is Required"),vehicleModel:ar.string().min(1).max(64).required("Vehicle Model is Required"),vehicleReg:ar.string().min(3).max(15).required("Vehicle Reg is Required"),repairNotes:ar.string()},pr={card:ar.number(),cash:ar.number(),cheque:ar.number(),reference:ar.string()},vr=ar.object().shape(br),fr=ar.object().shape({service:ar.string().required("Select Invoice Line Service"),description:ar.string(),charged:ar.number(),addVat:ar.boolean()}),Or=ar.object().shape(pr),hr=ar.object().shape(Object(u.a)(Object(u.a)({},br),pr)),mr=ar.object().shape({invoicedTo:ar.string().required("Required"),details:ar.string().required("Required"),warranty:ar.string(),amount:ar.number().required("Required"),vat:ar.number(),total:ar.number().required("Required"),supplierInvoiceNumber:ar.string().required("Required"),supplierInvoiceDate:ar.string().required("Required"),supplier:ar.string().required("Required"),purchaseCategory:ar.string().required("Required"),invoiceLinesCount:ar.number(),invoiceLinesBilled:ar.number(),invoiceLinesDelivered:ar.number()}),xr=ar.object().shape({name:ar.string().required("Purchase Category Name is required"),description:ar.string().required("Purchase Category Description is required")}),gr=ar.object().shape({title:ar.string().required("Service Name is required"),description:ar.string().required("Service Description is required").min(32),unitPrice:ar.number(),unit:ar.string()}),yr=ar.object().shape({name:ar.string().required("Product Name is required"),description:ar.string().required("Product Description is required"),unitPrice:ar.number(),unit:ar.string()}),wr=ar.object().shape({customerRef:ar.string().required("Transaction reference is required"),amount:ar.number().required("Transaction amount is required"),date:ar.string().required("Transaction date is required")}),Sr=function(e){var t=e.children;return Object(Ze.jsx)(dt.a,{height:"100vh",width:"100vw",display:"flex",alignItems:"center",justifyContent:"center",style:{backgroundColor:"rgba(45,46,65,0.05)"},children:Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,minHeight:320,width:300,display:"flex",justifyContent:"flex-start",alignItems:"center",flexDirection:"column",children:[Object(Ze.jsx)(ft,{}),Object(Ze.jsx)(dt.a,{p:1,width:"100%",children:t})]})})})},Cr=n(163),Tr=[{component:"MuiTextField",type:"email",name:"email",label:"Email"},{component:"MuiTextField",type:"password",name:"password",label:"Password"}],Er=[{component:"MuiTextField",type:"email",name:"email",label:"Email"}],Dr=[{component:"MuiTextField",type:"email",name:"email",label:"Email"},{component:"MuiTextField",type:"password",name:"password",label:"Password"},{component:"MuiTextField",type:"password",name:"passwordConfirmation",label:"Password Confirmation"}],Ir=function(){var e=Object(Ke.b)(),t=lt(),n=Object(Sn.g)(),r=function(t){e(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a,c,i,o,s;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Rn(e);case 3:r=t.sent,a=r.data,localStorage.setItem("authToken",a),c=Object($n.a)(a),Pn(a),n(rr(c)),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),s="Failed to sign in.",er.b.error((null===t.t0||void 0===t.t0||null===(i=t.t0.response)||void 0===i?void 0:i.data)||s),n(tr((null===t.t0||void 0===t.t0||null===(o=t.t0.response)||void 0===o?void 0:o.data)||s));case 17:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()}(t))};return Object(Ze.jsxs)(Sr,{children:[Object(Ze.jsxs)(Cr.a,{children:[Object(Ze.jsx)("title",{children:"Sign In"}),Object(Ze.jsx)("meta",{name:"description",content:"Sign In to get started"})]}),Object(Ze.jsx)(dt.a,{className:t.pt3,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:Object(Ze.jsxs)(dt.a,{width:"100%",className:t.pt1,children:[Object(Ze.jsx)(Zt,{title:"Sign In",initialValues:{email:"",password:""},validationSchema:cr,onSubmit:r,formFields:Tr,submitButtonText:"SIGN IN",handleSubmit:r}),Object(Ze.jsxs)(dt.a,{className:t.p2,display:"flex",flexDirection:"column",alignItems:"center",children:[Object(Ze.jsx)(jt.a,{variant:"overline",children:"Trouble accessing your account?"}),Object(Ze.jsx)(Yt.a,{className:t.mt1,variant:"outlined",color:"primary",fullWidth:!0,onClick:function(){return n.push("/request-reset-password")},children:"RESET PASSWORD"})]})]})})]})},Ar=n(1175),kr=n(1141),_r=n(15),Rr=function(){var e=Object(r.useState)(null),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),i=Object(Pe.a)(c,2),o=i[0],s=i[1],l=Object(Sn.g)(),u=lt(),d=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,Nn(t).catch((function(e){console.error("Password Reset Error",e),a("failed"),s(!1)}));case 3:204===e.sent.status&&(a("success"),s(!1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(Ze.jsxs)(Sr,{children:[Object(Ze.jsxs)(Cr.a,{children:[Object(Ze.jsx)("title",{children:"Reset Password"}),Object(Ze.jsx)("meta",{name:"description",content:"Request password reset email."})]}),Object(Ze.jsx)(dt.a,{className:u.pt3,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:Object(Ze.jsxs)(dt.a,{width:"100%",className:u.pt1,children:[o&&Object(Ze.jsx)(dt.a,{className:Object(_r.a)(u.pt4,u.pt),children:Object(Ze.jsxs)(kr.a,{severity:"info",children:[Object(Ze.jsx)(Ar.a,{children:"Loading"}),"Sending password reset link, please wait..."]})}),!o&&(!n||"failed"===n)&&Object(Ze.jsxs)(dt.a,{children:["failed"===n&&Object(Ze.jsx)(kr.a,{severity:"error",children:"Unknown error updating password."}),Object(Ze.jsx)(Zt,{title:"Password Reset",initialValues:{email:""},validationSchema:ir,formFields:Er,submitButtonText:"GET PASSWORD RESET LINK",handleSubmit:d})]}),!o&&n&&"success"===n&&Object(Ze.jsxs)(kr.a,{severity:"success",children:[Object(Ze.jsx)(Ar.a,{children:" Success "}),"Password reset link has been sent to your email."]}),Object(Ze.jsx)(dt.a,{className:u.p2,display:"flex",flexDirection:"column",alignItems:"center",children:Object(Ze.jsx)(Yt.a,{className:u.mt1,variant:"outlined",color:"primary",fullWidth:!0,onClick:function(){return l.push("/sign-in")},children:"SIGN IN"})})]})})]})},Nr=function(){var e=Object(r.useState)(null),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),i=Object(Pe.a)(c,2),o=i[0],s=i[1],l=lt(),d=Object(Sn.i)().token,j=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,Mn(Object(u.a)(Object(u.a)({},t),{},{token:d})).catch((function(e){console.error("Password Reset Error",e),a("failed"),s(!1)}));case 3:204===e.sent.status&&(a("success"),s(!1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(Ze.jsxs)(Sr,{children:[Object(Ze.jsxs)(Cr.a,{children:[Object(Ze.jsx)("title",{children:"Reset Password"}),Object(Ze.jsx)("meta",{name:"description",content:"Request password reset email."})]}),Object(Ze.jsx)(dt.a,{className:l.pt3,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",children:Object(Ze.jsxs)(dt.a,{width:"100%",className:l.pt1,children:[o&&Object(Ze.jsx)(dt.a,{className:Object(_r.a)(l.pt2),children:Object(Ze.jsxs)(kr.a,{severity:"info",children:[Object(Ze.jsx)(Ar.a,{children:"Loading"}),"Setting new password, please wait..."]})}),!o&&(!n||"failed"===n)&&Object(Ze.jsxs)(dt.a,{children:["failed"===n&&Object(Ze.jsx)(kr.a,{severity:"error",children:"Unknown error updating password."}),Object(Ze.jsx)(Zt,{title:"Password Reset",initialValues:{email:""},validationSchema:or,formFields:Dr,submitButtonText:"RESET PASSWORD",handleSubmit:j})]}),!o&&n&&"success"===n&&Object(Ze.jsx)(dt.a,{className:Object(_r.a)(l.pt2),children:Object(Ze.jsxs)(kr.a,{severity:"success",children:[Object(Ze.jsx)(Ar.a,{children:" Success "}),"Password reset successfuly, please sign in."]})}),Object(Ze.jsx)(dt.a,{className:l.p2,display:"flex",flexDirection:"column",alignItems:"center",children:Object(Ze.jsx)(Yt.a,{className:l.mt1,variant:"outlined",color:"primary",fullWidth:!0,onClick:function(){return history.push("/sign-in")},children:"SIGN IN"})})]})})]})},Mr=function(){return[Object(Ze.jsx)(Dn,{path:"/sign-in",exact:!0,component:Ir},"sign-in"),Object(Ze.jsx)(Dn,{path:"/request-reset-password",exact:!0,component:Rr},"password"),Object(Ze.jsx)(Dn,{path:"/reset-password/:token",exact:!0,component:Nr},"reset-password")]},Pr=["component"],Ur=function(e){var t=e.component,n=Object(Je.a)(e,Pr),r=Object(Ke.c)(Ue).isAuthenticated;return Object(Ze.jsx)(Sn.b,Object(u.a)(Object(u.a)({},n),{},{render:function(e){return function(e){return r?Object(Ze.jsx)(t,Object(u.a)({},e)):Object(Ze.jsx)(Sn.a,{to:"/sign-in"})}(e)}}))},Fr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/count");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Lr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/total");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Vr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/unpaid-total");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Yr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/by-month");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Hr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/by-year");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),qr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/top-by-customers");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Br=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n()("/data-service/invoices/by-date");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),zr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/customers/count"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Gr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/customers/count-by-type"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Wr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/suppliers/count"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Qr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/services/count"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Kr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/purchases/count"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Jr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/purchases/total"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Xr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/purchases/by-month"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Zr=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/purchases/by-year"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$r=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/purchases/by-category"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ea=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_n()("/data-service/purchases/by-supplier"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ta=function(){return function(e){e({type:Oe,payload:!0})}},na=function(e){return function(t){t({type:he,payload:e})}},ra=n(1142),aa=n(1177),ca=n(1176),ia=function(e){var t=e.handleDrawerToggle,n=e.title,r=e.drawerWidth,a=e.mobileOpen,c=lt(),i=Object(Ke.b)();return Object(Ze.jsx)(ca.a,{position:"absolute",sx:{width:{sm:"calc(100% - ".concat(a?r:0,"px)"),md:"calc(100% - ".concat(r+60,"px)")},ml:{sm:"".concat(a?r:0,"px"),md:"".concat(r,"px")}},className:c.appBar,children:Object(Ze.jsxs)(aa.a,{children:[Object(Ze.jsx)(qt.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:t,sx:{mr:2},children:Object(Ze.jsx)(et,{name:a?"MenuOpen":"Menu"})}),Object(Ze.jsx)(jt.a,{variant:"h6",noWrap:!0,component:"div",sx:{flexGrow:1},children:n}),Object(Ze.jsx)(Ht.a,{title:"Logout",children:Object(Ze.jsx)(qt.a,{color:"inherit",onClick:function(){return i(nr())},children:Object(Ze.jsx)(et,{name:"Logout"})})})]})})},oa=n(1165),sa=n(1154),la=n(1178),ua=n(1179),da=[{title:"Home",path:"/home",icon:"CarRepair"},{title:"Customers",path:"/customers",icon:"WorkOutline"},{title:"Invoices",path:"/invoices",icon:"Receipt"},{title:"Purchases",path:"/purchases",icon:"ShoppingBasket"},{title:"Suppliers",path:"/suppliers",icon:"BusinessCenter"},{title:"Users",path:"/users",icon:"People"},{title:"Purchase Categories",path:"/purchase-categories",icon:"ListAlt"},{title:"Services",path:"/services",icon:"HomeRepairService"},{title:"Products",path:"/products",icon:"ProductionQuantityLimits"},{title:"Weekly Sales",path:"/weekly-sales",icon:"DateRange"},{title:"Approvals",path:"/approvals",icon:"CheckBox"},{title:"Quotes",path:"/quotes",icon:"RequestQuote"},{title:"Bank Transactions",path:"/transactions",icon:"AccountBalance"}],ja=function(){var e=Object(Sn.g)(),t=lt(),n=Object(Sn.j)(),r=Object(Sn.h)().pathname,a=function(e){if(e===r||e===n.path)return!0};return Object(Ze.jsxs)("div",{children:[Object(Ze.jsx)(aa.a,{children:Object(Ze.jsx)(ft,{})}),Object(Ze.jsx)(Qt.a,{}),Object(Ze.jsx)(oa.a,{sx:{pt:0},children:da.map((function(n,r){var c=n.title,i=n.icon,o=n.path;return Object(Ze.jsxs)(sa.a,{dense:!0,button:!0,onClick:function(){return e.push(o)},selected:a(o),classes:{selected:t.styledSelectedMenuItem},children:[Object(Ze.jsx)(la.a,{children:Object(Ze.jsx)(et,{name:i})}),Object(Ze.jsx)(ua.a,{primary:c})]},r)}))})]})},ba=function(e){var t=e.window,n=e.drawerWidth,r=e.mobileOpen,a=e.handleDrawerToggle,c=e.isDesktop,i=lt(),o=void 0!==t?function(){return t().document.body}:void 0;return Object(Ze.jsx)(Bt.a,{container:o,classes:{paper:i.styledMenuBar},variant:c?"permanent":"temporary",open:r,onClose:a,ModalProps:{keepMounted:!0},sx:{display:{xs:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:n}},children:Object(Ze.jsx)(ja,{})})},pa=function(e){var t=e.title,n=e.children,a=Object(r.useState)(250),c=Object(Pe.a)(a,2),i=c[0],o=c[1],s=Object(r.useState)(!1),l=Object(Pe.a)(s,2),u=l[0],d=l[1],j=window.innerWidth;Object(r.useEffect)((function(){d(j>600)}),[]),Object(r.useEffect)((function(){o(u?250:0)}),[u]);var b=function(){d(!u)};return Object(Ze.jsxs)(dt.a,{sx:{display:"flex"},style:{minHeight:"100vh",backgroundColor:"rgba(45,46,65,0.05)"},children:[Object(Ze.jsx)(ra.a,{}),Object(Ze.jsx)(ia,{title:t,mobileOpen:u,drawerWidth:i,handleDrawerToggle:b}),Object(Ze.jsx)(dt.a,{component:"nav",sx:{width:{md:i},display:u?"block":"none",flexShrink:{sm:0}},children:Object(Ze.jsx)(ba,{isDesktop:j>900,mobileOpen:u,handleDrawerToggle:b,drawerWidth:i})}),Object(Ze.jsxs)(dt.a,{component:"main",sx:{flexGrow:1,p:3},style:{width:"100%",overflowY:"hidden"},children:[Object(Ze.jsx)(aa.a,{}),Object(Ze.jsx)(dt.a,{sx:{ml:{sm:0,md:2}},style:{width:"calc(100% - 60)px"},children:n})]})]})},va=function(e){var t=e.value,n=e.label,r=e.action,a=e.color,c=lt();return Object(Ze.jsx)(dn.a,{style:{width:"100%"},children:Object(Ze.jsxs)(dt.a,{className:Object(_r.a)(c.pv1),width:"100%",style:{position:"relative"},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",children:[Object(Ze.jsx)(dt.a,{width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",children:Object(Ze.jsx)(jt.a,{color:a,variant:"h3",noWrap:!0,style:{textOverflow:"ellipsis"},children:t})}),Object(Ze.jsx)(jt.a,{color:a,variant:"subtitle1",style:{textTransform:"uppercase"},children:n}),r&&Object(Ze.jsx)(dt.a,{style:{position:"absolute",zIndex:1,bottom:5,right:6},children:Object(Ze.jsx)(Ht.a,{title:r.tooltip||"",children:Object(Ze.jsx)(qt.a,{size:"small",color:a,variant:"outlined",onClick:r.callback,children:Object(Ze.jsx)(et,{name:r.icon})})})})]})})};va.defaultProps={color:"primary"};var fa=va,Oa=n(307),ha=n(120),ma=Object(ha.a)(),xa=function(e){var t=e.title,n=e.footer,r=e.height,a=e.data,c=e.dimension,i=e.measure,o=lt(),s={labels:null===a||void 0===a?void 0:a.map((function(e){return e[c.field]})),datasets:[{label:i.label,data:null===a||void 0===a?void 0:a.map((function(e){return e[i.field]})),fill:!1,backgroundColor:"#102C51",borderColor:"#102C51",cubicInterpolationMode:"monotone",tension:.4}]};return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:1,children:[t&&Object(Ze.jsx)(dt.a,{classes:o.pv2,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t})}),Object(Ze.jsx)(dt.a,{height:Yn(r,t,n),children:Object(Ze.jsx)(Oa.b,{id:ma,width:"100%",height:"100%",redraw:!1,data:s,options:{responsive:!0,maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!1}}]}}})}),n&&Object(Ze.jsx)(dt.a,{classes:o.pv2,children:Object(Ze.jsx)(jt.a,{variant:"body2",children:n})})]})})};xa.defaultProps={title:"",showTooltip:!1};var ga=xa,ya=Object(ha.a)(),wa=function(e){var t=e.title,n=e.footer,r=e.height,a=e.data,c=e.dimension,i=e.measure,o=lt(),s={labels:null===a||void 0===a?void 0:a.map((function(e){return e[c.field]})),datasets:[{label:i.label,data:null===a||void 0===a?void 0:a.map((function(e){return e[i.field]})),fill:!0,backgroundColor:"#102C51",borderColor:"#102C51",cubicInterpolationMode:"monotone",tension:.4}]};return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:1,children:[t&&Object(Ze.jsx)(dt.a,{classes:o.pv2,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t})}),Object(Ze.jsx)(dt.a,{height:Yn(r,t,n),children:Object(Ze.jsx)(Oa.a,{id:ya,width:"100%",height:"100%",redraw:!1,data:s,options:{responsive:!0,maintainAspectRatio:!1,borderRadius:20,tooltips:{enabled:!0},scales:{yAxes:[{ticks:{beginAtZero:!1}}]}}})}),n&&Object(Ze.jsx)(dt.a,{classes:o.pv2,children:Object(Ze.jsx)(jt.a,{variant:"body2",children:n})})]})})};wa.defaultProps={title:"",showTooltip:!1};var Sa=wa,Ca=n(156),Ta=n(312),Ea=n(520),Da=Object(ha.a)(),Ia=function(e){var t=e.title,n=e.data,a=e.dimension,c=e.measure,i=e.height,o=e.footer,s=e.showTooltip,l=e.legend,u=lt();Ca.d(Ea.a);var d=Ca.b(Da,Ta.b);d.data=n,d.innerRadius=Ca.c(60),d.responsive.enabled=!0,d.responsive.useDefault=!1;var j=d.series.push(new Ta.c);return j.colors.list=[Ca.a("#102C51"),Ca.a("#4e4d91"),Ca.a("#00a676"),Ca.a("#0c5776"),Ca.a("#ffc018"),Ca.a("#ff40b4")],j.dataFields.value=c.field,j.dataFields.category=a.field,j.name=t,j.slices.template.strokeOpacity=1,j.labels.template.disabled=!0,j.ticks.template.disabled=!0,j.slices.template.tooltipText=s?"{category.formatNumber('####')} : \xa3 {value.value}":"",l&&(d.legend=new Ta.a,d.legend.position=l.position,d.legend.labels.template.text="[bold {color}]{category.formatNumber('####')}[/]"),Object(r.useEffect)((function(){return function(){d.dispose()}}),[]),Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:1,children:[t&&Object(Ze.jsx)(dt.a,{classes:Object(_r.a)(u.pv2,u.ph2),children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t})}),Object(Ze.jsx)(dt.a,{height:Yn(i,t,o),children:Object(Ze.jsx)("div",{id:Da,style:{width:"100%",height:"100%"}})})]})})};Ia.defaultProps={legend:null,title:null,footer:null};var Aa=function(){var e=Object(Ke.c)(Ge),t=e.invoices,n=e.purchases,r=e.customers,a=Object(Sn.g)(),c=[{label:"Customers",value:Kn(r.count),action:{icon:"FolderOpen",tooltip:"View Customers",callback:function(){return a.push("/customers")}}},{label:"Invoices",value:Kn(t.count),action:{icon:"FolderOpen",tooltip:"View Invoices",callback:function(){return a.push("/invoices")}}},{label:"Purchases",value:Kn(n.count),action:{icon:"FolderOpen",tooltip:"View Purchases",callback:function(){return a.push("/purchases")}}},{label:"Invoice Total",value:"\xa3 ".concat(Kn(t.total,0,t.total>=1e6)),action:null},{label:"Expenses Total",value:"\xa3 ".concat(Kn(n.total,0,n.total>=1e6)),action:null},{label:"Balance Un Paid",value:"\xa3 ".concat(Kn(t.unPaidTotal,0,t.unPaidTotal>=1e6)),action:null}];return Object(Ze.jsx)(Wt.a,{container:!0,spacing:1,children:c.map((function(e,t){var n=e.label,r=e.value,a=e.action;return Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:6,md:4,children:Object(Ze.jsx)(fa,{label:n,value:r,action:a})},t)}))})},ka=function(){var e,t,n,r,a=Object(Ke.c)(Ge).invoices;return Object(Ze.jsxs)(Wt.a,{container:!0,spacing:2,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h4",children:"Invoices"})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:6,xs:12,children:(null===a||void 0===a?void 0:a.byMonth)&&Object(Ze.jsx)(ga,{data:null===a||void 0===a||null===(e=a.byMonth)||void 0===e?void 0:e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{month:Vn(e._id)})})),title:"Monthly Invoice Total (\xa3)",height:300,dimension:{label:"Month",field:"month",grid:12},measure:{label:"\xa3 Total Sales",field:"sum"},showTooltip:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:6,xs:12,children:(null===a||void 0===a?void 0:a.byMonth)&&Object(Ze.jsx)(Sa,{data:null===a||void 0===a||null===(t=a.byMonth)||void 0===t?void 0:t.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{month:Vn(e._id)})})),title:"Monthly Invoices",height:300,dimension:{label:"Month",field:"month",grid:12},measure:{label:"# Invoices",field:"count"},showTooltip:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:4,xs:12,children:(null===a||void 0===a?void 0:a.byYear)&&Object(Ze.jsx)(Sa,{data:null===a||void 0===a||null===(n=a.byYear)||void 0===n?void 0:n.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{year:String(e._id)})})),title:"Yearly Invoice Total (\xa3)",height:300,dimension:{label:"Year",field:"_id",grid:12},measure:{label:"\xa3 Total Sales",field:"sum"},showTooltip:!0,legend:{position:"right"}})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:8,xs:12,children:(null===a||void 0===a?void 0:a.topByCustomers)&&Object(Ze.jsx)(Sa,{chartId:Object(ha.a)(),data:null===a||void 0===a||null===(r=a.topByCustomers)||void 0===r?void 0:r.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{customer:e.customer.name})})),title:"Top 20 Customer Invoice Total",height:300,dimension:{label:"Customer",field:"customer"},measure:{label:"\xa3 Total Sales",field:"sum"},showTooltip:!0,legend:{position:"right"}})})]})},_a=function(){var e,t,n,r,a=Object(Ke.c)(Ge).purchases;return Object(Ze.jsxs)(Wt.a,{container:!0,spacing:2,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h4",children:"Purchases"})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:6,xs:12,children:(null===a||void 0===a?void 0:a.byMonth)&&Object(Ze.jsx)(ga,{data:null===a||void 0===a||null===(e=a.byMonth)||void 0===e?void 0:e.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{month:Vn(e._id)})})),title:"Monthly Expense Total (\xa3)",height:300,dimension:{label:"Month",field:"month",grid:12},measure:{label:"\xa3 Expense Total",field:"sum"},showTooltip:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:6,xs:12,children:(null===a||void 0===a?void 0:a.byMonth)&&Object(Ze.jsx)(Sa,{data:null===a||void 0===a||null===(t=a.byMonth)||void 0===t?void 0:t.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{month:Vn(e._id)})})),title:"Monthly Purchase Invoices",height:300,dimension:{label:"Month",field:"month",grid:12},measure:{label:"# Purchases",field:"count"},showTooltip:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:4,xs:12,children:(null===a||void 0===a?void 0:a.byYear)&&Object(Ze.jsx)(Sa,{data:null===a||void 0===a||null===(n=a.byYear)||void 0===n?void 0:n.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{year:String(e._id)})})),title:"Yearly Expense Total (\xa3)",height:300,dimension:{label:"Year",field:"_id",grid:12},measure:{label:"\xa3 Expense Total",field:"sum"},showTooltip:!0,legend:{position:"right"}})}),Object(Ze.jsx)(Wt.a,{item:!0,sm:6,md:8,xs:12,children:(null===a||void 0===a?void 0:a.bySupplier)&&Object(Ze.jsx)(Sa,{chartId:Object(ha.a)(),data:null===a||void 0===a||null===(r=a.bySupplier)||void 0===r?void 0:r.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{supplier:e.supplier.name})})),title:"Top 20 Expense Supplier",height:300,dimension:{label:"Supplier",field:"supplier"},measure:{label:"\xa3 Total Sales",field:"sum"},showTooltip:!0,legend:{position:"right"}})})]})},Ra=function(){var e=lt(),t=Object(Ke.b)(),n=Object(Ke.c)(Ge).loading;return Object(r.useEffect)((function(){t(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,n){var r,a,c;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ta()),e.prev=1,e.next=4,zr();case 4:return r=e.sent,e.next=7,Gr();case 7:a=e.sent,c=n().DATA_SERVICES.customers,t({type:je,payload:Object(u.a)(Object(u.a)({},c),{},{count:r.data,countByType:a.data})}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),er.b.error("Error Loading Customer Stats"),t(na(e.t0));case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()),t(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,n){var r,a,c,i,o,s,l,d;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ta()),e.prev=1,e.next=4,Fr();case 4:return r=e.sent,e.next=7,Lr();case 7:return a=e.sent,e.next=10,Vr();case 10:return s=e.sent,e.next=13,Yr();case 13:return c=e.sent,e.next=16,Hr();case 16:return i=e.sent,e.next=19,qr();case 19:o=e.sent,d=n().DATA_SERVICES.invoices,t({type:de,payload:Object(u.a)(Object(u.a)({},d),{},{count:null===(l=r)||void 0===l?void 0:l.data,total:a.data,byMonth:c.data,byYear:i.data,unPaidTotal:s.data,topByCustomers:o.data})}),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(1),er.b.error("Error Loading Invoice Stats"),t(na(e.t0));case 28:case"end":return e.stop()}}),e,null,[[1,24]])})));return function(t,n){return e.apply(this,arguments)}}()),t(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,n){var r,a;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ta()),e.prev=1,e.next=4,Wr();case 4:r=e.sent,a=n().DATA_SERVICES.suppliers,t({type:be,payload:Object(u.a)(Object(u.a)({},a),{},{count:r.data})}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error Loading Invoice Stats"),t(na(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),t(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,n){var r,a;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ta()),e.prev=1,e.next=4,Qr();case 4:r=e.sent,a=n().DATA_SERVICES.services,t({type:pe,payload:Object(u.a)(Object(u.a)({},a),{},{count:r.data})}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error Loading Invoice Stats"),t(na(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),t(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,n){var r,a,c,i,o,s,l;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ta()),e.prev=1,console.log("purchase action"),e.next=5,Kr();case 5:return r=e.sent,e.next=8,Jr();case 8:return a=e.sent,e.next=11,Xr();case 11:return c=e.sent,e.next=14,Zr();case 14:return i=e.sent,e.next=17,$r();case 17:return o=e.sent,e.next=20,ea();case 20:s=e.sent,l=n().DATA_SERVICES.purchases,t({type:ve,payload:Object(u.a)(Object(u.a)({},l),{},{count:r.data,total:a.data,byMonth:c.data,byYear:i.data,byCategory:o.data,bySupplier:s.data})}),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(1),er.b.error("Error Loading Invoice Stats"),t(na(e.t0));case 29:case"end":return e.stop()}}),e,null,[[1,25]])})));return function(t,n){return e.apply(this,arguments)}}())}),[]),n?"LOADING":Object(Ze.jsxs)(pa,{title:"Dashboard",children:[Object(Ze.jsx)(dt.a,{className:e.pb2,children:Object(Ze.jsx)(Aa,{})}),Object(Ze.jsx)(dt.a,{className:e.pb2,children:Object(Ze.jsx)(ka,{})}),Object(Ze.jsx)(dt.a,{className:e.pb2,children:Object(Ze.jsx)(_a,{})})]})},Na=Ra,Ma=n(65),Pa=n.n(Ma),Ua=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("users");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Fa=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("users",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),La=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("users/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Va=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("users/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ya=function(){return function(e){e({type:m,payload:!0})}},Ha=function(e){return function(t){t({type:h,payload:e})}},qa=function(e){var t=e.user,n=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Update User",submitButtonText:"Update User",initialValues:t,formFields:Xa,validationSchema:sr,handleSubmit:function(e){return n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Ya()),t.prev=1,t.next=4,La(e);case 4:a=t.sent,c=a.data,i=r().USERS.users,o=i.map((function(e){return e._id===c._id?c:e})),n({type:f,payload:o}),er.b.success("Updated user successfully"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),er.b.error("Error updating user"),n(Ha(t.t0));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},Ba=n(43),za=n.n(Ba),Ga=function(e){var t=e.user,n=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t.name||"User"})})}),Object(Ze.jsx)(dt.a,{className:n.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Role",info:t.role},{title:"Email",info:t.email},{title:"Email Verified",info:t.emailVerified?"Yes":"No"},{title:"Status",info:t.active?"Active":"In Active"},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})]})},Wa=n(1065),Qa=function(e){var t=e.user,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete User"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"User"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Role",info:t.role},{title:"Email",info:t.email},{title:"Email Verified",info:t.emailVerified?"Yes":"No"},{title:"Status",info:t.active?"Active":"In Active"},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting user will mark this user as in-active."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Ya()),t.prev=1,t.next=4,Va(e);case 4:a=r().USERS.users,n({type:f,payload:a.filter((function(t){return t._id!==e}))}),er.b.success("User deleted successfully"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error deleting user"),n(Ha(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},Ka=Qa,Ja=function(e){return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(qa,{user:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",children:Object(Ze.jsx)(Ga,{user:e})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(Ka,{user:e})},"delete")]})},Xa=[{component:"MuiTextField",name:"name",label:"Full Name"},{component:"MuiTextField",name:"email",label:"User Email"},{component:"MuiTextField",name:"phone",label:"User Phone"},{component:"MuiCheckBox",name:"emailVerified",label:"User Email Verified"},{component:"MuiSelectField",name:"role",label:"User Type",options:[{value:"Staff",label:"Staff"},{value:"Admin",label:"Admin"}]},{component:"MuiTextField",name:"password",label:"Password",type:"password"},{component:"MuiTextField",name:"passwordConfirmation",label:"Confirm Password",type:"password"}],Za=[{name:"Name",selector:function(e){return e.name},sortable:!0},{name:"Email",selector:function(e){return e.email},sortable:!0},{name:"Role",selector:function(e){return e.role},sortable:!0},{name:"Actions",selector:function(e){return Ja(e)}}],$a=function(){var e=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Create User",submitButtonText:"Create User",initialValues:{name:"",email:"",town:"",userType:"Staff",emailVerified:!1},formFields:Xa,validationSchema:sr,handleSubmit:function(t){return e((n=t,function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Ya()),e.prev=1,e.next=4,Fa(n);case 4:a=e.sent,c=a.data,i=r().USERS,o=i.users,s=i.layout,o.push(c),t({type:f,payload:o}),t({type:x,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0.response.data),er.b.error("Error creating user"),t(Ha(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()));var n}})})},ec=$a,tc=function(){var e=Object(r.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(Ke.b)(),i=Object(Ke.c)(Fe),o=i.users,s=i.loading,l=i.layout,u=function(){return c(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Ya()),e.prev=1,e.next=4,Ua();case 4:n=e.sent,r=n.data,t({type:f,payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error getting users"),t(Ha(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}())};return Object(r.useEffect)((function(){u()}),[]),Object(r.useEffect)((function(){a(l.openCreateDrawer)}),[l.openCreateDrawer]),s?"":Object(Ze.jsx)(dn.a,{children:Object(Ze.jsx)(dt.a,{p:3,children:Object(Ze.jsx)(Pa.a,{open:n,actions:[Object(Ze.jsx)(Gt,{openButtonText:"Create User",open:n,handleOpen:function(){return Bn(c,l,"UPDATE_USERS_LAYOUT",!0)},handleClose:function(){return Bn(c,l,"UPDATE_USERS_LAYOUT",!1)},children:Object(Ze.jsx)(ec,{})},"create")],title:"ALL USERS",fixedHeader:!0,fixedHeaderScrollHeight:"450px",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,progressPending:s,columns:Za,data:o||[]})})})},nc=tc,rc=function(){return Object(Ze.jsx)(pa,{title:"Users",children:Object(Ze.jsx)(nc,{})})},ac=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("customers");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),cc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("customers/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ic=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("customers",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("customers/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("customers/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("customers/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),uc=function(){return function(e){e({type:C,payload:!0})}},dc=function(e){return function(t){t({type:S,payload:e})}},jc=function(){return function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(uc()),e.prev=1,e.next=4,ac();case 4:n=e.sent,r=n.data,t({type:y,payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error getting customers"),t(dc(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},bc=function(e){var t=e.customer,n=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Update Customer",initialValues:t,validationSchema:dr,submitButtonText:"Update Customer",formFields:di,handleSubmit:function(e){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(uc()),t.prev=1,t.next=4,oc(e);case 4:a=t.sent,c=a.data,i=r().CUSTOMERS.customers,o=i.map((function(e){return e._id===c._id?c:e})),n({type:y,payload:o}),er.b.success("Customer updated successfully"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),er.b.error("Error updating customer"),n(dc(t.t0));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},pc=n(1155),vc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return n=Zn(t),e.next=4,_n.a.get("invoices?".concat(n));case 4:case 7:return e.abrupt("return",e.sent);case 5:return e.next=7,_n.a.get("invoices");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("invoices/".concat(t._id,"/new-line"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.patch("invoices/".concat(t._id,"/lines"),t.lines);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),hc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("invoices/".concat(t._id,"/payments"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("invoices/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("invoices",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("invoices/mot",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("invoices/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("invoices/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Sc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.patch("invoices/bulk-review",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Cc=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("invoices/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tc=function(){return function(e){e({type:U,payload:!0})}},Ec=function(e){return function(t){t({type:P,payload:e})}},Dc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Tc()),t.prev=1,t.next=4,vc(e);case 4:r=t.sent,a=r.data,n({type:N,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting invoices"),n(Ec(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},Ic=function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Tc()),t.prev=1,t.next=4,mc(e);case 4:r=t.sent,a=r.data,n({type:M,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting invoice"),n(Ec(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},Ac=function(e){return function(t,n){t(Tc());var r=n().INVOICES.grouped;t({type:F,payload:Object(u.a)(Object(u.a)({},r),e)})}},kc=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(){var r=Object(An.a)(Object(In.a)().mark((function r(a,c){var i,o,s,l,d;return Object(In.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a(Tc()),r.prev=1,!n){r.next=8;break}return r.next=5,gc(e);case 5:r.t0=r.sent,r.next=11;break;case 8:return r.next=10,xc(e);case 10:r.t0=r.sent;case 11:i=r.t0,o=i.data,s=c().INVOICES,l=s.invoices,d=s.layout,l.push(o),a({type:N,payload:l}),a({type:L,payload:Object(u.a)(Object(u.a)({},d),{},{openCreateDrawer:!1})}),t.push("/invoices/".concat(o._id,"/view")),er.b.success("Invoice created successfully"),r.next=25;break;case 21:r.prev=21,r.t1=r.catch(1),er.b.error("Error creating invoice"),a(Ec(r.t1));case 25:case"end":return r.stop()}}),r,null,[[1,21]])})));return function(e,t){return r.apply(this,arguments)}}()},_c=function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Tc()),t.prev=1,t.next=4,Oc(e);case 4:a=t.sent,c=a.data,i=r().INVOICES.invoices,o=i&&i.map((function(e){return e._id===c._id?c:e})),n({type:N,payload:o}),n({type:M,payload:c}),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(t.t0),er.b.error("Error getting invoice"),n(Ec(t.t0));case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n){return t.apply(this,arguments)}}()},Rc=function(e){var t=e.invoice,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Invoice"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Invoice"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Tax Invoice",info:"inv # ".concat(t.autoId)},{title:"Invoiced To",info:t.customer.name},{title:"Created",info:za()(t.created).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Invoice will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Tc()),t.prev=1,t.next=4,wc(e);case 4:a=r().INVOICES.invoices,c=a.filter((function(t){return t._id!==e})),n({type:N,payload:c}),er.b.success("Invoice deleted successfully"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),er.b.error("Error deleting invoice"),n(Ec(t.t0));case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},Nc=Rc,Mc=function(e){var t=e.invoice,n=(Object(Sn.g)(),Object(Ke.b)()),a=Object(Ke.c)(Le),c=a.customers,i=a.loading;if(Object(r.useEffect)((function(){c||n(jc())}),[]),i)return"LOADING";var o=t._id,s=t.department,l=t.vehicleModel,u=t.vehicleReg,d=t.invoiceDate,j=t.repairNotes;return Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Update Invoice",initialValues:{_id:o,department:s,vehicleModel:l,vehicleReg:u,invoiceDate:d,repairNotes:j,customer:t.customer._id},validationSchema:vr,submitButtonText:"Update Invoice",formFields:Qc(c,!0),handleSubmit:function(e){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Tc()),t.prev=1,t.next=4,yc(e);case 4:a=t.sent,c=a.data,i=r().INVOICES.invoices,o=i.map((function(e){return e._id===c._id?c:e})),n({type:N,payload:o}),n({type:M,payload:c}),er.b.success("Invoice updated successfully"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),er.b.error("Error getting invoice"),n(Ec(t.t0));case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},Pc=function(e){var t=e.invoice;return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"space-between",children:[Object(Ze.jsx)(Gt,{openButtonIcon:"Edit",open:!1,children:Object(Ze.jsx)(Mc,{invoice:t})}),Object(Ze.jsx)(qt.a,{size:"small",onClick:function(){return Jn("/#/invoices/".concat(t._id,"/view"))},children:Object(Ze.jsx)(et,{size:"small",color:"primary",name:"FolderOpen"})}),Object(Ze.jsx)(Gt,{openButtonIcon:"Delete",open:!1,children:Object(Ze.jsx)(Nc,{invoice:t})})]})},Uc=n(304),Fc=n.n(Uc),Lc=function(e){var t=e.invoice,n=e.invoiceLines,a=e.services,c=e.initialValues,i=Object(r.useState)(null),o=Object(Pe.a)(i,2),s=o[0],l=o[1],u=Object(r.useState)(!0),d=Object(Pe.a)(u,2),j=d[0],b=d[1],p=Object(r.useState)(!0),v=Object(Pe.a)(p,2),f=v[0],O=v[1],h=Object(Ke.b)(),m=lt();Object(r.useEffect)((function(){l(Zc(t))}),[]),Object(r.useEffect)((function(){O(x()),b(!1)}),[s]);var x=function(){var e;return!(null===t||void 0===t||null===(e=t.customer)||void 0===e||!e.highValue)||(null===s||void 0===s?void 0:s.invoicesVatExempt)};if(j)return"";return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsxs)(Wt.a,{container:!0,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:"New Invoice Line"})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,className:Object(_r.a)(m.pt3,m.pb2),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Kt.b,{initialValues:c,validationSchema:fr,onSubmit:function(e){var r=null===n||void 0===n?void 0:n.map((function(t){var n;return(null===t||void 0===t?void 0:t._id)===(null===e||void 0===e?void 0:e._id)?(delete e._id,e.charged=parseFloat(e.charged),e):(t.service=null===t||void 0===t||null===(n=t.service)||void 0===n?void 0:n._id,delete t._id,t)}));h(_c({_id:null===t||void 0===t?void 0:t._id,lines:r}))},children:function(e){var t=e.errors,n=e.values,r=e.handleChange,c=e.setFieldValue,i=e.handleSubmit;return Object(Ze.jsxs)(Kt.a,{children:[Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(At,{label:"Service",name:"service",defaultValue:n.service,handleChange:function(e,t){return c("service",(null===t||void 0===t?void 0:t.value)||"")},fullWidth:!0,options:Gn(a)})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:m.mt2,label:"Description",value:n.description,errors:t.description,onChange:r,name:"description",fullWidth:!0,multiline:!0,rows:4})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:m.mt2,label:"Amount Charged",value:n.charged,errors:t.charged,onChange:r,name:"charged",fullWidth:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Tt,{label:"Add Vat (20%)",handleChange:function(e,t){c("addVat",t)},name:"addVat",checked:n.addVat,errors:t.addVat,disabled:f})})]}),Object(Ze.jsx)(Yt.a,{className:m.mt2,onClick:i,variant:"contained",color:"primary",type:"submit",fullWidth:!0,children:"Update Invoice Line"})]})}})})]})})},Vc=function(e){var t=e.invoice,n=e.invoiceLines,r=e.line,a=Object(Ke.b)();return Object(Ze.jsx)(yn,{handleConfirm:function(){return function(e){var r,c=null===n||void 0===n?void 0:n.filter((function(t){return t._id!==e}));c=null===(r=c)||void 0===r?void 0:r.map((function(e){var t;return e.service=null===e||void 0===e||null===(t=e.service)||void 0===t?void 0:t._id,delete e._id,e})),a(_c({_id:null===t||void 0===t?void 0:t._id,lines:c}))}(r._id)},ActionButton:{icon:"Delete"},title:"Delete Invoice Line",content:Object(Ze.jsxs)(Ze.Fragment,{children:["Confirm delete invoice line, ",Object(Ze.jsx)("b",{children:r.service})," for"," ",Object(Ze.jsxs)("b",{children:["\xa3 ",r.charged.toFixed(2)]}),".",Object(Ze.jsx)("br",{})," This process ",Object(Ze.jsx)("b",{children:"can not"})," be reversed"]})})};za.a.extend(Fc.a);var Yc,Hc=function(e){var t=qn(e);return Object(Ze.jsx)(pc.a,{size:"small",label:t?"Paid In Full":"Outstanding",variant:t?"outlined":"contained",color:t?"primary":"secondary"})},qc={customer:"",invoiceDate:new Date,vehicleModel:"",vehicleRed:"",repairNotes:""},Bc={charged:0,cash:0,cheque:0,card:0,service:(Yc="MOT",pt.departments.find((function(e){return e.name===Yc}))).defaultServiceId},zc=[{name:"Invoice No",selector:function(e){return"#"+(null===e||void 0===e?void 0:e.autoId)},sortable:!0},{name:"Invoice Date",selector:function(e){return"".concat(za()(e.invoiceDate).format("DD MMM YYYY"))},sortable:!0},{name:"Customer",selector:function(e){return e.customer.name},sortable:!0},{name:"Vehicle Model - Reg ",selector:function(e){var t;return e.vehicleModel+" - "+(null===(t=e.vehicleReg)||void 0===t?void 0:t.toUpperCase())},sortable:!0},{name:"Payment",cell:function(e){return Hc(e)},selector:function(e){return e.balancePayable},sortable:!0},{name:"Actions",selector:function(e){return Pc({invoice:e})}}],Gc=[{name:"Invoice No",selector:function(e){return"#"+e.autoId},sortable:!0},{name:"Invoice Date",selector:function(e){return"".concat(za()(e.invoiceDate).format("DD MMM YYYY"))},sortable:!0},{name:"Vehicle Model - Reg ",selector:function(e){var t;return e.vehicleModel+" - "+(null===(t=e.vehicleReg)||void 0===t?void 0:t.toUpperCase())},sortable:!0},{name:"Invoice Total",selector:function(e){var t;return null===e||void 0===e||null===(t=e.total)||void 0===t?void 0:t.toFixed(2)},sortable:!0},{name:"Payment",cell:function(e){return Hc(e)},selector:function(e){return e.balancePayable},sortable:!0},{name:"",cell:function(e){return Object(Ze.jsx)(qt.a,{size:"small",onClick:function(){return Jn("/#/invoices/".concat(e._id,"/view"))},children:Object(Ze.jsx)(et,{size:"small",color:"primary",name:"FolderOpen"})})},sortable:!1}],Wc=[{name:"Item",selector:function(e){var t;return null===e||void 0===e||null===(t=e.service)||void 0===t?void 0:t.title},sortable:!1},{name:"Description",selector:function(e){var t;return null===e||void 0===e||null===(t=e.service)||void 0===t?void 0:t.description},sortable:!1},{name:"VAT",selector:function(e){return"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(.2*e.charged).toFixed(2):"0.00")}},{name:"Amount",selector:function(e){return"\xa3 ".concat(e.charged.toFixed(2))},sortable:!1},{name:"Total",selector:function(e){return"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(1.2*e.charged).toFixed(2):e.charged)}},{name:"",cell:function(e){var t=e.invoice,n=e.services,r=e.invoiceLines,a=e._id,c=e.service,i=e.addVat,o=e.charged,s=e.description;return Object(Ze.jsxs)(Ze.Fragment,{children:[Object(Ze.jsx)(Gt,{openButtonIcon:"Edit",open:!1,children:Object(Ze.jsx)(Lc,{invoice:t,services:n,invoiceLines:r,initialValues:{_id:a,service:null===c||void 0===c?void 0:c._id,addVat:i,charged:o,description:s}})}),Object(Ze.jsx)(Vc,{invoice:t,invoiceLines:r,line:{_id:a,service:null===c||void 0===c?void 0:c.title,addVat:i,charged:o,description:s}})]})}}],Qc=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return[{component:"MuiSelectField",name:"department",label:"Invoice Department",options:Wn(pt.departments,"name","name"),disabled:!vt||n||"/invoices/mot"===t},{component:"MuiTextField",name:"vehicleModel",label:"Vehicle Model",size:{sm:6,md:6}},{component:"MuiTextField",name:"vehicleReg",label:"Vehicle Registration",size:{sm:6,md:6}},{component:"MuiSelectField",name:"customer",label:"Customer",options:zn(e)},{component:"MuiDatepicker",name:"invoiceDate",label:"Invoice Date"},{component:"MuiTextField",name:"repairNotes",label:"Invoice/Repair/Service Notes",multiline:!0,rows:3}]},Kc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[{component:"MuiTextField",name:"charged",label:"MOT Amount",required:!0}].concat(Object(Me.a)(Jc(e)))},Jc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[{component:"MuiTextField",name:"cash",label:"Cash",size:{sm:6,md:6}},{component:"MuiTextField",name:"cheque",label:"Cheque",size:{sm:6,md:6}},{component:"MuiTextField",name:"card",label:"Card",size:{sm:6,md:6}},{component:"MuiTextField",name:"reference",label:"Reference",size:{sm:6,md:6}},{component:"MuiSelectField",name:"transaction",options:e,label:"Bank Transaction Ref"}]},Xc=[{when:function(e){return e.customer.highValue},style:function(e){return{backgroundColor:e.customer.highValue?nt.accent.main:"inherit"}}}],Zc=function(e){return pt.departments.find((function(t){return t.name===(null===e||void 0===e?void 0:e.department)}))},$c=function(e){var t,n=e.customer,r=n.invoices.filter((function(e){return!qn(e)})),a=Un(n.invoices,"total"),c=Un(n.invoices,"balancePayable"),i=lt();return Object(Ze.jsx)(dt.a,{className:Object(_r.a)(i.pt2,i.pb4),children:Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:6,md:4,children:Object(Ze.jsx)(fa,{label:"Invoices",value:null===(t=n.invoices)||void 0===t?void 0:t.length,action:null})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:6,md:8,children:Object(Ze.jsx)(fa,{label:"Invoices Amount",value:"\xa3 ".concat(Ln(a)),action:null})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:6,md:4,children:Object(Ze.jsx)(fa,{label:"Un Paid Invoices",color:"error",value:null===r||void 0===r?void 0:r.length,action:null})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:6,md:8,children:Object(Ze.jsx)(fa,{label:"Unpaid Invoices Amount",color:"error",value:"\xa3 ".concat(Ln(c)),action:null})})]})})},ei=n(39),ti=ei.f.create({body:{paddingTop:35,paddingBottom:65,paddingHorizontal:35},title:{fontSize:24,textAlign:"center",fontFamily:"Oswald"},author:{fontSize:12,textAlign:"center",marginBottom:40},subtitle:{fontSize:18,margin:12,fontFamily:"Oswald"},text:{margin:12,fontSize:10,textAlign:"justify",fontFamily:"Times-Roman"},image:{margin:12},header:{fontSize:10,marginHorizontal:12,textAlign:"justify",color:"grey"},pageNumber:{position:"absolute",fontSize:10,bottom:20,left:0,right:0,textAlign:"center",color:"grey"},row:{flexDirection:"row",alignItems:"center"},tableColumnOne:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"10%"},tableColumnTwo:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"20%"},tableColumnFour:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"40%"},tableColumnFive:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"50%"},w1:{width:"10%"},w2:{width:"20%"},w3:{width:"30%"},w4:{width:"40%"},w5:{width:"50%"},divider:{borderBottom:"1px solid #ccc",marginVertical:10},marginVertical:{marginVertical:10},marginHorizontal:{marginHorizontal:10},downloadLink:{textDecoration:"none"}});ei.b.register({family:"Oswald",src:"https://fonts.gstatic.com/s/oswald/v13/Y_TKV6o8WovbUd3m_X9aAA.ttf"});var ni=function(e){var t=e.invoices,n=e.customer,a=Object(r.useState)(null),c=Object(Pe.a)(a,2),i=c[0],o=c[1];Object(r.useEffect)((function(){Xn(null===pt||void 0===pt?void 0:pt.appLogo,(function(e){return o(e)}))}),[]);return Object(Ze.jsx)(ei.a,{children:Object(Ze.jsxs)(ei.e,{style:ti.body,wrap:!0,size:"A4",children:[Object(Ze.jsx)(dt.a,{style:ti.w3,children:i&&Object(Ze.jsx)(ei.c,{src:i,style:ti.image})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsxs)(ei.g,{style:ti.text,children:[pt.name," ","\n",pt.address.line1,pt.address.line2," ","\n",pt.address.city," ","\n",pt.address.postalCode," ","\n"]})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsxs)(ei.g,{style:ti.text,children:["Customer : ","\n",null===n||void 0===n?void 0:n.name," ","\n",(null===n||void 0===n?void 0:n.addressLine1)&&"".concat(null===n||void 0===n?void 0:n.addressLine1," \n"),(null===n||void 0===n?void 0:n.addressLine2)&&"".concat(null===n||void 0===n?void 0:n.addressLine2," \n"),null===n||void 0===n?void 0:n.town," ","\n",null===n||void 0===n?void 0:n.postalCode]})}),Object(Ze.jsxs)(ei.h,{style:ti.row,children:[Object(Ze.jsx)(dt.a,{style:ti.w2,children:Object(Ze.jsx)(ei.g,{style:ti.header,children:" Statement "})}),Object(Ze.jsx)(dt.a,{style:ti.w3,children:Object(Ze.jsx)(ei.g,{style:ti.text,children:za()().format("DD/MM/YYYY")})})]}),Object(Ze.jsx)(ei.g,{style:ti.text,children:"Unpaid Invoices"}),Object(Ze.jsxs)(ei.h,{style:ti.row,children:[Object(Ze.jsx)(ei.g,{style:ti.tableColumnTwo,children:"Invoice No"}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnTwo,children:"Invoice Date"}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnFour,children:"Vehicle Model - Reg"}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnOne,children:" Total"}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnTwo,children:"Outstanding"})]}),Object(Ze.jsx)(dt.a,{style:ti.divider}),null===t||void 0===t?void 0:t.map((function(e,t){var n=e.autoId,r=e.invoiceDate,a=e.vehicleReg,c=e.vehicleModel,i=e.total,o=e.balancePayable;return Object(Ze.jsxs)(ei.h,{style:ti.row,children:[Object(Ze.jsxs)(ei.g,{style:ti.tableColumnTwo,children:["# ",n]}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnTwo,children:za()(r).format("DD MMM YYYY")}),Object(Ze.jsxs)(ei.g,{style:ti.tableColumnFour,children:[c," - ",a]}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnOne,children:"\xa3 ".concat((null===i||void 0===i?void 0:i.toFixed(2))||0)}),Object(Ze.jsx)(ei.g,{style:ti.tableColumnTwo,children:"\xa3 ".concat((null===o||void 0===o?void 0:o.toFixed(2))||"0.00")})]},t)})),Object(Ze.jsx)(ei.g,{style:ti.pageNumber,render:function(){var e,t,n,r,a="";return a+="".concat(null===pt||void 0===pt||null===(e=pt.address)||void 0===e?void 0:e.line1," ").concat(null===pt||void 0===pt||null===(t=pt.address)||void 0===t?void 0:t.line2," ").concat(null===pt||void 0===pt||null===(n=pt.address)||void 0===n?void 0:n.city," ").concat(null===pt||void 0===pt||null===(r=pt.address)||void 0===r?void 0:r.postalCode," \n")},fixed:!0})]})})},ri=function(e){var t=e.invoices,n=e.customer,r=e.department,a=lt();return Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(ei.d,{style:ti.downloadLink,document:Object(Ze.jsx)(ni,{invoices:t,customer:n,department:r}),fileName:"Customer Statement ".concat(null===n||void 0===n?void 0:n.autoId,".pdf"),children:function(e){return e.loading?"...":Object(Ze.jsxs)(Yt.a,{className:a.ml2,variant:"contained",children:[r," STATEMENTS"]})}})})},ai=function(e){var t=e.invoices,n=e.customer,r=e.department;return Object(Ze.jsx)(ri,{invoices:t,customer:n,department:r})},ci=function(e){var t=e._id,n=Object(r.useState)(null),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=lt(),s=Object(Ke.b)(),l=Object(Ke.c)(Le).customer,u=pt.departments;return Object(r.useEffect)((function(){return s(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(uc()),t.prev=1,t.next=4,cc(e);case 4:r=t.sent,a=r.data,n({type:w,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting customer"),n(dc(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}(t)),function(){s({type:"GET_CUSTOMER",payload:null})}}),[]),Object(r.useEffect)((function(){if(l){var e=u.map((function(e){var t,n=e.name;return{department:n,invoices:null===l||void 0===l||null===(t=l.invoices)||void 0===t?void 0:t.filter((function(e){return!qn(e)&&e.department===n}))}}));i(e)}}),[l,u]),Object(Ze.jsx)(dt.a,{children:l&&Object(Ze.jsxs)(Ze.Fragment,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsxs)(dt.a,{display:"flex",alignItems:"center",flexDirection:"row",children:[l.highValue&&Object(Ze.jsx)(Ht.a,{placement:"right",title:"High Value Customer",children:Object(Ze.jsx)(dt.a,{className:o.pr1,children:Object(Ze.jsx)(et,{name:"DoneAll"})})}),Object(Ze.jsx)(jt.a,{variant:"h5",children:l.name||"Customer"})]})})}),Object(Ze.jsxs)(dt.a,{className:o.pt3,children:[Object(Ze.jsx)(Qt.a,{}),500===(null===l||void 0===l?void 0:l.invoices.length)&&Object(Ze.jsx)(dt.a,{className:o.pt2,children:Object(Ze.jsx)(Wa.a,{severity:"warning",children:"This Customer may have more than 500 invoices."})})]}),Object(Ze.jsx)(rn,{content:[{label:"Details",tabContent:Object(Ze.jsxs)(Ze.Fragment,{children:[Object(Ze.jsx)($c,{customer:l}),Object(Ze.jsx)(cn,{data:Hn(l)})]})},{label:"Invoices",tabContent:Object(Ze.jsx)(Pa.a,{title:"CUSTOMER INVOICES",fixedHeader:!0,highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,actions:Object(Ze.jsx)(Ze.Fragment,{children:null===c||void 0===c?void 0:c.map((function(e){var t=e.department,n=e.invoices;return Object(Ze.jsx)(ai,{customer:l,invoices:n,department:t},t)}))}),columns:Gc,data:l.invoices})}]})]})})},ii=ci,oi=function(e){var t=e.customer,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Customer"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Customer"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:Hn(t)})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Customer will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(uc()),t.prev=1,t.next=4,sc(e);case 4:a=r().CUSTOMERS.customers,c=a.filter((function(t){return t._id!==e})),n({type:y,payload:c}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error deleting customer"),n(dc(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},si=oi,li=function(e){var t=window.innerWidth>1024?window.innerWidth-320:620;return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(bc,{customer:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",width:t,children:Object(Ze.jsx)(ii,{_id:e._id})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(si,{customer:e})},"delete")]})},ui=[{name:"#Id",selector:function(e){return"# ".concat(e.autoId)},sortable:!0},{name:"Name",selector:function(e){return e.name},sortable:!0},{name:"Email",selector:function(e){return e.email},sortable:!0},{name:"Town",selector:function(e){return e.town},sortable:!0},{name:"Phone",selector:function(e){return e.phone},sortable:!0},{name:"Type",selector:function(e){return e.customerType},sortable:!0},{name:"Actions",selector:function(e){return li(e)}}],di=[{component:"MuiTextField",name:"name",label:"Full Name"},{component:"MuiTextField",name:"email",label:"Customer Email"},{component:"MuiTextField",name:"phone",label:"Customer Phone"},{component:"MuiTextField",name:"addressLine1",label:"Address Line 1"},{component:"MuiTextField",name:"addressLine2",label:"Address Line 2"},{component:"MuiTextField",name:"town",label:"Town"},{component:"MuiTextField",name:"postalCode",label:"Post Code"},{component:"MuiCheckBox",name:"creditAccount",label:"Credit Account",size:{md:6,sm:6,xs:12}},{component:"MuiCheckBox",name:"highValue",label:"High Value",size:{md:6,sm:6,xs:12}},{component:"MuiSelectField",name:"customerType",label:"Customer Type",options:[{value:"Private",label:"Private"},{value:"Trade",label:"Trade"}]},{component:"MuiSelectField",name:"paymentTerms",label:"Payment Terms",options:[{value:"7 Days",label:"7 Days"},{value:"14 Days",label:"14 Days"},{value:"28 Days",label:"28 Days"}]}],ji=[{when:function(e){return e.highValue},style:function(e){return{backgroundColor:e.highValue?nt.accent.main:"inherit"}}}],bi=function(){var e=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Create Customer",initialValues:{name:"",email:"",town:"",postalCode:"",phone:"",creditAccount:!0,highValue:!1,customerType:"Private",paymentTerms:"7 Days"},validationSchema:dr,submitButtonText:"Create Customer",formFields:di,handleSubmit:function(t){var n;e((n=t,function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(uc()),e.prev=1,e.next=4,ic(n);case 4:a=e.sent,c=a.data,i=r().CUSTOMERS,o=i.customers,s=i.layout,o.push(c),t({type:y,payload:o}),t({type:T,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Customer created successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),er.b.error("Error creating customer"),t(dc(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},pi=bi,vi=function(){var e=Object(r.useState)("ALL CUSTOMERS"),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),i=Object(Pe.a)(c,2),o=i[0],s=i[1],l=Object(Ke.b)(),u=lt(),j=Object(Ke.c)(Le),b=j.customers,p=j.layout,v=j.loading;Object(r.useEffect)((function(){l(jc())}),[]),Object(r.useEffect)((function(){s(p.openCreateDrawer)}),[p.openCreateDrawer]);var f=function(){l(jc()),a("ALL CUSTOMERS")};return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:u.pb2,children:Object(Ze.jsx)(vn,{placeholder:"Search Customers",handleClear:f,handleSearch:function(e){Object(d.isEmpty)(e)?f():(l(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(uc()),t.prev=1,t.next=4,lc(e);case 4:r=t.sent,a=r.data,n({type:y,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error searching for customers"),n(dc(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:e})),a("SEARCH RESULTS"))}})}),Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{open:o,openButtonText:"Create Customer",handleOpen:function(){return Bn(l,p,"UPDATE_CUSTOMER_LAYOUT",!0)},handleClose:function(){return Bn(l,p,"UPDATE_CUSTOMER_LAYOUT",!1)},children:Object(Ze.jsx)(pi,{})},"create")],title:n,fixedHeader:!0,fixedHeaderScrollHeight:"80vh",paginationPerPage:10,highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,progressPending:v&&!b,columns:ui,conditionalRowStyles:ji,data:b||[]})]})})},fi=vi,Oi=function(){return Object(Ze.jsx)(pa,{title:"Customers",children:Object(Ze.jsx)(fi,{})})},hi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("suppliers");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),mi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("suppliers",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),xi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("suppliers/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("suppliers/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("suppliers/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wi=function(){return function(e){e({type:k,payload:!0})}},Si=function(e){return function(t){t({type:A,payload:e})}},Ci=function(){return function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(wi()),e.prev=1,e.next=4,hi();case 4:n=e.sent,r=n.data,t({type:D,payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error getting suppliers"),t(Si(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},Ti=function(e){var t=e.supplier,n=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Update Supplier",initialValues:t,formFields:_i,validationSchema:jr,handleSubmit:function(e){return n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(wi()),t.prev=1,t.next=4,xi(e);case 4:a=t.sent,c=a.data,i=r().SUPPLIERS.suppliers,o=i.map((function(e){return e._id===c._id?c:e})),n({type:D,payload:o}),er.b.success("Supplier updated successfully"),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),er.b.error("Error updating supplier"),n(Si(t.t0));case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))},submitButtonText:"Update Supplier"})})},Ei=function(e){var t=e.supplier,n=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t.name||"Supplier"})})}),Object(Ze.jsx)(dt.a,{className:n.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Location",info:t.town},{title:"Phone",info:t.phone},{title:"email",info:t.email},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})]})},Di=function(e){var t=e.supplier,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Supplier"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Supplier"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Location",info:t.town},{title:"Phone",info:t.phone},{title:"email",info:t.email},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Supplier will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(wi()),t.prev=1,t.next=4,gi(e);case 4:a=r().SUPPLIERS.suppliers,c=a.filter((function(t){return t._id!==e})),n({type:D,payload:c}),er.b.success("Supplier deleted successfully"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),er.b.error("Error deleting supplier"),n(Si(t.t0));case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},Ii=Di,Ai=function(e){return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(Ti,{supplier:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",children:Object(Ze.jsx)(Ei,{supplier:e})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(Ii,{supplier:e})},"delete")]})},ki=[{name:"#Id",selector:function(e){return"# ".concat(null===e||void 0===e?void 0:e.autoId)},sortable:!0},{name:"Name",selector:function(e){return e.name},sortable:!0},{name:"Town",selector:function(e){return e.town},sortable:!0},{name:"Phone",selector:function(e){return e.phone},sortable:!0},{name:"Actions",selector:function(e){return Ai(e)}}],_i=[{component:"MuiTextField",name:"name",label:"Name"},{component:"MuiTextField",name:"email",label:"Email"},{component:"MuiTextField",name:"phone",label:"Phone"},{component:"MuiTextField",name:"town",label:"Location (Town/City)"}],Ri=function(){var e=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Create Supplier",initialValues:{name:"",email:"",phone:"",town:""},formFields:_i,validationSchema:jr,handleSubmit:function(t){return e((n=t,function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(wi()),e.prev=1,e.next=4,mi(n);case 4:a=e.sent,c=a.data,i=r().SUPPLIERS,o=i.suppliers,s=i.layout,o.push(c),t({type:D,payload:o}),t({type:_,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Supplier created successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),er.b.error("Error creating supplier"),t(Si(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}()));var n},submitButtonText:"Create Supplier"})})},Ni=Ri,Mi=function(){var e=Object(r.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(Ke.b)(),i=lt(),o=Object(Ke.c)(Ve),s=o.suppliers,l=o.loading,u=o.layout,j=function(){return c(Ci())};Object(r.useEffect)((function(){j()}),[]),Object(r.useEffect)((function(){a(u.openCreateDrawer)}),[u.openCreateDrawer]);return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:i.pb2,children:Object(Ze.jsx)(vn,{placeholder:"Search",handleCler:j,handleSearch:function(e){Object(d.isEmpty)(e)?j():c(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(wi()),t.prev=1,t.next=4,yi(e);case 4:r=t.sent,a=r.data,n({type:D,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error searching for suppliers"),n(Si(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:e}))}})}),Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{openButtonText:"Create Supplier",open:n,handleOpen:function(){return Bn(c,u,"UPDATE_SUPPLIERS_LAYOUT",!0)},handleClose:function(){return Bn(c,u,"UPDATE_SUPPLIERS_LAYOUT",!1)},children:Object(Ze.jsx)(Ni,{})},"create")],title:"ALL SUPPLIERS",progressPending:l,fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,columns:ki,data:s||[]})]})})},Pi=Mi,Ui=function(){return Object(Ze.jsx)(pa,{title:"Suppliers",children:Object(Ze.jsx)(Pi,{})})},Fi=n(1161),Li=n(1180),Vi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("transactions",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Yi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("transactions",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Hi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("transactions/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qi=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("transactions/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Bi=function(){return function(e){e({type:Ae,payload:!0})}},zi=function(e){return function(t){t({type:Ie,payload:e})}},Gi=function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Bi()),t.prev=1,t.next=4,Vi(e);case 4:r=t.sent,a=r.data,n({type:Ee,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting transactions"),n(zi(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},Wi=function(){var e=Object(r.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(Sn.h)().pathname,i=Object(Sn.g)(),o=Object(Ke.b)(),s=Object(Ke.c)(Le),l=Object(Ke.c)(Qe),d=l.transactions,j=l.loading;Object(r.useEffect)((function(){d||j||o(Gi({department:"MOT"}))}),[]),Object(r.useEffect)((function(){if(d&&!j){var e=d.map((function(e){var t=e._id,n=e.customerRef,r=e.autoId;return{value:t,label:"".concat(n,"  [#").concat(r,"]")}}));a(e)}}),[j,d]);var b=s.customers,p=s.loading||j;if(Object(r.useEffect)((function(){b||o(jc())}),[]),p)return"LOADING";var v=function(){return"/invoices"===c?pt.departments[0].name:pt.departments[1].name},f="/invoices/mot"!==c?{title:"Create Invoice",initialValues:Object(u.a)(Object(u.a)({},qc),{},{department:v()}),formFields:Qc(b,c),validationSchema:vr,handleSubmit:function(e){return o(kc(e,i))}}:{title:"Create MOT Invoice",initialValues:Object(u.a)(Object(u.a)(Object(u.a)({},qc),Bc),{},{department:v()}),formFields:[].concat(Object(Me.a)(Qc(b,c)),Object(Me.a)(Kc(n))),validationSchema:hr,handleSubmit:function(e){return o(kc(e,i,!0))}};return Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:f.title,initialValues:f.initialValues,validationSchema:f.validationSchema,submitButtonText:f.title,formFields:f.formFields,handleSubmit:f.handleSubmit})})},Qi=function(e){var t=e.data;return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(cn,{data:[{title:"Amount Paid",info:"\xa3 ".concat(t.payments.card+t.payments.cash+t.payments.cheque)},{title:"Balance",info:"\xa3 ".concat(t.balancePayable)},{title:"Invoice Total",info:"\xa3 ".concat(t.total)}]})})},Ki=function(){var e=Object(Sn.h)().pathname,t=Object(Sn.g)(),n=Object(r.useState)("INVOICES"),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(e),s=Object(Pe.a)(o,2),l=s[0],j=s[1],b=Object(r.useState)("all"),p=Object(Pe.a)(b,2),v=p[0],f=p[1],O=lt(),h=Object(r.useState)(!1),m=Object(Pe.a)(h,2),x=m[0],g=m[1],y=Object(Ke.b)(),w=Object(Ke.c)(Ye),S=w.invoices,C=w.loading,T=w.layout,E="/invoices/mot"===e?{department:"MOT"}:{},D=function(){return y(Dc(E))};Object(r.useEffect)((function(){D(),j(e)}),[]),Object(r.useEffect)((function(){D()}),[e]),Object(r.useEffect)((function(){g(T.openCreateDrawer)}),[T.openCreateDrawer]);var I=function(){y(Dc(E)),i("INVOICES")};return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{sx:{width:"100%",pb:3},children:Object(Ze.jsxs)($t.a,{value:l,onChange:function(){j(e)},"aria-label":"wrapped label tabs example",children:[Object(Ze.jsx)(en.a,{value:"/invoices",label:"ALL INVOICES",onClick:function(){return t.push("/invoices")}}),Object(Ze.jsx)(en.a,{value:"/invoices/mot",label:"MOT INVOICES",onClick:function(){return t.push("/invoices/mot")}})]})}),Object(Ze.jsx)(dt.a,{className:O.pb2,children:Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:6,sm:8,children:Object(Ze.jsx)(dt.a,{width:"100%",children:Object(Ze.jsx)(vn,{placeholder:"Search Invoice # | Vehicle Model - Reg",handleClear:I,handleSearch:function(e){Object(d.isEmpty)(e)?I():(y(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Tc()),t.prev=1,t.next=4,Cc(e);case 4:r=t.sent,a=r.data,n({type:N,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error deleting invoice"),n(Ec(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}(Object(u.a)(Object(u.a)({},E),{},{search:e}))),i("SEARCH RESULTS"))}})})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:6,sm:4,children:Object(Ze.jsxs)(Fi.a,{onChange:function(e,t){return f(t),"all"===t?(i("INVOICES"),y(Dc(E))):(i(t?"PAID INVOICES":"UNPAID INVOICES"),y(Dc(Object(u.a)(Object(u.a)({},E),{},{"payments.paidInFull":t}))))},fullWidth:!0,exclusive:!0,size:"medium",value:v,children:[Object(Ze.jsx)(Li.a,{value:"all",children:"ALL"}),Object(Ze.jsx)(Li.a,{value:!0,children:"PAID"}),Object(Ze.jsx)(Li.a,{value:!1,children:"UN PAID"})]})})]})}),Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{openButtonText:"Create Invoice",open:x,handleOpen:function(){return Bn(y,T,"UPDATE_INVOICES_LAYOUT",!0)},handleClose:function(){return Bn(y,T,"UPDATE_INVOICES_LAYOUT",!1)},children:Object(Ze.jsx)(Wi,{})},"create")],title:c,progressPending:C,fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,expandableRows:!0,pagination:!0,expandableRowsComponent:Qi,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"left",subHeaderWrap:!0,columns:zc,conditionalRowStyles:Xc,data:S||[]})]})})},Ji=Ki,Xi=function(e){var t,n,a,c,i,o,s,l=e.invoice,u=Object(r.useState)({}),d=Object(Pe.a)(u,2),j=d[0],b=d[1];return Object(r.useEffect)((function(){b(Zc(l))}),[]),Object(Ze.jsxs)(Wt.a,{container:!0,spacing:2,children:[Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,sm:6,flexDirection:"column",display:"flex",children:[Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"TO "}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===l||void 0===l||null===(t=l.customer)||void 0===t?void 0:t.name}),(null===l||void 0===l||null===(n=l.customer)||void 0===n?void 0:n.addressLine1)&&Object(Ze.jsx)(jt.a,{variant:"body1",children:null===l||void 0===l||null===(a=l.customer)||void 0===a?void 0:a.addressLine1}),(null===l||void 0===l||null===(c=l.customer)||void 0===c?void 0:c.addressLine2)&&Object(Ze.jsx)(jt.a,{variant:"body1",children:null===l||void 0===l||null===(i=l.customer)||void 0===i?void 0:i.addressLine2}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===l||void 0===l||null===(o=l.customer)||void 0===o?void 0:o.town}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===l||void 0===l||null===(s=l.customer)||void 0===s?void 0:s.postalCode})]}),Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,sm:6,flexDirection:"column",display:"flex",children:[Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"FROM"}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===j||void 0===j?void 0:j.displayName}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.line1}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.line2}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.city}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.postalCode})]})]})},Zi=function(e){var t=e.title,n=e.amount,r=lt();return Object(Ze.jsxs)(dt.a,{display:"flex",justifyContent:"space-between",alignItems:"center",height:30,children:[Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t}),Object(Ze.jsxs)(jt.a,{variant:"body1",className:r.fw8,children:["\xa3 ",n]})]})},$i=function(e){var t,n,a,c,i,o=e.invoice,s=Object(r.useState)(null),l=Object(Pe.a)(s,2),u=l[0],d=l[1],j=Object(Ke.b)(),b=lt(),p=Object(Ke.c)(Qe),v=p.transactions,f=p.loading;if(Object(r.useEffect)((function(){v||f||j(Gi({department:null===o||void 0===o?void 0:o.department}))}),[]),Object(r.useEffect)((function(){if(v&&!f){var e=v.map((function(e){var t=e._id,n=e.customerRef,r=e.autoId;return{value:t,label:"".concat(n,"  [#").concat(r,"]")}}));d(e)}}),[f,v]),f)return"";var O=function(e){var t=e.payments;return t.card+t.cash+t.cheque||0}({payments:(null===o||void 0===o?void 0:o.payments)||{}}),h=Un(null===o||void 0===o?void 0:o.purchases,"total");return Object(Ze.jsxs)(dt.a,{className:Object(_r.a)(b.pt2),width:250,children:[Object(Ze.jsx)(Zi,{title:"Sub Total",amount:(null===o||void 0===o||null===(t=o.subTotal)||void 0===t?void 0:t.toFixed(2))||0}),Object(Ze.jsx)(Zi,{title:"VAT",amount:(null===o||void 0===o||null===(n=o.vatAmount)||void 0===n?void 0:n.toFixed(2))||0}),Object(Ze.jsx)(Zi,{title:"Parts",amount:(null===h||void 0===h?void 0:h.toFixed(2))||0}),Object(Ze.jsx)(Zi,{title:"Total",amount:(null===o||void 0===o||null===(a=o.total)||void 0===a?void 0:a.toFixed(2))||0}),Object(Ze.jsx)(Qt.a,{}),Object(Ze.jsx)(Zi,{title:"Paid",amount:O.toFixed(2)||0}),Object(Ze.jsx)(Zi,{amount:o.balancePayable.toFixed(2),title:"Outstanding Balance"}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(b.pt2),display:"flex",justifyContent:"flex-end",children:Object(Ze.jsx)(Gt,{openButtonText:o.payments.paidInFull?"UPDATE PAYMENTS":"ADD PAYMENTS",children:Object(Ze.jsx)(Zt,{title:"Invoice Payments",initialValues:{_id:o._id,card:o.payments.card||0,cash:o.payments.cash||0,cheque:o.payments.cheque||0,reference:(null===o||void 0===o||null===(c=o.payments)||void 0===c?void 0:c.reference)||"",transaction:(null===o||void 0===o||null===(i=o.payments)||void 0===i?void 0:i.transaction)||""},formFields:Jc(u),validationSchema:Or,handleSubmit:function(e){return j((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Tc()),e.prev=1,e.next=4,hc(t);case 4:a=e.sent,c=a.data,i=r().INVOICES.invoices,o=i&&i.map((function(e){return e._id===c._id?c:e})),n({type:N,payload:o}),n({type:M,payload:c}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),er.b.error("Error getting invoice"),n(Ec(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()));var t}})})})]})},eo=function(e){var t=e.invoice,n=e.services,a=Object(r.useState)(null),c=Object(Pe.a)(a,2),i=c[0],o=c[1],s=Object(r.useState)(!0),l=Object(Pe.a)(s,2),u=l[0],d=l[1],j=Object(Ke.b)(),b=lt();Object(r.useEffect)((function(){o(Zc(t)),d(!1)}),[]);var p=function(){var e;return!(null===t||void 0===t||null===(e=t.customer)||void 0===e||!e.highValue)||(null===i||void 0===i?void 0:i.invoicesVatExempt)};return u?"":Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsxs)(Wt.a,{container:!0,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:"New Invoice Line"})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,className:Object(_r.a)(b.pt3,b.pb2),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Kt.b,{initialValues:{_id:t._id,service:"",charged:"",description:"",addVat:function(){var e;return(null===i||void 0===i||!i.invoicesVatExempt)&&(null===t||void 0===t||null===(e=t.customer)||void 0===e?void 0:e.highValue)}()},validationSchema:fr,onSubmit:function(e){return j((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Tc()),e.prev=1,e.next=4,fc(t);case 4:a=e.sent,c=a.data,i=r().INVOICES.invoices,o=i&&i.map((function(e){return e._id===c._id?c:e})),n({type:N,payload:o}),n({type:M,payload:c}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),er.b.error("Error getting invoice"),n(Ec(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()));var t},children:function(e){var t=e.errors,r=e.values,a=e.handleChange,c=e.setFieldValue,i=e.handleSubmit;return Object(Ze.jsxs)(Kt.a,{children:[Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(At,{label:"Service",name:"service",defaultValue:r.service,handleChange:function(e,t){return c("service",(null===t||void 0===t?void 0:t.value)||"")},fullWidth:!0,options:Gn(n)})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:b.mt2,label:"Description",value:r.description,errors:t.description,onChange:a,name:"description",fullWidth:!0,multiline:!0,rows:4})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:b.mt2,label:"Amount Charged",value:r.charged,errors:t.charged,onChange:a,name:"charged",fullWidth:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Tt,{label:"Add Vat (20%)",handleChange:function(e,t){c("addVat",t)},name:"addVat",checked:r.addVat,errors:t.addVat,disabled:p})})]}),Object(Ze.jsx)(Yt.a,{className:b.mt2,onClick:i,variant:"contained",color:"primary",type:"submit",fullWidth:!0,children:"Create Invoice Line"})]})}})})]})})},to=function(e){var t=e.invoice,n=e.services,r=t.lines,a=null===r||void 0===r?void 0:r.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{_id:Object(ha.a)()})})),c=null===a||void 0===a?void 0:a.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{invoiceLines:a,invoice:t,services:n})})),i=lt();return Object(Ze.jsxs)(dt.a,{className:i.pt3,style:{minHeight:300},children:[Object(Ze.jsx)(dt.a,{className:Object(_r.a)(i.pt2,i.pl2),children:Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"Invoice Lines"})}),Object(Ze.jsx)(Pa.a,{noHeader:!0,data:c,columns:Wc}),Object(Ze.jsx)(dt.a,{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center",children:Object(Ze.jsx)(Gt,{openButtonText:"ADD INVOICE LINE",children:Object(Ze.jsx)(eo,{invoice:t,services:n})})})]})},no=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("services");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ro=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("services",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ao=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("services/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),co=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("services/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),io=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("services/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oo=function(){return function(e){e({type:ne,payload:!0})}},so=function(e){return function(t){t({type:te,payload:e})}},lo=function(){return function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(oo()),e.prev=1,e.next=4,no();case 4:n=e.sent,r=n.data,t({type:$,payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error getting services"),t(so(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},uo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("purchases",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("purchases",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("purchases/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),po=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("purchases/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("purchases/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fo=function(){return function(e){e({type:B,payload:!0})}},Oo=function(e){return function(t){t({type:q,payload:e})}},ho=function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(fo()),t.prev=1,t.next=4,uo(e);case 4:r=t.sent,a=r.data,n({type:Y,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting purchases"),n(Oo(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},mo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("purchase-categories");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("purchase-categories",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),go=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("purchase-categories/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("purchase-categories/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wo=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("purchase-categories/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),So=function(){return function(e){e({type:J,payload:!0})}},Co=function(e){return function(t){t({type:K,payload:e})}},To=function(){return function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(So()),e.prev=1,e.next=4,mo();case 4:n=e.sent,r=n.data,t({type:W,payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error getting purchase categories"),t(Co(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},Eo=function(e){var t,n,a,c=e.purchase,i=Object(Ke.c)(Ve),o=Object(Ke.c)(qe),s=i.suppliers,l=o.purchaseCategories,d=i.loading||o.loading,j=Object(Ke.b)();return Object(r.useEffect)((function(){j(To()),j(Ci())}),[]),d?"Loading":Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Update Invoice Expense",initialValues:Object(u.a)(Object(u.a)({},c),{},{supplier:null===c||void 0===c||null===(t=c.supplier)||void 0===t?void 0:t._id,purchaseCategory:null===c||void 0===c||null===(n=c.purchaseCategory)||void 0===n?void 0:n._id,invoice:null===c||void 0===c||null===(a=c.invoice)||void 0===a?void 0:a._id,invoiceLinesCount:null===c||void 0===c?void 0:c.invoiceLines.count,invoiceLinesDelivered:null===c||void 0===c?void 0:c.invoiceLines.delivered,invoiceLinesBilled:null===c||void 0===c?void 0:c.invoiceLines.billed}),formFields:Po(s,l),validationSchema:mr,handleSubmit:function(e){return j(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o,s;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(fo()),t.prev=1,t.next=4,bo(e);case 4:a=t.sent,c=a.data,i=r().PURCHASES.purchases,o=r().INVOICES.invoice,s=null,i?(console.info("updating purchases"),s=i.map((function(e){return e._id===c._id?c:e}))):o?(null===o||void 0===o?void 0:o._id)===(null===c||void 0===c?void 0:c._id)&&(console.log("invoice match",null===o||void 0===o?void 0:o._id),n(Ic(null===o||void 0===o?void 0:o._id))):n(uo()),n({type:Y,payload:s}),er.b.success("Purchase updated successfully"),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(1),er.b.error("Error updating purchase"),n(Oo(t.t0));case 18:case"end":return t.stop()}}),t,null,[[1,14]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},Do=function(e){var t,n,r=e.purchase,a=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:r.name||"Purchase Category"})})}),Object(Ze.jsx)(dt.a,{className:a.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"Invoice #",info:r.invoice.autoId},{title:"PDF Name",info:null===r||void 0===r?void 0:r.pdfName},{title:"PDF Number",info:null===r||void 0===r?void 0:r.pdfPageNumber},{title:"Description",info:r.details},{title:"Supplier",info:r.supplier.name},{title:"Purchase Category",info:r.purchaseCategory.name},{title:"Purchase Invoice Lines",info:"\n                        Count: ".concat(null===r||void 0===r?void 0:r.invoiceLines.count,", \n                        Billed: ").concat(null===r||void 0===r||null===(t=r.invoiceLines)||void 0===t?void 0:t.billed,", \n                        Delivered: ").concat(null===r||void 0===r||null===(n=r.invoiceLines)||void 0===n?void 0:n.delivered)},{title:"Total",info:"\xa3 ".concat(r.total)},{title:"Created",info:za()(r.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(r.updated).format("DD MMM YYYY")}]})]})},Io=function(e){var t,n=e.purchase,r=Object(Ke.b)(),a=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Purchase"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:n.name||"Purchase Category"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(a.pt3,a.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Invoiced TO",info:n.name},{title:"PDF Name",info:null===n||void 0===n?void 0:n.pdfName},{title:"PDF Number",info:null===n||void 0===n?void 0:n.pdfPageNumber},{title:"Invoice #",info:null===n||void 0===n||null===(t=n.invoice)||void 0===t?void 0:t.autoId},{title:"Description",info:n.details},{title:"Supplier",info:n.supplier.name},{title:"Purchase Category",info:n.purchaseCategory.name},{title:"Created",info:za()(n.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(n.updated).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:a.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Purchase will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:a.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){r(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(fo()),t.prev=1,t.next=4,po(e);case 4:a=r().PURCHASES.purchases,c=r().INVOICES.invoice,a?(i=a.filter((function(t){return t._id!==e})),n({type:Y,payload:i})):n(c?Ic(null===c||void 0===c?void 0:c._id):uo()),er.b.success("Purchase deleted successfully"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),er.b.error("Error deleting purchase"),n(Oo(t.t0));case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}()}(n._id))},children:"Confirm Delete"})})]})},Ao=Io,ko=n(516),_o=n.n(ko),Ro=function(e){var t=e.product,n=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t.name||"Product"})})}),Object(Ze.jsx)(dt.a,{className:n.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Supplier",info:t.supplier.name},{title:"Purchase Category",info:t.purchaseCategory.name},{title:"Unit",info:"\xa3 ".concat(new _o.a(null===t||void 0===t?void 0:t.unitPrice).toFixed(2)," per ").concat(t.unit)},{title:"Description",info:t.description},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})]})},No=function(e){var t=e.purchase,n=Object(Sn.j)();return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:["/purchases"===n.path&&(null===t||void 0===t?void 0:t.invoice)&&Object(Ze.jsx)(Ht.a,{title:"View Invoice",children:Object(Ze.jsx)(qt.a,{onClick:function(){return Jn("/#/invoices/".concat(t.invoice._id,"/view"))},children:Object(Ze.jsx)(et,{name:"Receipt"})})}),(null===t||void 0===t?void 0:t.product)&&Object(Ze.jsx)(Gt,{openButtonIcon:"ProductionQuantityLimits",open:!1,children:Object(Ze.jsx)(Ro,{product:t.product})},"Product"),Object(Ze.jsx)(Gt,{openButtonIcon:"Edit",open:!1,tooltip:"Edit",children:Object(Ze.jsx)(Eo,{purchase:t})}),Object(Ze.jsx)(Gt,{openButtonIcon:"FolderOpen",open:!1,tooltip:"View",children:Object(Ze.jsx)(Do,{purchase:t})}),Object(Ze.jsx)(Gt,{openButtonIcon:"Delete",open:!1,tooltip:"Delete",children:Object(Ze.jsx)(Ao,{purchase:t})})]})},Mo=[{name:"#Id",selector:function(e){return"# ".concat(e.autoId)},sortable:!0},{name:"Invoice/Product (#)",selector:function(e){var t,n,r;return"# ".concat(null!==e&&void 0!==e&&null!==(t=e.invoice)&&void 0!==t&&t.autoId?null===e||void 0===e||null===(n=e.invoice)||void 0===n?void 0:n.autoId:null===e||void 0===e||null===(r=e.product)||void 0===r?void 0:r.autoId)},sortable:!0},{name:"Supplier",selector:function(e){return e.supplier.name},sortable:!0},{name:"Category",selector:function(e){return e.purchaseCategory.name},sortable:!0},{name:"Warranty",selector:function(e){return e.warranty},sortable:!0},{name:"Total",selector:function(e){return"\xa3 ".concat(e.total)},sortable:!0},{name:"Invoice Date",selector:function(e){return za()(e.supplierInvoiceDate).format("DD MMM YYYY")},sortable:!0},{name:"Actions",selector:function(e){return No({purchase:e})}}],Po=function(e,t){return[{component:"MuiTextField",name:"invoicedTo",label:"Invoiced To"},{component:"MuiTextField",name:"pdfName",label:"PDF Name",size:{sm:6,md:6}},{component:"MuiTextField",name:"pdfPageNumber",label:"Page No",size:{sm:6,md:6}},{component:"MuiTextField",name:"details",multiline:!0,rows:2,label:"Purchase Invoice Details"},{component:"MuiTextField",name:"invoiceLinesCount",label:"Invoice Lines Count",size:{sm:6,md:6}},{component:"MuiTextField",name:"invoiceLinesBilled",label:"Invoice Lines Billed",size:{sm:6,md:6}},{component:"MuiTextField",name:"invoiceLinesDelivered",label:"Invoice Lines Delivered",size:{sm:6,md:6}},{component:"MuiTextField",name:"amount",label:"Sub Total (Pre VAT)",size:{sm:6,md:6}},{component:"MuiTextField",name:"vat",label:"Invoice Vat",size:{sm:6,md:6}},{component:"MuiTextField",name:"total",label:"Invoice Total",size:{sm:6,md:6}},{component:"MuiTextField",name:"warranty",label:"Warranty",size:{sm:6,md:6}},{component:"MuiCheckBox",name:"paid",label:"Paid",size:{sm:6,md:6}},{component:"MuiSelectField",name:"supplier",label:"Supplier",options:Wn(e,"name","_id")},{component:"MuiSelectField",name:"purchaseCategory",label:"Purchase Category",options:Wn(t,"name","_id")},{component:"MuiTextField",name:"supplierInvoiceNumber",label:"Supplier Invoice Number"},{component:"MuiDatepicker",name:"supplierInvoiceDate",label:"Supplier Invoice Date "}]},Uo=function(e){var t=e.invoice,n=e.product,a=Object(Ke.c)(Ve),c=Object(Ke.c)(qe),i=a.suppliers,o=c.purchaseCategories,s=a.loading||c.loading,l=Object(Ke.b)();return Object(r.useEffect)((function(){l(To()),l(Ci())}),[]),s?"Loading":Object(Ze.jsx)(dt.a,{p:1,style:{paddingBottom:100},children:Object(Ze.jsx)(Zt,{title:"New Purchase",initialValues:{invoice:null===t||void 0===t?void 0:t._id,product:null===n||void 0===n?void 0:n._id,invoicedTo:pt.name,pdfName:"",pdfPageNumber:1,warranty:"30 Days",details:"",paid:!1,amount:(null===n||void 0===n?void 0:n.unitPrice)||0,vat:0,total:0,supplier:"",supplierInvoiceNumber:"",purchaseCategory:"",invoiceLinesCount:1,invoiceLinesBilled:1,invoiceLinesDelivered:1,supplierInvoiceDate:za()().format("DD-MMM-YYYY")},formFields:Po(i,o),validationSchema:mr,handleSubmit:function(e){return l((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o,s,l;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(fo()),e.prev=1,e.next=4,jo(t);case 4:a=e.sent,c=a.data,i=r().PURCHASES,o=i.purchases,s=i.layout,(null===(l=r().INVOICES.invoice)||void 0===l?void 0:l._id)===(null===c||void 0===c?void 0:c.invoice)&&n(Ic(null===l||void 0===l?void 0:l._id)),o?(o.push(c),n({type:Y,payload:o})):n({type:Y,payload:[c]}),n({type:z,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Purchase created successfully"),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),er.b.error("Error creating purchase"),n(Oo(e.t0));case 19:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t,n){return e.apply(this,arguments)}}()));var t}})})},Fo=Uo,Lo=ei.f.create({body:{paddingTop:35,paddingBottom:65,paddingHorizontal:35},title:{fontSize:24,textAlign:"center",fontFamily:"Oswald"},author:{fontSize:12,textAlign:"center",marginBottom:40},subtitle:{fontSize:18,margin:12,fontFamily:"Oswald"},text:{margin:12,fontSize:10,textAlign:"justify",fontFamily:"Times-Roman"},image:{margin:12},header:{fontSize:10,marginHorizontal:12,textAlign:"justify",color:"grey"},pageNumber:{position:"absolute",fontSize:10,bottom:20,left:0,right:0,textAlign:"center",color:"grey"},row:{flexDirection:"row",alignItems:"center"},tableColumnOne:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"10%"},tableColumnTwo:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"20%"},tableColumnFive:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"50%"},w1:{width:"10%"},w2:{width:"20%"},w3:{width:"30%"},w4:{width:"40%"},w5:{width:"50%"},divider:{borderBottom:"1px solid #ccc",marginVertical:10},marginVertical:{marginVertical:10},marginHorizontal:{marginHorizontal:10},downloadLink:{textDecoration:"none"}});ei.b.register({family:"Oswald",src:"https://fonts.gstatic.com/s/oswald/v13/Y_TKV6o8WovbUd3m_X9aAA.ttf"});var Vo=function(e){var t,n,a,c,i,o,s,l,u,d,j,b=e.invoice,p=Object(r.useState)(null),v=Object(Pe.a)(p,2),f=v[0],O=v[1],h=Object(r.useState)({}),m=Object(Pe.a)(h,2),x=m[0],g=m[1];Object(r.useEffect)((function(){var e=Zc(b);g(e),Xn((null===e||void 0===e?void 0:e.logo)||(null===pt||void 0===pt?void 0:pt.appLogo),(function(e){return O(e)}))}),[]);return Object(Ze.jsx)(ei.a,{children:Object(Ze.jsxs)(ei.e,{style:Lo.body,wrap:!0,size:"A4",children:[Object(Ze.jsx)(dt.a,{style:Lo.w3,children:f&&Object(Ze.jsx)(ei.c,{src:f,style:Lo.image})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsxs)(ei.g,{style:Lo.text,children:[x.displayName," ","\n",pt.address.line1," ","\n",pt.address.line2," ","\n",pt.address.city," ","\n",pt.address.postalCode," ","\n"]})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsxs)(ei.g,{style:Lo.text,children:["Invoiced To: ","\n",null===b||void 0===b||null===(t=b.customer)||void 0===t?void 0:t.name," ","\n",(null===b||void 0===b||null===(n=b.customer)||void 0===n?void 0:n.addressLine1)&&"".concat(null===b||void 0===b||null===(a=b.customer)||void 0===a?void 0:a.addressLine1," \n"),(null===b||void 0===b||null===(c=b.customer)||void 0===c?void 0:c.addressLine2)&&"".concat(null===b||void 0===b||null===(i=b.customer)||void 0===i?void 0:i.addressLine2," \n"),null===b||void 0===b||null===(o=b.customer)||void 0===o?void 0:o.town," ","\n",null===b||void 0===b||null===(s=b.customer)||void 0===s?void 0:s.postalCode]})}),Object(Ze.jsxs)(ei.h,{style:Lo.row,children:[Object(Ze.jsx)(dt.a,{style:Lo.w2,children:Object(Ze.jsxs)(ei.g,{style:Lo.header,children:[" Invoice #",b.autoId]})}),Object(Ze.jsx)(dt.a,{style:Lo.w3,children:Object(Ze.jsx)(ei.g,{style:Lo.text,children:za()(null===b||void 0===b?void 0:b.invoiceDate).format("DD/MM/YYYY")})})]}),Object(Ze.jsx)(ei.g,{style:Lo.text,children:"Invoice Lines"}),Object(Ze.jsxs)(ei.h,{style:Lo.row,children:[Object(Ze.jsx)(ei.g,{style:Lo.tableColumnTwo,children:"Item"}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnFive,children:"Description"}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnOne,children:"Amount"}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnOne,children:"VAT"}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnOne,children:"Total"})]}),Object(Ze.jsx)(dt.a,{style:Lo.divider}),null===b||void 0===b||null===(l=b.lines)||void 0===l?void 0:l.map((function(e,t){var n,r;return Object(Ze.jsxs)(ei.h,{style:Lo.row,children:[Object(Ze.jsx)(ei.g,{style:Lo.tableColumnTwo,children:e.service.title}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnFive,children:(null===e||void 0===e?void 0:e.description)||(null===e||void 0===e||null===(n=e.service)||void 0===n?void 0:n.description)}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnOne,children:"\xa3 ".concat((null===e||void 0===e||null===(r=e.charged)||void 0===r?void 0:r.toFixed(2))||0)}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnOne,children:"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(.2*e.charged).toFixed(2):"0.00")}),Object(Ze.jsx)(ei.g,{style:Lo.tableColumnOne,children:"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(1.2*e.charged).toFixed(2):e.charged.toFixed(2))})]},t)})),Object(Ze.jsxs)(ei.h,{style:Lo.row,children:[Object(Ze.jsxs)(ei.h,{style:Lo.w2,children:[Object(Ze.jsxs)(ei.g,{style:Lo.text,children:["Sub Total ","\n","VAT ","\n","Total ","\n"]}),Object(Ze.jsx)(dt.a,{style:Lo.divider}),Object(Ze.jsx)(ei.g,{style:Lo.text,children:"Outstanding"})]}),Object(Ze.jsxs)(ei.h,{style:Lo.w2,children:[Object(Ze.jsxs)(ei.g,{style:Lo.text,children:[(null===b||void 0===b||null===(u=b.subTotal)||void 0===u?void 0:u.toFixed(2))||0," ","\n",(null===b||void 0===b||null===(d=b.vatAmount)||void 0===d?void 0:d.toFixed(2))||0," ","\n",(null===b||void 0===b||null===(j=b.total)||void 0===j?void 0:j.toFixed(2))||0," ","\n"]}),Object(Ze.jsx)(dt.a,{style:Lo.divider}),Object(Ze.jsx)(ei.g,{style:Lo.text,children:"\xa3 ".concat(b.balancePayable.toFixed(2)||0)})]})]}),(null===x||void 0===x?void 0:x.invoice)&&Object(Ze.jsx)(ei.g,{style:Lo.pageNumber,render:function(){var e,t,n,r,a,c,i,o,s,l,u,d,j,b,p,v,f,O,h,m,g,y="";(y+="".concat(null===x||void 0===x||null===(e=x.invoice)||void 0===e||null===(t=e.address)||void 0===t?void 0:t.line1," ").concat(null===x||void 0===x||null===(n=x.invoice)||void 0===n||null===(r=n.address)||void 0===r?void 0:r.line2," ").concat(null===x||void 0===x||null===(a=x.invoice)||void 0===a||null===(c=a.address)||void 0===c?void 0:c.city," ").concat(null===x||void 0===x||null===(i=x.invoice)||void 0===i||null===(o=i.address)||void 0===o?void 0:o.postalCode," \n"),null!==x&&void 0!==x&&null!==(s=x.invoice)&&void 0!==s&&s.email)&&(y+="email:  ".concat(null===x||void 0===x||null===(j=x.invoice)||void 0===j?void 0:j.email,", "));null!==x&&void 0!==x&&null!==(l=x.invoice)&&void 0!==l&&l.phone&&(y+="phone:  ".concat(null===x||void 0===x||null===(b=x.invoice)||void 0===b?void 0:b.phone," \n"));null!==x&&void 0!==x&&null!==(u=x.invoice)&&void 0!==u&&u.bank&&(y+="".concat(null===x||void 0===x||null===(p=x.invoice)||void 0===p||null===(v=p.bank)||void 0===v?void 0:v.name," AC: ").concat(null===x||void 0===x||null===(f=x.invoice)||void 0===f||null===(O=f.bank)||void 0===O?void 0:O.account," ~ SC: ").concat(null===x||void 0===x||null===(h=x.invoice)||void 0===h||null===(m=h.bank)||void 0===m?void 0:m.sortCode,"\n"));null!==x&&void 0!==x&&null!==(d=x.invoice)&&void 0!==d&&d.vatNo&&(y+="VAT NO: ".concat(null===x||void 0===x||null===(g=x.invoice)||void 0===g?void 0:g.vatNo));return y},fixed:!0})]})})},Yo=function(e){var t=e.invoice;return Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(ei.d,{style:Lo.downloadLink,document:Object(Ze.jsx)(Vo,{invoice:t}),fileName:"Invoice-".concat(t.autoId,".pdf"),children:function(e){return e.loading?"...":Object(Ze.jsx)(Yt.a,{variant:"contained",children:"DOWNLOAD INVOICE"})}})})},Ho=function(e){var t=e.invoice;return Object(Ze.jsx)(Yo,{invoice:t})},qo=function(e){var t=e.invoice,n=Object(r.useState)(!1),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(Ke.b)(),s=lt(),l=Object(Ke.c)(He).layout;return Object(r.useEffect)((function(){i(l.openCreateDrawer)}),[l.openCreateDrawer]),Object(Ze.jsx)(Ze.Fragment,{children:Object(Ze.jsxs)(dt.a,{width:"100",display:"flex",justifyContent:"space-between",className:s.pb2,children:[Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",justifyContent:"flex-start",children:[Object(Ze.jsx)(dt.a,{component:"span",className:s.pr1,children:Object(Ze.jsx)(Gt,{openButtonText:"Create Purchase",open:c,handleOpen:function(){return Bn(o,l,"UPDATE_PURCHASES_LAYOUT",!0)},handleClose:function(){return Bn(o,l,"UPDATE_PURCHASES_LAYOUT",!1)},children:Object(Ze.jsx)(Fo,{invoice:t})},"create")}),Object(Ze.jsx)(Gt,{openButtonText:"Edit Invoice Details",open:!1,children:Object(Ze.jsx)(Mc,{invoice:t})}),Object(Ze.jsx)(dt.a,{className:s.pl1,children:Object(Ze.jsx)(Ho,{invoice:t})})]}),Object(Ze.jsx)(Cn,{})]})})},Bo=function(e){var t=e.data;return console.log(t),Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Wa.a,{severity:"info",children:Object(Ze.jsx)(jt.a,{children:t.details})})})},zo=function(e){var t=e.invoice,n=lt(),r=(null===t||void 0===t?void 0:t.purchases)||[];return Object(Ze.jsxs)(dt.a,{className:n.pt2,children:[Object(Ze.jsx)(Qt.a,{}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(n.pt2,n.pl2),children:Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"Invoice Purchases (Expenses)"})}),Object(Ze.jsx)(Pa.a,{title:"ALL PURCHASES",noHeader:!0,fixedHeader:!0,highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,columns:Mo,expandableRows:!0,expandableRowsComponent:Bo,data:r||[]}),Object(Ze.jsx)(dt.a,{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center",children:Object(Ze.jsx)(Gt,{openButtonText:"Create Invoice Purchase",children:Object(Ze.jsx)(Fo,{invoice:t})})})]})},Go=function(){var e=Object(r.useState)(null),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=lt(),i=Object(Ke.b)(),o=Object(Sn.i)().id,s=Object(Ke.c)(Ye),l=Object(Ke.c)(Be),u=Object(Ke.c)(He),d=s.invoice,j=l.services,b=s.loading||l.loading||u.loading;return Object(r.useEffect)((function(){return i(Ic(o)),i(lo()),function(){i({type:"GET_INVOICE",payload:null})}}),[]),Object(r.useEffect)((function(){!function(){var e;if(null!==d&&void 0!==d&&d.department){var t=null===pt||void 0===pt||null===(e=pt.departments)||void 0===e?void 0:e.find((function(e){var t=e.name;return d.department===t}));t&&a(t.logo)}else a(pt.appLogo)}()}),[d]),!b&&d&&j?Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(qo,{invoice:d}),Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsxs)(dt.a,{p:4,children:[Object(Ze.jsx)(dt.a,{width:340,children:n?Object(Ze.jsx)("img",{src:n,alt:"app logo",width:"100%",className:c.rounded}):Object(Ze.jsx)(ft,{})}),Object(Ze.jsx)(jt.a,{variant:"h4",children:"Tax Invoice"}),Object(Ze.jsxs)(jt.a,{variant:"h5",children:["INV # ",null===d||void 0===d?void 0:d.autoId]}),Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(dt.a,{sx:{mr:5},children:Object(Ze.jsxs)(jt.a,{variant:"overline",children:["DATE : ",za()(d.invoiceDate).format("DD/MM/YYYY")]})}),Object(Ze.jsx)(dt.a,{sx:{mr:5},children:Object(Ze.jsxs)(jt.a,{variant:"overline",children:["REG : ",d.vehicleReg]})})]})]}),Object(Ze.jsx)(Qt.a,{}),Object(Ze.jsxs)(dt.a,{p:4,minHeight:720,children:[d&&Object(Ze.jsx)(Xi,{invoice:d}),d&&Object(Ze.jsx)(to,{invoice:d,services:j}),d&&Object(Ze.jsx)($i,{invoice:d}),d&&Object(Ze.jsx)(zo,{invoice:d})]})]})})]}):"Loading"},Wo=Go,Qo=function(){var e=Object(Sn.j)().url;return Object(Ze.jsx)(pa,{title:"Invoices",children:Object(Ze.jsxs)(Sn.d,{children:[Object(Ze.jsx)(Sn.b,{exact:!0,path:e,component:Ji},"all-invoices"),Object(Ze.jsx)(Sn.b,{exact:!0,path:"".concat(e,"/mot"),component:Ji},"mot-invoices"),Object(Ze.jsx)(Sn.b,{exact:!0,path:"".concat(e,"/:id/view"),component:Wo})]})})},Ko=function(){var e=Object(Ke.b)(),t=Object(Ke.c)(He),n=t.purchases,a=t.loading,c=lt(),i=function(){return e(ho())};Object(r.useEffect)((function(){i()}),[]);return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:c.pb2,children:Object(Ze.jsx)(vn,{placeholder:"Search",handleClear:ho,handleSearch:function(t){Object(d.isEmpty)(t)?i():e(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(fo()),t.prev=1,t.next=4,vo(e);case 4:r=t.sent,a=r.data,n({type:Y,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error searching for purchases"),n(Oo(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:t}))}})}),Object(Ze.jsx)(Pa.a,{title:"ALL PURCHASES",progressPending:a,fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,columns:Mo,expandableRows:!0,expandableRowsComponent:Bo,data:n||[]})]})})},Jo=Ko,Xo=function(){return Object(Ze.jsx)(pa,{title:"Purchases",children:Object(Ze.jsx)(Jo,{})})},Zo=function(e){var t=e.purchaseCategory,n=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Update Purchase Category",initialValues:t,validationSchema:xr,submitButtonText:"Update Purchase Category",formFields:as,handleSubmit:function(e){var t;n((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(So()),e.prev=1,e.next=4,go(t);case 4:a=e.sent,c=a.data,i=r().PURCHASE_CATEGORIES.purchaseCategories,o=i.map((function(e){return e._id===c._id?c:e})),n({type:W,payload:o}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),er.b.error("Error getting purchase category"),n(Co(e.t0));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},$o=function(e){var t=e.purchaseCategory,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Purchase Category"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Purchase Category"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Description",info:t.description},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Purchase Category will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o,s;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(So()),t.prev=1,t.next=4,yo(e);case 4:a=r().PURCHASE_CATEGORIES.purchaseCategories,c=a.filter((function(t){return t._id!==e})),n({type:W,payload:c}),t.next=15;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(typeof t.t0.response.data),s="string"===typeof(null===t.t0||void 0===t.t0||null===(i=t.t0.response)||void 0===i?void 0:i.data)?null===t.t0||void 0===t.t0||null===(o=t.t0.response)||void 0===o?void 0:o.data:"Error deleting purchase category",er.b.error(s),n(Co(t.t0));case 15:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},es=$o,ts=function(e){var t=e.purchaseCategory,n=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t.name||"Purchase Category"})})}),Object(Ze.jsx)(dt.a,{className:n.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Description",info:t.description},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})]})},ns=function(e){return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(Zo,{purchaseCategory:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",children:Object(Ze.jsx)(ts,{purchaseCategory:e})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(es,{purchaseCategory:e})},"delete")]})},rs=[{name:"Name",selector:function(e){return e.name},sortable:!0},{name:"Description",selector:function(e){return e.description},sortable:!0},{name:"Created",selector:function(e){return za()(e.created_at).format("DD MMM YYYY")},sortable:!0},{name:"Actions",selector:function(e){return ns(e)}}],as=[{component:"MuiTextField",name:"name",label:"Name"},{component:"MuiTextField",name:"description",label:"Description",multiline:!0,rows:5}],cs=function(){var e=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Create Purchase Category",initialValues:{name:"",description:""},validationSchema:xr,submitButtonText:"Create Purchase Category",formFields:as,handleSubmit:function(t){var n;e((n=t,function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(So()),e.prev=1,e.next=4,xo(n);case 4:a=e.sent,c=a.data,i=r().PURCHASE_CATEGORIES,o=i.purchaseCategories,s=i.layout,o.push(c),t({type:W,payload:o}),t({type:X,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Purchase category created successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),er.b.error("Error creating purchase category"),t(Co(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},is=cs,os=function(){var e=Object(r.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(Ke.b)(),i=Object(Ke.c)(qe),o=i.purchaseCategories,s=i.loading,l=i.layout,j=lt(),b=function(){return c(To())};Object(r.useEffect)((function(){b()}),[]),Object(r.useEffect)((function(){a(null===l||void 0===l?void 0:l.openCreateDrawer)}),[null===l||void 0===l?void 0:l.openCreateDrawer]);return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:j.pb2,children:Object(Ze.jsx)(vn,{placeholder:"Search",handleClear:b,handleSearch:function(e){Object(d.isEmpty)(e)?b():c(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(fo()),t.prev=1,t.next=4,wo(e);case 4:r=t.sent,a=r.data,n({type:W,payload:a}),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0),er.b.error("Error searching purchase categories"),n(Co(t.t0));case 14:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:e}))}})}),!s&&Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{open:n,openButtonText:"Create Purchase Category",handleOpen:function(){return c({type:"UPDATE_PURCHASE_CATEGORY_LAYOUT",payload:Object(u.a)(Object(u.a)({},l),{},{openCreateDrawer:!0})})},handleClose:function(){return c({type:"UPDATE_PURCHASE_CATEGORY_LAYOUT",payload:Object(u.a)(Object(u.a)({},l),{},{openCreateDrawer:!1})})},children:Object(Ze.jsx)(is,{})},"create")],title:"ALL PURCHASES CATEGORIES",fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,progressPending:s,subHeaderAlign:"right",subHeaderWrap:!0,columns:rs,data:o||[]})]})})},ss=os,ls=function(){return Object(Ze.jsx)(pa,{title:"Purchase Categories",children:Object(Ze.jsx)(ss,{})})},us=function(e){var t=e.service,n=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Update Service",initialValues:t,validationSchema:gr,submitButtonText:"Update Service",formFields:Os,handleSubmit:function(e){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(oo()),t.prev=1,t.next=4,ao(e);case 4:a=t.sent,c=a.data,i=r().SERVICES.services,o=i.map((function(e){return e._id===c._id?c:e})),n({type:$,payload:o}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),er.b.error("Error getting service"),n(so(t.t0));case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},ds=us,js=function(e){var t=e.service,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Service"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Service"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.title},{title:"Description",info:t.description},{title:"Unit Price",info:t.unitPrice},{title:"Unit Measure",info:t.unit},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Service will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(oo()),t.prev=1,t.next=4,co(e);case 4:a=r().SERVICES.services,c=a.filter((function(t){return t._id!==e})),n({type:$,payload:c}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting service"),n(so(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},bs=js,ps=function(e){var t=e.service,n=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:t.name||"Service"})})}),Object(Ze.jsx)(dt.a,{className:n.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.title},{title:"Description",info:t.description},{title:"Unit Price",info:t.unitPrice},{title:"Unit Measure",info:t.unit},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})]})},vs=function(e){return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(ds,{service:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",children:Object(Ze.jsx)(ps,{service:e})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(bs,{service:e})},"delete")]})},fs=[{name:"Name",selector:function(e){return e.title},sortable:!0},{name:"Description",selector:function(e){return e.description},sortable:!0},{name:"Unit Price",selector:function(e){return e.unitPrice},sortable:!0},{name:"Unit Measure",selector:function(e){return e.unit},sortable:!0},{name:"Created",selector:function(e){return za()(e.created).format("DD MMM YYYY")},sortable:!0},{name:"Actions",selector:function(e){return vs(e)}}],Os=[{component:"MuiTextField",name:"title",label:"Name"},{component:"MuiTextField",name:"description",label:"Description",multiline:!0,rows:5},{component:"MuiTextField",name:"unitPrice",label:"Unit Price"},{component:"MuiSelectField",name:"unit",label:"Unit measure",options:[{label:"Single",value:"item"},{label:"Hourly",value:"hourly"},{label:"General",value:"general"}]},{component:"MuiCheckBox",name:"chargeVat",label:"Force Charge VAT"}],hs=function(){var e=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Create Service",initialValues:{title:"",description:"",unitPrice:0,unit:"item"},validationSchema:gr,submitButtonText:"Create Service",formFields:Os,handleSubmit:function(t){var n;e((n=t,function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(oo()),e.prev=1,e.next=4,ro(n);case 4:a=e.sent,c=a.data,i=r().SERVICES,o=i.services,s=i.layout,o.push(c),t({type:$,payload:o}),t({type:re,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Service created successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),er.b.error("Error creating service"),t(so(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},ms=hs,xs=function(){var e=Object(r.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(Ke.b)(),i=Object(Ke.c)(Be),o=i.services,s=i.loading,l=i.layout,j=lt(),b=function(){return c(lo())};Object(r.useEffect)((function(){b()}),[]),Object(r.useEffect)((function(){a(null===l||void 0===l?void 0:l.openCreateDrawer)}),[null===l||void 0===l?void 0:l.openCreateDrawer]);return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:j.pb2,children:Object(Ze.jsx)(vn,{placeholder:"Search",handleClear:b,handleSearch:function(e){Object(d.isEmpty)(e)?b():c(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(oo()),t.prev=1,t.next=4,io(e);case 4:r=t.sent,a=r.data,n({type:$,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error searching for services"),n(so(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:e}))}})}),Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{open:n,openButtonText:"Create Service",handleOpen:function(){return c({type:"UPDATE_PURCHASE_CATEGORY_LAYOUT",payload:Object(u.a)(Object(u.a)({},l),{},{openCreateDrawer:!0})})},handleClose:function(){return c({type:"UPDATE_PURCHASE_CATEGORY_LAYOUT",payload:Object(u.a)(Object(u.a)({},l),{},{openCreateDrawer:!1})})},children:Object(Ze.jsx)(ms,{})},"create")],title:"ALL SERVICES",fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,progressPending:s,subHeaderAlign:"right",subHeaderWrap:!0,columns:fs,data:o||[]})]})})},gs=xs,ys=function(){return Object(Ze.jsx)(pa,{title:"Services",children:Object(Ze.jsx)(gs,{})})},ws=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("products");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ss=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("products",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Cs=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("products/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ts=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("products/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Es=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("products/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ds=function(){return function(e){e({type:se,payload:!0})}},Is=function(e){return function(t){t({type:oe,payload:e})}},As=function(){return function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Ds()),e.prev=1,e.next=4,ws();case 4:n=e.sent,r=n.data,t({type:ce,payload:r}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),er.b.error("Error getting products"),t(Is(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},ks=function(e){var t,n,a,c=e.product,i=Object(r.useState)([]),o=Object(Pe.a)(i,2),s=o[0],l=o[1],d=Object(r.useState)([]),j=Object(Pe.a)(d,2),b=j[0],p=j[1],v=Object(Ke.b)(),f=Object(Ke.c)(qe),O=f.purchaseCategories,h=f.loading,m=Object(Ke.c)(Ve),x=m.suppliers,g=m.loading;return Object(r.useEffect)((function(){O||h||v(To()),x||g||v(Ci())}),[]),Object(r.useEffect)((function(){if(O){var e=Wn(O,"name","_id");l(e)}if(x){var t=Wn(x,"name","_id");p(t)}}),[O,x]),Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Update Product",initialValues:Object(u.a)(Object(u.a)({},c),{},{supplier:null===c||void 0===c||null===(t=c.supplier)||void 0===t?void 0:t._id,purchaseCategory:null===c||void 0===c||null===(n=c.supplier)||void 0===n||null===(a=n.purchaseCategories)||void 0===a?void 0:a._id}),validationSchema:yr,submitButtonText:"Update Product",formFields:Fs(s,b),handleSubmit:function(e){var t;v((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Ds()),e.prev=1,e.next=4,Cs(t);case 4:a=e.sent,c=a.data,i=r().PRODUCTS.products,o=i.map((function(e){return e._id===c._id?c:e})),n({type:ce,payload:o}),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),er.b.error("Error getting product"),n(Is(e.t0));case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},_s=ks,Rs=function(e){var t=e.product,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Product"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Product"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Name",info:t.name},{title:"Description",info:t.description},{title:"Created",info:za()(t.created).format("DD MMM YYYY")},{title:"Last Updated",info:za()(t.updated).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Product will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Ds()),t.prev=1,t.next=4,Ts(e);case 4:a=r().PRODUCTS.products,c=a.filter((function(t){return t._id!==e})),n({type:ce,payload:c}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting product"),n(Is(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},Ns=Rs,Ms=function(e){var t=e.product,n=Object(r.useState)(null),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=lt();return Object(r.useEffect)((function(){Object(An.a)(Object(In.a)().mark((function e(){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,uo({product:t._id});case 2:n=e.sent,r=n.data,i(r);case 5:case"end":return e.stop()}}),e)})))()}),[]),t?Object(Ze.jsx)(dt.a,{className:o.mt3,children:Object(Ze.jsx)(Pa.a,{title:"PRODUCT PURCHASES",fixedHeader:!0,actions:[Object(Ze.jsx)(Gt,{openButtonText:"Create Purchase",children:Object(Ze.jsx)(Fo,{product:t})},"create")],highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,columns:Mo,expandableRows:!0,expandableRowsComponent:Bo,data:c||[]})}):"Loading"},Ps=function(e){var t=window.innerWidth>1024?window.innerWidth-305:620;return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(_s,{product:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",children:Object(Ze.jsx)(Ro,{product:e})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"ShoppingBasket",width:t,children:Object(Ze.jsx)(Ms,{product:e})},"purchases"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(Ns,{product:e})},"delete")]})},Us=[{name:"Name",selector:function(e){return e.name},sortable:!0},{name:"Description",selector:function(e){return e.description},sortable:!0},{name:"Unit Price",selector:function(e){return null===e||void 0===e?void 0:e.unitPrice},sortable:!0},{name:"Unit",selector:function(e){return null===e||void 0===e?void 0:e.unit},sortable:!0},{name:"Purchase Category",selector:function(e){var t;return null===e||void 0===e||null===(t=e.purchaseCategory)||void 0===t?void 0:t.name},sortable:!0},{name:"Default Supplier",selector:function(e){var t;return null===e||void 0===e||null===(t=e.supplier)||void 0===t?void 0:t.name},sortable:!0},{name:"Created",selector:function(e){return za()(e.created).format("DD MMM YYYY")},sortable:!0},{name:"Actions",selector:function(e){return Ps(e)},width:"170px"}],Fs=function(e,t){return[{component:"MuiTextField",name:"name",label:"Name"},{component:"MuiSelectField",name:"purchaseCategory",label:"Purchase Category",options:e},{component:"MuiSelectField",name:"supplier",label:"Default Supplier",options:t},{component:"MuiSelectField",name:"unit",label:"Unit of measure",options:[{label:"Single Item",value:"item"},{label:"KG",value:"Kg"},{label:"Litres",value:"Ltr"},{label:"Meters",value:"meter"},{label:"Square Meters",value:"square meter"},{label:"Ounce",value:"ounce"},{label:"Pounds",value:"pound"}]},{component:"MuiTextField",name:"unitPrice",label:"Unit Price (\xa3)",type:"number"},{component:"MuiTextField",name:"description",label:"Description",multiline:!0,rows:5}]},Ls=function(){var e=Object(r.useState)([]),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),i=Object(Pe.a)(c,2),o=i[0],s=i[1],l=Object(Ke.b)(),d=Object(Ke.c)(qe),j=d.purchaseCategories,b=d.loading,p=Object(Ke.c)(Ve),v=p.suppliers,f=p.loading;return Object(r.useEffect)((function(){j||b||l(To()),v||f||l(Ci())}),[]),Object(r.useEffect)((function(){if(j){var e=Wn(j,"name","_id");a(e)}if(v){var t=Wn(v,"name","_id");s(t)}}),[j,v]),Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Create Product",initialValues:{name:"",description:"",purchaseCategory:null,unitPrice:0,unit:"item"},validationSchema:yr,submitButtonText:"Create Product",formFields:Fs(n,o),handleSubmit:function(e){var t;l((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Ds()),e.prev=1,e.next=4,Ss(t);case 4:a=e.sent,c=a.data,i=r().PRODUCTS,o=i.products,s=i.layout,o.push(c),n({type:ce,payload:o}),n({type:le,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Product created successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),er.b.error("Error creating product"),n(Is(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},Vs=Ls,Ys=function(){var e=Object(r.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(Ke.b)(),i=lt(),o=Object(Ke.c)(ze),s=o.products,l=o.loading,j=o.layout;if(Object(r.useEffect)((function(){c(As())}),[]),Object(r.useEffect)((function(){a(null===j||void 0===j?void 0:j.openCreateDrawer)}),[null===j||void 0===j?void 0:j.openCreateDrawer]),l)return"Loading";var b=function(){c(As())};return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:i.pb2,children:Object(Ze.jsx)(vn,{placeholder:"Search",handleClear:b,handleSearch:function(e){Object(d.isEmpty)(e)?b():c(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Ds()),t.prev=1,t.next=4,Es(e);case 4:r=t.sent,a=r.data,n({type:ce,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error searching for Products"),n(Is(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:e}))}})}),Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{open:n,openButtonText:"Create Product",handleOpen:function(){return c({type:"UPDATE_PRODUCT_LAYOUT",payload:Object(u.a)(Object(u.a)({},j),{},{openCreateDrawer:!0})})},handleClose:function(){return c({type:"UPDATE_PRODUCT_LAYOUT",payload:Object(u.a)(Object(u.a)({},j),{},{openCreateDrawer:!1})})},children:Object(Ze.jsx)(Vs,{})},"create")],title:"PRODUCTS",fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,progressPending:l,subHeaderAlign:"right",subHeaderWrap:!0,columns:Us,data:s||[]})]})})},Hs=Ys,qs=function(){return Object(Ze.jsx)(pa,{title:"PRODUCTS",children:Object(Ze.jsx)(Hs,{})})},Bs=function(e,t){return[{name:"Invoice No",selector:function(e){return"#"+(null===e||void 0===e?void 0:e.autoId)},sortable:!0},{name:"Vehicle Model - Reg ",selector:function(e){var t;return e.vehicleModel+" - "+(null===(t=e.vehicleReg)||void 0===t?void 0:t.toUpperCase())},sortable:!0},{name:"Total ",selector:function(e){return e.total},sortable:!0},{name:"Review",cell:function(n){var r;return Object(Ze.jsx)(Vt,{onChange:function(t){return e(t,n)},name:"review",value:(null===t||void 0===t||null===(r=t.find((function(e){return e._id===n._id})))||void 0===r?void 0:r.review)||n.review,options:[{value:"accepted",label:"Accept",isDisable:!1},{value:"rejected",label:"Reject",isDisable:!1}]})}}]},zs=function(e){var t=e.invoices,n=Object(r.useState)([]),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)([]),s=Object(Pe.a)(o,2),l=s[0],u=s[1];Object(r.useEffect)((function(){i(t)}),[]);var d=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Sc(l);case 3:er.b.success("Invoice reviewed"),u([]),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0),er.b.error("Failed to update invoice reviews");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(Ze.jsx)(Pa.a,{columns:Bs((function(e,t){var n=e.target.value,r=c.map((function(e){return e._id===t._id&&(e.review=n),e})),a=function(e,t,n){return e.find((function(e){var n=e._id;return t===n}))?(e.map((function(e){return e._id===t?n:e})),e):(e.push(n),e)}(l,t._id,{_id:t._id,review:n});u(a),i(r)}),c),conditionalRowStyles:[{when:function(e){return e.review},style:function(e){return{backgroundColor:"accepted"===e.review?nt.success.main:nt.error.main}}}],actions:[Object(Ze.jsx)(Yt.a,{onClick:d,color:"primary",variant:"contained",disabled:(null===l||void 0===l?void 0:l.length)<=0,children:"UPDATE INVOICES"},"update")],data:t})},Gs=function(e){var t=e.invoicesByDate.map((function(e){var t=e._id,n=e.invoices;return{key:t,isDisabled:0===(null===n||void 0===n?void 0:n.length),title:t,details:zs({invoices:n})}}));return Object(Ze.jsx)(un,{items:t})},Ws=function(){var e=Object(Ke.b)(),t=Object(Ke.c)(Ye),n=t.grouped,a=t.loading,c=n.byDate;return Object(r.useEffect)((function(){e(function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Tc()),e.next=3,Br();case 3:n=e.sent,r=n.data,t(Ac({byDate:r}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),a?"Loading":Object(Ze.jsx)(dt.a,{children:c&&Object(Ze.jsx)(Gs,{invoicesByDate:c})})},Qs=Ws,Ks=function(){return Object(Ze.jsx)(pa,{title:"Weekly Sales",children:Object(Ze.jsx)(Qs,{})})},Js=n(183),Xs=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("/approvals",{params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Zs=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.patch("/approvals/".concat(t.id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$s=(n(1050),n(1051),Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(null===e||void 0===e?void 0:e.value),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(!0),s=Object(Pe.a)(o,2),l=s[0],u=s[1],d=Object(r.useRef)(null);return Object(r.useEffect)((function(){focus()}),[]),Object(r.useImperativeHandle)(t,(function(){return{getValue:function(){return c},isPopup:function(){return!0}}})),Object(r.useEffect)((function(){l||e.api.stopEditing()}),[l]),Object(Ze.jsx)("div",{style:{paddingLeft:20,width:200},ref:d,children:Object(Ze.jsx)(Tt,{name:"approved",label:"Approved ",handleChange:function(e){var t=e.target;i(t.checked),u(!1)},checked:c})})}))),el=Object(r.forwardRef)((function(e,t){var n=function(e){return!0===Boolean(e)?{variant:"contained",label:"Approved",color:"primary"}:{variant:"outlined",label:"Not Approved",color:"primary"}},a=Object(r.useState)(n(e.value)),c=Object(Pe.a)(a,2),i=c[0],o=c[1];return Object(r.useImperativeHandle)(t,(function(){return{refresh:function(e){o(n(e.value))}}})),Object(Ze.jsx)(pc.a,Object(u.a)({size:"small"},i))})),tl=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(null===e||void 0===e?void 0:e.value),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(!0),s=Object(Pe.a)(o,2),l=s[0],u=s[1],d=Object(r.useRef)(null),j=Object(Ke.c)(Le),b=j.customers,p=j.loading?[]:zn(b);return Object(r.useEffect)((function(){focus()}),[]),Object(r.useImperativeHandle)(t,(function(){return{getValue:function(){return c},isPopup:function(){return!0}}})),Object(r.useEffect)((function(){l||e.api.stopEditing()}),[l]),Object(Ze.jsx)("div",{style:{paddingLeft:10,paddingRight:10,paddingTop:20,paddingBottom:20,width:300},ref:d,children:Object(Ze.jsx)(At,{options:p,name:"customer",label:"Customer",handleChange:function(e,t){console.log(e,t),i(t.value),u(!1)},value:c,PaperComponent:function(e){var t=e.children;return Object(Ze.jsx)(dn.a,{style:{width:300,marginLeft:-10},children:t})}})})})),nl=n(25),rl=n.n(nl),al=Object(r.forwardRef)((function(e,t){var n=Object(Ke.c)(Le),a=n.customers,c=n.loading,i=function(e){if(c||!e)return"Select Customer";var t=null===a||void 0===a?void 0:a.find((function(t){return t._id===e}));return t?"".concat(t.name," - ").concat(t.email):"Select Customer"},o=Object(r.useState)(i(null===e||void 0===e?void 0:e.value)),s=Object(Pe.a)(o,2),l=s[0],u=s[1];return Object(r.useImperativeHandle)(t,(function(){return{refresh:function(e){u(i(null===e||void 0===e?void 0:e.value))}}})),Object(Ze.jsx)(Ze.Fragment,{children:l})}));al.propTypes={value:rl.a.string};var cl=al,il=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(null===e||void 0===e?void 0:e.value),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(!0),s=Object(Pe.a)(o,2),l=s[0],u=s[1],d=Object(r.useRef)(null),j=Object(Ke.c)(Be),b=j.services,p=j.loading?[]:Gn(b);return Object(r.useEffect)((function(){focus()}),[]),Object(r.useImperativeHandle)(t,(function(){return{getValue:function(){return c},isPopup:function(){return!0}}})),Object(r.useEffect)((function(){l||e.api.stopEditing()}),[l]),Object(Ze.jsx)("div",{style:{paddingLeft:10,paddingRight:10,paddingTop:20,paddingBottom:20,width:300},ref:d,children:Object(Ze.jsx)(At,{options:p,name:"service",label:"Service",handleChange:function(e,t){console.log(e,t),i(t.value),u(!1)},value:c,PaperComponent:function(e){var t=e.children;return Object(Ze.jsx)(dn.a,{style:{width:300,marginLeft:-10},children:t})}})})})),ol=Object(r.forwardRef)((function(e,t){var n=Object(Ke.c)(Be),a=n.services,c=n.loading,i=function(e){if(c||!e)return"Select Service";var t=null===a||void 0===a?void 0:a.find((function(t){return t._id===e}));return t?null===t||void 0===t?void 0:t.title:"Select Service"},o=Object(r.useState)(i(null===e||void 0===e?void 0:e.value)),s=Object(Pe.a)(o,2),l=s[0],u=s[1];return Object(r.useImperativeHandle)(t,(function(){return{refresh:function(e){u(i(null===e||void 0===e?void 0:e.value))}}})),Object(Ze.jsx)(Ze.Fragment,{children:l})}));ol.propTypes={value:rl.a.string};var sl=ol,ll=[{field:"service",headerName:"Service",cellRenderer:"approvalService"},{field:"description",headerName:"Description"},{field:"charged",headerName:"(\xa3) Amount"},{field:"charged",headerName:"(\xa3) VAT",cellRenderer:"invoiceLineVat"},{field:"charged",headerName:"(\xa3) Total",cellRenderer:"invoiceLineTotal"}],ul=[{field:"autoId",headerName:"Purchases ID",sortable:!0,filter:!0,width:120},{field:"approved",headerName:"Approved",editable:!0,cellRenderer:"approvedStatus",isPopup:!0,cellEditor:"approvedCheckbox",width:130},{field:"supplierInvoiceNumber",headerName:"Invoice #",sortable:!0,filter:!0,width:130},{field:"supplier",headerName:"Supplier",cellRenderer:"purchaseSupplier",sortable:!0,filter:!0,width:130},{field:"details",headerName:"Description",sortable:!0,filter:!0},{field:"supplierInvoiceDate",headerName:"Invoice Date",cellRenderer:"purchaseInvoiceDate",sortable:!0,filter:!0,width:130},{field:"amount",headerName:"Sub Total",sortable:!0,filter:!0,width:130},{field:"vat",headerName:"VAT",sortable:!0,filter:!0,width:130},{field:"total",headerName:"Total",sortable:!0,filter:!0,width:130},{field:"invoiceLines.billed",headerName:"# Invoiced",sortable:!0,filter:!0,width:100},{field:"invoiceLines.delivered",headerName:"# Delivered",sortable:!0,filter:!0,width:100},{field:"invoiceLines.count",headerName:"# Ordered",sortable:!0,filter:!0,width:100}],dl=[{headerName:"Invoice Details",columns:[{field:"invoice.autoId",headerName:"Sales ID",sortable:!0,filter:!0,floatingFilter:!0,width:120},{field:"invoiceCustomer.email",headerName:"Customer",sortable:!0,filter:!0,floatingFilter:!0,cellRenderer:function(e){var t,n,r=e.data;return"".concat(null===r||void 0===r||null===(t=r.invoiceCustomer)||void 0===t?void 0:t.name," - ").concat(null===r||void 0===r||null===(n=r.invoiceCustomer)||void 0===n?void 0:n.email)},columnGroupShow:"open",width:150},{field:"invoice.vehicleReg",headerName:"Reg",sortable:!0,filter:!0,floatingFilter:!0,columnGroupShow:"open",width:150},{field:"invoice.vehicleModel",headerName:"Model",sortable:!0,filter:!0,floatingFilter:!0,columnGroupShow:"open",width:150},{field:"invoice.subTotal",headerName:"Amount",sortable:!0,filter:!0,floatingFilter:!0,width:110},{field:"invoice.total",headerName:"Total",sortable:!0,filter:!0,floatingFilter:!0,columnGroupShow:"open",width:110},{field:"invoice.payments",headerName:"Payment Method",sortable:!1,filter:!1,columnGroupShow:"open",cellRenderer:"paymentMethod",width:110}]},{headerName:"Approval Details",columns:[{field:"status",headerName:"Approved",editable:!0,cellRenderer:"approvedStatus",isPopup:!0,cellEditor:"approvedCheckbox",width:130},{field:"notes",headerName:"Notes",editable:!0,isPopup:!0,width:150},{field:"customer",headerName:"New Customer",editable:!0,cellEditor:"customerSelect",cellRenderer:"approvalCustomer"},{field:"repair",headerName:"New Service/Repair",editable:!0,cellEditor:"serviceSelect",cellRenderer:"approvalService"},{field:"amount",headerName:"Amount",editable:!0,width:110},{field:"total",headerName:"Total (+VAT)",width:110,valueFormatter:function(e){var t,n;return null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.total)||void 0===n?void 0:n.toFixed(2)}},{field:"payments.amount",headerName:"New Amount Paid",editable:!0},{field:"payments.method",headerName:"Payment Method",editable:!0,cellEditor:"agSelectCellEditor",cellEditorParams:{cellHeight:50,values:["Cash","Card","Cheque","BACS"]}},{field:"reference",headerName:"Reference"},{field:"letter",headerName:"Letter (A-Z)",editable:!0}]}],jl={approvedCheckbox:$s,approvedStatus:el,customerSelect:tl,approvalCustomer:cl,serviceSelect:il,approvalService:sl,paymentMethod:Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(null===e||void 0===e?void 0:e.value),a=Object(Pe.a)(n,2),c=a[0],i=a[1];return Object(r.useImperativeHandle)(t,(function(){return{refresh:function(e){i(e.value)}}})),Object(Ze.jsxs)(Ze.Fragment,{children:[c.card>0&&Object(Ze.jsx)(pc.a,{icon:Object(Ze.jsx)(et,{name:"CreditCard"}),variant:"outlined",color:"primary",size:"small",label:"CARD"}),c.cash>0&&Object(Ze.jsx)(pc.a,{icon:Object(Ze.jsx)(et,{name:"Money"}),variant:"outlined",color:"primary",size:"small",label:"CASH"}),c.cheque>0&&Object(Ze.jsx)(pc.a,{icon:Object(Ze.jsx)(et,{name:"PriceCheck"}),variant:"outlined",color:"primary",size:"small",label:"CHEQUE"})]})}))},bl=function(e){var t=e.value,n=Object(r.useState)(null),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=Object(Ke.c)(Ve).suppliers;return Object(r.useEffect)((function(){!function(){var e=o.find((function(e){return e._id===t}));i(null===e||void 0===e?void 0:e.name)}()}),[o]),Object(Ze.jsx)(Ze.Fragment,{children:c})};bl.propTypes={value:rl.a.string.isRequired};var pl=bl,vl=function(e){var t=e.value,n=Object(r.useState)(null),a=Object(Pe.a)(n,2),c=a[0],i=a[1];return Object(r.useEffect)((function(){!function(){var e=za()(t).format("DD/MM/YYYY");i(e)}()}),[]),Object(Ze.jsx)(Ze.Fragment,{children:c})};vl.propTypes={value:rl.a.array.isRequired};var fl=vl,Ol=Object(r.forwardRef)((function(e,t){var n=e.data,a=e.value,c=Object(r.useState)(n.addVat?.2*a:0),i=Object(Pe.a)(c,2),o=i[0],s=i[1];return Object(r.useImperativeHandle)(t,(function(){return{refresh:function(e){var t=e.data,n=e.value;s(t.addVat?.2*n:0)}}})),Object(Ze.jsxs)("div",{children:["\xa3 ",o.toFixed(2)]})})),hl=Object(r.forwardRef)((function(e,t){var n=e.data,a=e.value,c=Object(r.useState)(n.addVat?1.2*a:a),i=Object(Pe.a)(c,2),o=i[0],s=i[1];return Object(r.useImperativeHandle)(t,(function(){return{refresh:function(e){var t=e.data,n=e.value;s(t.addVat?1.2*n:n)}}})),Object(Ze.jsxs)("div",{children:["\xa3 ",o.toFixed(2)]})})),ml=function(){var e=Object(r.useState)(null),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(0),i=Object(Pe.a)(c,2),o=i[0],s=i[1],l=Object(r.useState)(0),d=Object(Pe.a)(l,2),j=d[0],b=d[1],p=Object(r.useState)(null),v=Object(Pe.a)(p,2),f=v[0],O=v[1],h=Object(r.useState)(null),m=Object(Pe.a)(h,2),x=m[0],g=m[1],y=Object(r.useState)(null),w=Object(Pe.a)(y,2),S=w[0],C=w[1],T=Object(r.useState)(null),E=Object(Pe.a)(T,2),D=E[0],I=E[1],A=Object(r.useState)(null),k=Object(Pe.a)(A,2),_=k[0],R=k[1],N=Object(Ke.b)(),M=Object(Ke.c)(Le),P=M.customers,U=M.loading,F=Object(Ke.c)(Be),L=F.services,V=F.loading,Y=Object(Ke.c)(Ve),H=Y.suppliers,q=Y.loading,B=V||U||q,z=pt.departments;Object(r.useEffect)((function(){Object(An.a)(Object(In.a)().mark((function e(){var t,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xs({date:n});case 2:t=e.sent,r=t.data,g(r);case 5:case"end":return e.stop()}}),e)})))(),P||U||N(jc()),L||V||N(lo()),H||q||N(Ci())}),[]),Object(r.useEffect)((function(){if(x){var e=x.filter((function(e){return!0===e.status}));if(e){var t=Un(e,"total");s(t)}}if(D){var n=Un(D,"total");b(n)}}),[D,x]);var G=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){var t,r;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xs({date:n,department:f});case 2:t=e.sent,r=t.data,I(null),g(r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r,a,c,i;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.colDef.field,r=z.find((function(e){var n,r;return e.name===(null===t||void 0===t||null===(n=t.data)||void 0===n||null===(r=n.invoice)||void 0===r?void 0:r.department)})),e.next=4,Zs(Object(it.a)({id:t.data._id,chargeVat:!(null!==r&&void 0!==r&&r.invoicesVatExempt)},n,t.value));case 4:a=e.sent,c=a.data,i=x.map((function(e){return e._id===c._id?c:e})),g(i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n,r,a,c;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.colDef.field,e.next=3,bo(Object(it.a)({_id:t.data._id},n,t.value));case 3:r=e.sent,a=r.data,c=D.map((function(e){return e._id===a._id?a:e})),I(c);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K={width:"100%",display:"flex",flexDirection:"column",justifyContent:"center"};if(B)return"Loading";var J=42.3*(x&&x.length<=15?null===x||void 0===x?void 0:x.length:15);return Object(Ze.jsx)(pa,{title:"Sales approvals",children:Object(Ze.jsxs)(dn.a,{children:[Object(Ze.jsx)(dt.a,{p:2,width:"100%",children:Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:3,children:Object(Ze.jsxs)(Wt.a,{container:!0,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:6,children:Object(Ze.jsxs)(dt.a,{width:"100%",style:K,children:[Object(Ze.jsxs)(jt.a,{variant:"h4",children:["\xa3 ",null===o||void 0===o?void 0:o.toFixed(2)]}),Object(Ze.jsx)(jt.a,{variant:"overline",children:"New Sales Total"})]})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:6,children:Object(Ze.jsxs)(dt.a,{width:"100%",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(Ze.jsxs)(jt.a,{variant:"h4",children:["\xa3 ",null===j||void 0===j?void 0:j.toFixed(2)]}),Object(Ze.jsx)(jt.a,{variant:"overline",children:"Purchases Total"})]})})]})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:3,height:75,style:K,children:Object(Ze.jsx)(At,{name:"department",label:"Department",defaultValue:f,options:(null===z||void 0===z?void 0:z.map((function(e){var t=e.name;return{value:t,label:t}})))||[],handleChange:function(e,t){O(null===t||void 0===t?void 0:t.value)}})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:3,height:75,style:K,children:Object(Ze.jsx)(Nt,{label:"Approval Date",name:"approvalDate",value:n,onChange:function(e){a(za()(e).format("YYYY/MM/DD"))}})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:3,height:75,style:K,children:Object(Ze.jsx)(Yt.a,{variant:"contained",onClick:G,children:"Filter"})})]})}),Object(Ze.jsx)(dt.a,{p:2,width:"100%",children:Object(Ze.jsx)("div",{className:"ag-theme-alpine",style:{width:"100%",height:"".concat(J+160,"px")},children:Object(Ze.jsx)(Js.AgGridReact,{rowData:x,rowSelection:"single",onGridReady:function(e){C(e.api)},onSelectionChanged:function(){var e,t,n,r=S.getSelectedRows();I(null===(e=r[0])||void 0===e?void 0:e.purchases),R(null===(t=r[0])||void 0===t||null===(n=t.invoice)||void 0===n?void 0:n.lines)},onCellValueChanged:W,frameworkComponents:jl,getRowStyle:function(e){var t,n,r=e.data,a=(null===P||void 0===P?void 0:P.find((function(e){var t;return e._id===(null===r||void 0===r||null===(t=r.invoice)||void 0===t?void 0:t.customer)}))).highValue,c=(null===r||void 0===r||null===(t=r.invoice)||void 0===t||null===(n=t.payments)||void 0===n?void 0:n.card)>0;return{background:a||c?nt.accent.main:"inherit"}},children:dl.map((function(e,t){var n=e.columns,r=e.headerName;return Object(Ze.jsx)(Js.AgGridColumn,{headerName:r,children:n.map((function(e,t){return Object(Ze.jsx)(Js.AgGridColumn,Object(u.a)({},e),t)}))},t)}))})})}),Object(Ze.jsxs)(dt.a,{p:2,width:"100%",children:[Object(Ze.jsx)(jt.a,{variant:"overline",children:"Selected Invoice Lines"}),_&&Object(Ze.jsx)("div",{className:"ag-theme-alpine",style:{width:"100%",height:"200px"},children:Object(Ze.jsx)(Js.AgGridReact,{onGridReady:function(e){e.api.sizeColumnsToFit()},frameworkComponents:{approvalService:sl,invoiceLineVat:Ol,invoiceLineTotal:hl},rowData:_,children:ll.map((function(e,t){return Object(Ze.jsx)(Js.AgGridColumn,Object(u.a)({},e),t)}))})})]}),Object(Ze.jsxs)(dt.a,{p:2,width:"100%",children:[Object(Ze.jsxs)(jt.a,{variant:"overline",children:[D?"Selected Invoice ":"Select Invoice to see ","Purchases"]}),D&&Object(Ze.jsx)("div",{className:"ag-theme-alpine",style:{width:"100%",height:"200px"},children:Object(Ze.jsx)(Js.AgGridReact,{rowData:D,onGridReady:function(e){e.api.sizeColumnsToFit()},onCellValueChanged:Q,frameworkComponents:{purchaseSupplier:pl,purchaseInvoiceDate:fl,approvedCheckbox:$s,approvedStatus:el},children:ul.map((function(e,t){return Object(Ze.jsx)(Js.AgGridColumn,Object(u.a)({},e),t)}))})})]})]})})},xl=ml,gl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){var n;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return n=Zn(t),e.next=4,_n.a.get("quotes?".concat(n));case 4:case 7:return e.abrupt("return",e.sent);case 5:return e.next=7,_n.a.get("quotes");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),yl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("quotes/".concat(t._id,"/new-line"),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),wl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.patch("quotes/".concat(t._id,"/lines"),t.lines);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Sl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.get("quotes/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Cl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("quotes",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Tl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("quotes/".concat(t._id),t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),El=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.delete("quotes/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Dl=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.put("quotes/".concat(t,"/invoice"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Il=function(){var e=Object(An.a)(Object(In.a)().mark((function e(t){return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n.a.post("quotes/search",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Al=function(){return function(e){e({type:we,payload:!0})}},kl=function(e){return function(t){t({type:ye,payload:e})}},_l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Al()),t.prev=1,t.next=4,gl(e);case 4:r=t.sent,a=r.data,n({type:xe,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting quotes"),n(kl(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},Rl=function(e){var t=e.quote,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Quote"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.name||"Quote"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"Tax Quote",info:"inv # ".concat(t.autoId)},{title:"Quoted To",info:t.customer.name},{title:"Created",info:za()(t.created).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Quote will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Al()),t.prev=1,t.next=4,El(e);case 4:a=r().QUOTES.quotes,c=a.filter((function(t){return t._id!==e})),n({type:xe,payload:c}),er.b.success("Quote deleted successfully"),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),er.b.error("Error deleting quote"),n(kl(t.t0));case 14:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},Nl=Rl,Ml=function(e){var t=e.quote,n=(Object(Sn.g)(),Object(Ke.b)()),a=Object(Ke.c)(Le),c=a.customers,i=a.loading;return Object(r.useEffect)((function(){c||n(jc())}),[]),i?"LOADING":Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Update Quote",initialValues:Object(u.a)(Object(u.a)({},t),{},{customer:t.customer._id}),validationSchema:vr,submitButtonText:"Update Quote",formFields:Vl(c),handleSubmit:function(e){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Al()),t.prev=1,t.next=4,Tl(e);case 4:a=t.sent,c=a.data,i=r().QUOTES.quotes,o=i.map((function(e){return e._id===c._id?c:e})),n({type:xe,payload:o}),n({type:ge,payload:c}),er.b.success("Quote updated successfully"),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(1),er.b.error("Error getting quote"),n(kl(t.t0));case 17:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},Pl=function(e){var t,n,r=e.quote,a=Object(Sn.j)().url;return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"space-between",children:[!(null!==r&&void 0!==r&&null!==(t=r.invoice)&&void 0!==t&&t._id)&&Object(Ze.jsx)(Gt,{openButtonIcon:"Edit",open:!1,children:Object(Ze.jsx)(Ml,{quote:r})}),Object(Ze.jsx)(qt.a,{size:"small",onClick:function(){return Jn("/#".concat(a,"/").concat(r._id,"/view"))},children:Object(Ze.jsx)(et,{size:"small",color:"primary",name:"FolderOpen"})}),!(null!==r&&void 0!==r&&null!==(n=r.invoice)&&void 0!==n&&n._id)&&Object(Ze.jsx)(Gt,{openButtonIcon:"Delete",open:!1,children:Object(Ze.jsx)(Nl,{quote:r})})]})},Ul=function(e){var t=e.quote,n=e.quoteLines,a=e.services,c=e.initialValues,i=Object(r.useState)(null),o=Object(Pe.a)(i,2),s=o[0],l=o[1],u=Object(r.useState)(!0),d=Object(Pe.a)(u,2),j=d[0],b=d[1],p=Object(r.useState)(!0),v=Object(Pe.a)(p,2),f=v[0],O=v[1],h=Object(Ke.b)(),m=lt();Object(r.useEffect)((function(){l(Hl(t))}),[]),Object(r.useEffect)((function(){O(x()),b(!1)}),[s]);var x=function(){var e;return!(null===t||void 0===t||null===(e=t.customer)||void 0===e||!e.highValue)||(null===s||void 0===s?void 0:s.invoicesVatExempt)};if(j)return"";return console.log(c),Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsxs)(Wt.a,{container:!0,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:"New Quote Line"})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,className:Object(_r.a)(m.pt3,m.pb2),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Kt.b,{initialValues:c,validationSchema:fr,onSubmit:function(e){var r=null===n||void 0===n?void 0:n.map((function(t){var n;return(null===t||void 0===t?void 0:t._id)===(null===e||void 0===e?void 0:e._id)?(delete e._id,e.charged=parseInt(e.charged),e):(t.service=null===t||void 0===t||null===(n=t.service)||void 0===n?void 0:n._id,delete t._id,t)}));h(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Al()),t.prev=1,t.next=4,wl(e);case 4:a=t.sent,c=a.data,i=r().QUOTES.quotes,o=i&&i.map((function(e){return e._id===c._id?c:e})),n({type:xe,payload:o}),n({type:ge,payload:c}),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(1),console.log(t.t0),er.b.error("Error getting quote"),n(kl(t.t0));case 17:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,n){return t.apply(this,arguments)}}()}({_id:null===t||void 0===t?void 0:t._id,lines:r}))},children:function(e){var t=e.errors,n=e.values,r=e.handleChange,c=e.setFieldValue,i=e.handleSubmit;return Object(Ze.jsxs)(Kt.a,{children:[Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(At,{label:"Service",name:"service",defaultValue:n.service,handleChange:function(e,t){return c("service",(null===t||void 0===t?void 0:t.value)||"")},fullWidth:!0,options:Gn(a)})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:m.mt2,label:"Description",value:n.description,errors:t.description,onChange:r,name:"description",fullWidth:!0,multiline:!0,rows:4})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:m.mt2,label:"Amount Charged",value:n.charged,errors:t.charged,onChange:r,name:"charged",fullWidth:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Tt,{label:"Add Vat (20%)",handleChange:function(e,t){c("addVat",t)},name:"addVat",checked:n.addVat,errors:t.addVat,disabled:f})})]}),Object(Ze.jsx)(Yt.a,{className:m.mt2,onClick:i,variant:"contained",color:"primary",type:"submit",fullWidth:!0,children:"Create Quote Line"})]})}})})]})})};za.a.extend(Fc.a);var Fl=[{name:"Quote No",selector:function(e){return"#"+(null===e||void 0===e?void 0:e.autoId)},sortable:!0},{name:"Quote Date",selector:function(e){return"".concat(za()(e.quoteDate).format("DD MMM YYYY"))},sortable:!0},{name:"Customer",selector:function(e){return e.customer.name},sortable:!0},{name:"Vehicle Model - Reg ",selector:function(e){var t;return e.vehicleModel+" - "+(null===(t=e.vehicleReg)||void 0===t?void 0:t.toUpperCase())},sortable:!0},{name:"Actions",selector:function(e){return Pl({quote:e})}}],Ll=[{name:"Item",selector:function(e){return null===e||void 0===e?void 0:e.service.title},sortable:!1},{name:"Description",selector:function(e){return null===e||void 0===e?void 0:e.service.description},sortable:!1},{name:"VAT",selector:function(e){return"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(.2*e.charged).toFixed(2):"0.00")}},{name:"Amount",selector:function(e){return"\xa3 ".concat(e.charged.toFixed(2))},sortable:!1},{name:"Total",selector:function(e){return"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(1.2*e.charged).toFixed(2):e.charged)}},{name:"",cell:function(e){var t,n=e.quote,r=e.services,a=e.quoteLines,c=e._id,i=e.service,o=e.addVat,s=e.charged,l=e.description;return Object(Ze.jsx)(Ze.Fragment,{children:!(null!==n&&void 0!==n&&null!==(t=n.invoice)&&void 0!==t&&t._id)&&Object(Ze.jsx)(Gt,{openButtonIcon:"Edit",open:!1,children:Object(Ze.jsx)(Ul,{quote:n,services:r,quoteLines:a,initialValues:{_id:c,service:null===i||void 0===i?void 0:i._id,addVat:o,charged:s,description:l}})})})}}],Vl=function(e){return[{component:"MuiSelectField",name:"department",label:"Quote Department",options:pt.departments.map((function(e){var t=e.name;return{label:t,value:t}})),disabled:!vt},{component:"MuiTextField",name:"vehicleModel",label:"Vehicle Model"},{component:"MuiTextField",name:"vehicleReg",label:"Vehicle Registration"},{component:"MuiSelectField",name:"customer",label:"Customer",options:zn(e)},{component:"MuiDatepicker",name:"quoteDate",label:"Quote Date"},{component:"MuiTextField",name:"quoteNotes",label:"Quote/Repair/Service Notes",multiline:!0,rows:5}]},Yl=[{when:function(e){return e.customer.highValue},style:function(e){return{backgroundColor:e.customer.highValue?nt.accent.main:"inherit"}}}],Hl=function(e){return pt.departments.find((function(t){return(null===t||void 0===t?void 0:t.name)===(null===e||void 0===e?void 0:e.department)}))},ql=function(){var e=Object(Sn.g)(),t=Object(Ke.b)(),n=Object(Ke.c)(Le),a=n.customers,c=n.loading;return Object(r.useEffect)((function(){a||t(jc())}),[]),c?"LOADING":Object(Ze.jsx)(dt.a,{p:1,children:Object(Ze.jsx)(Zt,{title:"Create Quote",initialValues:{customer:"",vehicleModel:"",vehicleRed:"",quoteNotes:"",department:pt.departments[0].name},validationSchema:vr,submitButtonText:"Create Quote",formFields:Vl(a),handleSubmit:function(n){t(function(e,t){return function(){var n=Object(An.a)(Object(In.a)().mark((function n(r,a){var c,i,o,s,l;return Object(In.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(Al()),n.prev=1,n.next=4,Cl(e);case 4:c=n.sent,i=c.data,o=a().QUOTES,s=o.quotes,l=o.layout,s.push(i),r({type:xe,payload:s}),r({type:Ce,payload:Object(u.a)(Object(u.a)({},l),{},{openCreateDrawer:!1})}),t.push("/quotes/".concat(i._id,"/view")),er.b.success("Quote created successfully"),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(1),er.b.error("Error creating quote"),r(kl(n.t0));case 18:case"end":return n.stop()}}),n,null,[[1,14]])})));return function(e,t){return n.apply(this,arguments)}}()}(n,e))}})})},Bl=ql,zl=function(e){var t=e.data;return console.log(t),Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(cn,{data:[{title:"Amount Paid",info:"\xa3 ".concat(t.payments.card+t.payments.cash+t.payments.cheque)},{title:"Balance",info:"\xa3 ".concat(t.balancePayable)},{title:"Quote Total",info:"\xa3 ".concat(t.total)}]})})},Gl=function(){var e=Object(r.useState)("QUOTES"),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=lt(),i=Object(r.useState)(!1),o=Object(Pe.a)(i,2),s=o[0],l=o[1],u=Object(Ke.b)(),j=Object(Ke.c)(We),b=j.quotes,p=j.loading,v=j.layout;Object(r.useEffect)((function(){u(_l())}),[]),Object(r.useEffect)((function(){l(v.openCreateDrawer)}),[v.openCreateDrawer]);var f=function(){u(_l()),a("QUOTES")};return Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{p:3,children:[Object(Ze.jsx)(dt.a,{className:c.pb2,children:Object(Ze.jsx)(Wt.a,{container:!0,spacing:1,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,sm:12,children:Object(Ze.jsx)(dt.a,{width:"100%",children:Object(Ze.jsx)(vn,{placeholder:"Search Quote # | Vehicle Model - Reg",handleClear:f,handleSearch:function(e){Object(d.isEmpty)(e)?f():(u(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Al()),t.prev=1,t.next=4,Il(e);case 4:r=t.sent,a=r.data,n({type:xe,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error deleting quote"),n(kl(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}({search:e})),a("SEARCH RESULTS"))}})})})})}),Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsx)(Gt,{openButtonText:"Create Quote",open:s,handleOpen:function(){return Bn(u,v,"UPDATE_QUOTES_LAYOUT",!0)},handleClose:function(){return Bn(u,v,"UPDATE_QUOTES_LAYOUT",!1)},children:Object(Ze.jsx)(Bl,{})},"create")],title:n,progressPending:p,fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,expandableRows:!0,pagination:!0,expandableRowsComponent:zl,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"left",subHeaderWrap:!0,columns:Fl,conditionalRowStyles:Yl,data:b||[]})]})})},Wl=Gl,Ql=function(e){var t,n,a,c=e.quote,i=Object(r.useState)(null),o=Object(Pe.a)(i,2),s=o[0],l=o[1];return Object(r.useEffect)((function(){l(Hl(c))}),[]),Object(Ze.jsxs)(Wt.a,{container:!0,spacing:2,children:[Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,sm:6,flexDirection:"column",display:"flex",children:[Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"TO "}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===c||void 0===c||null===(t=c.customer)||void 0===t?void 0:t.name}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===c||void 0===c||null===(n=c.customer)||void 0===n?void 0:n.town}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===c||void 0===c||null===(a=c.customer)||void 0===a?void 0:a.postalCode})]}),Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,sm:6,flexDirection:"column",display:"flex",children:[Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"FROM"}),Object(Ze.jsx)(jt.a,{variant:"body1",children:null===s||void 0===s?void 0:s.displayName}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.line1}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.line2}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.city}),Object(Ze.jsx)(jt.a,{variant:"body1",children:pt.address.postalCode})]})]})},Kl=function(e){var t=e.title,n=e.amount,r=lt();return Object(Ze.jsxs)(dt.a,{display:"flex",justifyContent:"space-between",alignItems:"center",height:30,children:[Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t}),Object(Ze.jsxs)(jt.a,{variant:"body1",className:r.fw8,children:["\xa3 ",n]})]})},Jl=function(e){var t,n,r,a=e.quote,c=lt();return Object(Ze.jsxs)(dt.a,{className:Object(_r.a)(c.pt2),width:250,children:[Object(Ze.jsx)(Kl,{title:"Sub Total",amount:(null===a||void 0===a||null===(t=a.subTotal)||void 0===t?void 0:t.toFixed(2))||0}),Object(Ze.jsx)(Kl,{title:"VAT",amount:(null===a||void 0===a||null===(n=a.vatAmount)||void 0===n?void 0:n.toFixed(2))||0}),Object(Ze.jsx)(Kl,{title:"Total",amount:(null===a||void 0===a||null===(r=a.total)||void 0===r?void 0:r.toFixed(2))||0})]})},Xl=function(e){var t=e.quote,n=e.services,a=Object(r.useState)(null),c=Object(Pe.a)(a,2),i=c[0],o=c[1],s=Object(r.useState)(!0),l=Object(Pe.a)(s,2),u=l[0],d=l[1],j=Object(r.useState)(!0),b=Object(Pe.a)(j,2),p=b[0],v=b[1],f=Object(r.useState)(!0),O=Object(Pe.a)(f,2),h=O[0],m=O[1],x=Object(Ke.b)(),g=lt();Object(r.useEffect)((function(){o(Hl(t))}),[]),Object(r.useEffect)((function(){v(y()),m(w()),d(!1)}),[i]);var y=function(){var e;return(null===i||void 0===i||!i.invoicesVatExempt)&&(null===t||void 0===t||null===(e=t.customer)||void 0===e?void 0:e.highValue)},w=function(){var e;return!(null===t||void 0===t||null===(e=t.customer)||void 0===e||!e.highValue)||(null===i||void 0===i?void 0:i.invoicesVatExempt)};return u?"":Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsxs)(Wt.a,{container:!0,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(jt.a,{variant:"h5",children:"New Quote Line"})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,className:Object(_r.a)(g.pt3,g.pb2),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Kt.b,{initialValues:{_id:t._id,service:"",charged:"",description:"",addVat:p},validationSchema:fr,onSubmit:function(e){return x((t=e,function(){var e=Object(An.a)(Object(In.a)().mark((function e(n,r){var a,c,i,o;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(Al()),e.prev=1,e.next=4,yl(t);case 4:a=e.sent,c=a.data,i=r().QUOTES.quotes,o=i&&i.map((function(e){return e._id===c._id?c:e})),n({type:xe,payload:o}),n({type:ge,payload:c}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),er.b.error("Error getting quote"),n(kl(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n){return e.apply(this,arguments)}}()));var t},children:function(e){var t=e.errors,r=e.values,a=e.handleChange,c=e.setFieldValue,i=e.handleSubmit;return Object(Ze.jsxs)(Kt.a,{children:[Object(Ze.jsxs)(Wt.a,{container:!0,spacing:1,children:[Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(At,{label:"Service",name:"service",defaultValue:r.service,handleChange:function(e,t){return c("service",(null===t||void 0===t?void 0:t.value)||"")},fullWidth:!0,options:Gn(n)})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:g.mt2,label:"Description",value:r.description,errors:t.description,onChange:a,name:"description",fullWidth:!0,multiline:!0,rows:4})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(gt,{className:g.mt2,label:"Amount Charged",value:r.charged,errors:t.charged,onChange:a,name:"charged",fullWidth:!0})}),Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsx)(Tt,{label:"Add Vat (20%)",handleChange:function(e,t){c("addVat",t)},name:"addVat",checked:r.addVat,errors:t.addVat,disabled:h})})]}),Object(Ze.jsx)(Yt.a,{className:g.mt2,onClick:i,variant:"contained",color:"primary",type:"submit",fullWidth:!0,children:"Create Quote Line"})]})}})})]})})},Zl=function(e){var t,n=e.quote,r=e.services,a=n.lines,c=null===a||void 0===a?void 0:a.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{_id:Object(ha.a)()})})),i=null===c||void 0===c?void 0:c.map((function(e){return Object(u.a)(Object(u.a)({},e),{},{quoteLines:c,quote:n,services:r})})),o=lt();return Object(Ze.jsxs)(dt.a,{className:o.pt3,style:{minHeight:300},children:[Object(Ze.jsx)(dt.a,{className:Object(_r.a)(o.pt2,o.pl2),children:Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:"Quote Lines"})}),Object(Ze.jsx)(Pa.a,{noHeader:!0,data:i,columns:Ll}),Object(Ze.jsx)(dt.a,{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center",children:!(null!==n&&void 0!==n&&null!==(t=n.invoice)&&void 0!==t&&t._id)&&Object(Ze.jsx)(Gt,{openButtonText:"ADD QUOTE LINE",children:Object(Ze.jsx)(Xl,{quote:n,services:r})})})]})},$l=ei.f.create({body:{paddingTop:35,paddingBottom:65,paddingHorizontal:35},title:{fontSize:24,textAlign:"center",fontFamily:"Oswald"},author:{fontSize:12,textAlign:"center",marginBottom:40},subtitle:{fontSize:18,margin:12,fontFamily:"Oswald"},text:{margin:12,fontSize:10,textAlign:"justify",fontFamily:"Times-Roman"},image:{margin:12},header:{fontSize:10,marginHorizontal:12,textAlign:"justify",color:"grey"},pageNumber:{position:"absolute",fontSize:10,bottom:20,left:0,right:0,textAlign:"center",color:"grey"},row:{flexDirection:"row",alignItems:"center"},tableColumnOne:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"10%"},tableColumnTwo:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"20%"},tableColumnFive:{fontSize:10,marginHorizontal:12,textAlign:"justify",fontFamily:"Times-Roman",width:"50%"},w1:{width:"10%"},w2:{width:"20%"},w3:{width:"30%"},w4:{width:"40%"},w5:{width:"50%"},divider:{borderBottom:"1px solid #ccc",marginVertical:10},marginVertical:{marginVertical:10},marginHorizontal:{marginHorizontal:10},downloadLink:{textDecoration:"none"}});ei.b.register({family:"Oswald",src:"https://fonts.gstatic.com/s/oswald/v13/Y_TKV6o8WovbUd3m_X9aAA.ttf"});var eu=function(e){var t,n,a,c,i,o,s,l=e.quote,u=Object(r.useState)(null),d=Object(Pe.a)(u,2),j=d[0],b=d[1],p=Object(r.useState)({}),v=Object(Pe.a)(p,2),f=v[0],O=v[1];Object(r.useEffect)((function(){var e=Hl(l);O(e),Xn((null===e||void 0===e?void 0:e.logo)||(null===pt||void 0===pt?void 0:pt.appLogo),(function(e){return b(e)}))}),[]);return Object(Ze.jsx)(ei.a,{children:Object(Ze.jsxs)(ei.e,{style:$l.body,wrap:!0,size:"A4",children:[Object(Ze.jsx)(dt.a,{style:$l.w3,children:j&&Object(Ze.jsx)(ei.c,{src:j,style:$l.image})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsxs)(ei.g,{style:$l.text,children:[null===f||void 0===f?void 0:f.displayName," ","\n",pt.address.line1," ","\n",pt.address.line2," ","\n",pt.address.city," ","\n",pt.address.postalCode," ","\n"]})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsxs)(ei.g,{style:$l.text,children:["Quoted To: ","\n",null===l||void 0===l||null===(t=l.customer)||void 0===t?void 0:t.name," ","\n",null===l||void 0===l||null===(n=l.customer)||void 0===n?void 0:n.town," ","\n",null===l||void 0===l||null===(a=l.customer)||void 0===a?void 0:a.postalCode]})}),Object(Ze.jsxs)(ei.h,{style:$l.row,children:[Object(Ze.jsx)(dt.a,{style:$l.w2,children:Object(Ze.jsxs)(ei.g,{style:$l.header,children:[" Quote #",l.autoId]})}),Object(Ze.jsx)(dt.a,{style:$l.w3,children:Object(Ze.jsx)(ei.g,{style:$l.text,children:za()(null===l||void 0===l?void 0:l.quoteDate).format("DD/MM/YYYY")})})]}),Object(Ze.jsx)(ei.g,{style:$l.text,children:"Quote Lines"}),Object(Ze.jsxs)(ei.h,{style:$l.row,children:[Object(Ze.jsx)(ei.g,{style:$l.tableColumnTwo,children:"Item"}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnFive,children:"Description"}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnOne,children:"Amount"}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnOne,children:"VAT"}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnOne,children:"Total"})]}),Object(Ze.jsx)(dt.a,{style:$l.divider}),null===l||void 0===l||null===(c=l.lines)||void 0===c?void 0:c.map((function(e,t){var n,r;return Object(Ze.jsxs)(ei.h,{style:$l.row,children:[Object(Ze.jsx)(ei.g,{style:$l.tableColumnTwo,children:e.service.title}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnFive,children:(null===e||void 0===e?void 0:e.description)||(null===e||void 0===e||null===(n=e.service)||void 0===n?void 0:n.description)}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnOne,children:"\xa3 ".concat((null===e||void 0===e||null===(r=e.charged)||void 0===r?void 0:r.toFixed(2))||0)}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnOne,children:"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(.2*e.charged).toFixed(2):"0.00")}),Object(Ze.jsx)(ei.g,{style:$l.tableColumnOne,children:"\xa3 ".concat(null!==e&&void 0!==e&&e.addVat?(1.2*e.charged).toFixed(2):null===e||void 0===e?void 0:e.charged.toFixed(2))})]},t)})),Object(Ze.jsxs)(ei.h,{style:$l.row,children:[Object(Ze.jsx)(ei.h,{style:$l.w2,children:Object(Ze.jsxs)(ei.g,{style:$l.text,children:["Sub Total ","\n","VAT ","\n","Total ","\n"]})}),Object(Ze.jsx)(ei.h,{style:$l.w2,children:Object(Ze.jsxs)(ei.g,{style:$l.text,children:[(null===l||void 0===l||null===(i=l.subTotal)||void 0===i?void 0:i.toFixed(2))||0," ","\n",(null===l||void 0===l||null===(o=l.vatAmount)||void 0===o?void 0:o.toFixed(2))||0," ","\n",(null===l||void 0===l||null===(s=l.total)||void 0===s?void 0:s.toFixed(2))||0," ","\n"]})})]}),(null===f||void 0===f?void 0:f.invoice)&&Object(Ze.jsx)(ei.g,{style:$l.pageNumber,render:function(){var e,t,n,r,a,c,i,o,s,l,u,d,j,b,p,v,O,h,m,x,g,y="";(y+="".concat(null===f||void 0===f||null===(e=f.invoice)||void 0===e||null===(t=e.address)||void 0===t?void 0:t.line1," ").concat(null===f||void 0===f||null===(n=f.invoice)||void 0===n||null===(r=n.address)||void 0===r?void 0:r.line2," ").concat(null===f||void 0===f||null===(a=f.invoice)||void 0===a||null===(c=a.address)||void 0===c?void 0:c.city," ").concat(null===f||void 0===f||null===(i=f.invoice)||void 0===i||null===(o=i.address)||void 0===o?void 0:o.postalCode," \n"),null!==f&&void 0!==f&&null!==(s=f.invoice)&&void 0!==s&&s.email)&&(y+="email:  ".concat(null===f||void 0===f||null===(j=f.invoice)||void 0===j?void 0:j.email,", "));null!==f&&void 0!==f&&null!==(l=f.invoice)&&void 0!==l&&l.phone&&(y+="phone:  ".concat(null===f||void 0===f||null===(b=f.invoice)||void 0===b?void 0:b.phone," \n"));null!==f&&void 0!==f&&null!==(u=f.invoice)&&void 0!==u&&u.bank&&(y+="".concat(null===f||void 0===f||null===(p=f.invoice)||void 0===p||null===(v=p.bank)||void 0===v?void 0:v.name," AC: ").concat(null===f||void 0===f||null===(O=f.invoice)||void 0===O||null===(h=O.bank)||void 0===h?void 0:h.account," ~ SC: ").concat(null===f||void 0===f||null===(m=f.invoice)||void 0===m||null===(x=m.bank)||void 0===x?void 0:x.sortCode,"\n"));null!==f&&void 0!==f&&null!==(d=f.invoice)&&void 0!==d&&d.vatNo&&(y+="VAT NO: ".concat(null===f||void 0===f||null===(g=f.invoice)||void 0===g?void 0:g.vatNo));return y},fixed:!0})]})})},tu=function(e){var t=e.quote;return Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(ei.d,{style:$l.downloadLink,document:Object(Ze.jsx)(eu,{quote:t}),fileName:"Quote-".concat(t.autoId,".pdf"),children:function(e){return e.loading?"...":Object(Ze.jsx)(Yt.a,{variant:"contained",children:"DOWNLOAD QUOTE"})}})})},nu=function(e){var t=e.quote;return Object(Ze.jsx)(tu,{quote:t})},ru=function(e){var t,n,r=e.quote,a=Object(Sn.g)(),c=function(){var e=Object(An.a)(Object(In.a)().mark((function e(){var t,n,c,i;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===r||void 0===r||null===(t=r.invoice)||void 0===t||!t._id){e.next=2;break}return e.abrupt("return",a.push("/invoices/".concat(null===r||void 0===r||null===(n=r.invoice)||void 0===n?void 0:n._id,"/view")));case 2:return e.next=4,Dl(r._id);case 4:c=e.sent,(i=c.data)&&a.push("/invoices/".concat(i._id,"/view"));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=lt();return Object(Ze.jsxs)(dt.a,{width:"100",display:"flex",justifyContent:"space-between",className:i.pb2,children:[Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",justifyContent:"flex-start",children:[Object(Ze.jsx)(dt.a,{className:i.pr1,children:Object(Ze.jsxs)(Yt.a,{variant:"contained",color:"primary",onClick:c,children:[null!==r&&void 0!==r&&null!==(t=r.invoice)&&void 0!==t&&t._id?"View":"Generate"," Invoice"]})}),!(null!==r&&void 0!==r&&null!==(n=r.invoice)&&void 0!==n&&n._id)&&Object(Ze.jsx)(Gt,{openButtonText:"Edit Quote Details",open:!1,children:Object(Ze.jsx)(Ml,{quote:r})}),Object(Ze.jsx)(dt.a,{className:i.pl1,children:Object(Ze.jsx)(nu,{quote:r})})]}),Object(Ze.jsx)(Cn,{})]})},au=function(){var e=Object(r.useState)(null),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=lt(),i=Object(Ke.b)(),o=Object(Sn.i)().id,s=Object(Ke.c)(We),l=Object(Ke.c)(Be),u=s.quote,d=l.services,j=s.loading||l.loading;return Object(r.useEffect)((function(){return i(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n){var r,a;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Al()),t.prev=1,t.next=4,Sl(e);case 4:r=t.sent,a=r.data,n({type:ge,payload:a}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting quote"),n(kl(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}(o)),i(lo()),function(){i({type:"GET_QUOTE",payload:null})}}),[]),Object(r.useEffect)((function(){!function(){var e;if(null!==u&&void 0!==u&&u.department){var t=null===pt||void 0===pt||null===(e=pt.departments)||void 0===e?void 0:e.find((function(e){var t=e.name;return u.department===t}));t&&a(t.logo)}else a(pt.appLogo)}()}),[u]),!j&&u&&d?Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(ru,{quote:u}),Object(Ze.jsx)(dn.a,{children:Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsxs)(dt.a,{p:4,children:[Object(Ze.jsx)(dt.a,{width:340,children:n?Object(Ze.jsx)("img",{src:n,alt:"app logo",width:"100%",className:c.rounded}):Object(Ze.jsx)(ft,{})}),Object(Ze.jsx)(jt.a,{variant:"h4",children:"Tax Quote"}),Object(Ze.jsxs)(jt.a,{variant:"h5",children:["QUO # ",null===u||void 0===u?void 0:u.autoId]})]}),Object(Ze.jsx)(Qt.a,{}),Object(Ze.jsxs)(dt.a,{p:4,minHeight:720,children:[u&&Object(Ze.jsx)(Ql,{quote:u}),u&&Object(Ze.jsx)(Zl,{quote:u,services:d}),u&&Object(Ze.jsx)(Jl,{quote:u})]})]})})]}):"Loading"},cu=au,iu=function(){var e=Object(Sn.j)().url;return Object(Ze.jsx)(pa,{title:"Quotes",children:Object(Ze.jsxs)(Sn.d,{children:[Object(Ze.jsx)(Sn.b,{exact:!0,path:e,component:Wl}),Object(Ze.jsx)(Sn.b,{exact:!0,path:"".concat(e,"/:id/view"),component:cu})]})})},ou=function(e){var t=e.transaction,n=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Update Transaction",initialValues:t,validationSchema:wr,submitButtonText:"Update Transaction",formFields:bu,handleSubmit:function(e){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c,i,o;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Bi()),t.prev=1,t.next=4,Hi(e);case 4:a=t.sent,c=a.data,i=r().TRANSACTIONS.transactions,o=i.map((function(e){return e._id===c._id?c:e})),n({type:Ee,payload:o}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),er.b.error("Error getting transaction"),n(zi(t.t0));case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,n){return t.apply(this,arguments)}}()}(e))}})})},su=function(e){var t=e.transaction,n=Object(Ke.b)(),r=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsxs)(Wt.a,{item:!0,xs:12,children:[Object(Ze.jsx)(jt.a,{variant:"h5",color:"error",children:"Delete Transaction"}),Object(Ze.jsx)(jt.a,{variant:"subtitle1",children:t.autoId||"Transaction"})]})}),Object(Ze.jsx)(dt.a,{className:Object(_r.a)(r.pt3,r.pb3),children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(dt.a,{children:Object(Ze.jsx)(cn,{data:[{title:"#",info:t.autoId},{title:"Reference",info:t.customerRef},{title:"Amount (\xa3)",info:"\xa3 ".concat(parseInt(t.amount).toFixed(2)||"00.00")},{title:"Notes",info:t.notes},{title:"Transaction Date",info:za()(t.date).format("DD MMM YYYY")}]})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Wa.a,{severity:"warning",color:"error",children:"Deleting Transaction will remove this and associated records completely, this process is not reversible."})}),Object(Ze.jsx)(dt.a,{className:r.pt3,children:Object(Ze.jsx)(Yt.a,{variant:"contained",color:"error",onClick:function(){n(function(e){return function(){var t=Object(An.a)(Object(In.a)().mark((function t(n,r){var a,c;return Object(In.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(Bi()),t.prev=1,t.next=4,qi(e);case 4:a=r().TRANSACTIONS.transactions,c=a.filter((function(t){return t._id!==e})),n({type:Ee,payload:c}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),er.b.error("Error getting transaction"),n(zi(t.t0));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n){return t.apply(this,arguments)}}()}(t._id))},children:"Confirm Delete"})})]})},lu=su,uu=function(e){var t=e.transaction,n=lt();return Object(Ze.jsxs)(dt.a,{children:[Object(Ze.jsx)(Wt.a,{container:!0,children:Object(Ze.jsx)(Wt.a,{item:!0,xs:12,children:Object(Ze.jsxs)(jt.a,{variant:"h5",children:["Transaction #",null===t||void 0===t?void 0:t.autoId]})})}),Object(Ze.jsx)(dt.a,{className:n.pt3,children:Object(Ze.jsx)(Qt.a,{})}),Object(Ze.jsx)(cn,{data:[{title:"#",info:t.autoId},{title:"Reference",info:t.customerRef},{title:"Amount (\xa3)",info:"\xa3 ".concat(parseInt(t.amount).toFixed(2)||"00.00")},{title:"Notes",info:t.notes},{title:"Transaction Date",info:za()(t.date).format("DD MMM YYYY")}]})]})},du=function(e){return Object(Ze.jsxs)(dt.a,{display:"flex",flexDirection:"row",children:[Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Edit",children:Object(Ze.jsx)(ou,{transaction:e})},"update"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"FolderOpen",children:Object(Ze.jsx)(uu,{transaction:e})},"view"),Object(Ze.jsx)(Gt,{open:!1,openButtonIcon:"Delete",children:Object(Ze.jsx)(lu,{transaction:e})},"delete")]})},ju=[{name:"#",selector:function(e){return e.autoId},sortable:!0},{name:"Reference",selector:function(e){return e.customerRef},sortable:!0},{name:"Department",selector:function(e){return e.department},sortable:!0},{name:"Amount (\xa3)",selector:function(e){return e.amount},cell:function(e){return"\xa3 ".concat(parseInt(e.amount).toFixed(2)||"0.00")},sortable:!0},{name:"Transaction Date",selector:function(e){return za()(e.date).format("DD MMM YYYY")},sortable:!0},{name:"Actions",selector:function(e){return du(e)}}],bu=[{component:"MuiSelectField",name:"department",label:"Invoice Department",options:Wn(pt.departments,"name","name")},{component:"MuiTextField",name:"customerRef",label:"Reference"},{component:"MuiTextField",name:"amount",label:"Transaction Amount"},{component:"MuiDatepicker",name:"date",label:"Transaction Date"},{component:"MuiTextField",name:"notes",label:"Additional Notes",multiline:!0,rows:5}],pu=function(){var e=Object(Ke.b)();return Object(Ze.jsx)(dt.a,{p:2,children:Object(Ze.jsx)(Zt,{title:"Create Transaction",initialValues:{customerRef:"",amount:"",date:za()().format("MM/DD/YYYY"),notes:""},validationSchema:wr,submitButtonText:"Create Transaction",formFields:bu,handleSubmit:function(t){var n;e((n=t,function(){var e=Object(An.a)(Object(In.a)().mark((function e(t,r){var a,c,i,o,s;return Object(In.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Bi()),e.prev=1,e.next=4,Yi(n);case 4:a=e.sent,c=a.data,i=r().TRANSACTIONS,o=i.transactions,s=i.layout,o.push(c),t({type:Ee,payload:o}),t({type:ke,payload:Object(u.a)(Object(u.a)({},s),{},{openCreateDrawer:!1})}),er.b.success("Transaction created successfully"),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),er.b.error("Error creating transaction"),t(zi(e.t0));case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t,n){return e.apply(this,arguments)}}()))}})})},vu=pu,fu=function(){var e=Object(r.useState)(!1),t=Object(Pe.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)("all"),i=Object(Pe.a)(c,2),o=i[0],s=i[1],l=Object(Ke.b)(),d=Object(Ke.c)(Qe),j=d.transactions,b=d.loading,p=d.layout;Object(r.useEffect)((function(){l(Gi())}),[]),Object(r.useEffect)((function(){a(null===p||void 0===p?void 0:p.openCreateDrawer)}),[null===p||void 0===p?void 0:p.openCreateDrawer]);return b?"":Object(Ze.jsx)(dn.a,{children:Object(Ze.jsx)(dt.a,{p:3,children:Object(Ze.jsx)(Pa.a,{actions:[Object(Ze.jsxs)(Fi.a,{onChange:function(e,t){return s(t),l("all"===t?Gi():Gi({department:t}))},fullWidth:!0,exclusive:!0,size:"small",value:o,children:[Object(Ze.jsx)(Li.a,{value:"all",children:"ALL"}),pt.departments.map((function(e){var t=e.name;return Object(Ze.jsx)(Li.a,{value:t,children:t},t)}))]},"Search"),Object(Ze.jsx)(Gt,{open:n,openButtonText:"Create ",handleOpen:function(){return l({type:"UPDATE_PURCHASE_CATEGORY_LAYOUT",payload:Object(u.a)(Object(u.a)({},p),{},{openCreateDrawer:!0})})},handleClose:function(){return l({type:"UPDATE_PURCHASE_CATEGORY_LAYOUT",payload:Object(u.a)(Object(u.a)({},p),{},{openCreateDrawer:!1})})},children:Object(Ze.jsx)(vu,{})},"create")],title:"ALL TRANSACTIONS",fixedHeader:!0,fixedHeaderScrollHeight:"90vh",highlightOnHover:!0,pagination:!0,persistTableHead:!0,responsive:!0,striped:!0,subHeaderAlign:"right",subHeaderWrap:!0,columns:ju,data:j||[]})})})},Ou=function(){return Object(Ze.jsx)(pa,{title:"Transactions",children:Object(Ze.jsx)(fu,{})})},hu=function(){return[Object(Ze.jsx)(Ur,{path:"/home",exact:!0,component:Na},"home"),Object(Ze.jsx)(Ur,{path:"/users",exact:!0,component:rc},"users"),Object(Ze.jsx)(Ur,{path:"/customers",exact:!0,component:Oi},"customers"),Object(Ze.jsx)(Ur,{path:"/suppliers",exact:!0,component:Ui},"suppliers"),Object(Ze.jsx)(Ur,{path:"/invoices",match:!0,component:Qo},"invoices"),Object(Ze.jsx)(Ur,{path:"/purchases",exact:!0,component:Xo},"purchases"),Object(Ze.jsx)(Ur,{path:"/purchase-categories",exact:!0,component:ls},"purchase-categories"),Object(Ze.jsx)(Ur,{path:"/services",exact:!0,component:ys},"services"),Object(Ze.jsx)(Ur,{path:"/products",exact:!0,component:qs},"products"),Object(Ze.jsx)(Ur,{path:"/weekly-sales",exact:!0,component:Ks},"weekly-sales"),Object(Ze.jsx)(Ur,{path:"/approvals",exact:!0,component:xl},"approvals"),Object(Ze.jsx)(Ur,{path:"/quotes",match:!0,component:iu},"quotes"),Object(Ze.jsx)(Ur,{path:"/transactions",match:!0,component:Ou},"transactions")]},mu=n.p+"static/media/error-404.037383fb.png",xu=function(){var e=lt();return Object(Ze.jsx)(pa,{title:"Error 404",children:Object(Ze.jsxs)(dt.a,{height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",children:[Object(Ze.jsx)("img",{alt:"error-404",src:mu,height:"340"}),Object(Ze.jsx)(dt.a,{p:3,children:Object(Ze.jsx)(jt.a,{variant:"body1",className:Object(_r.a)(e.fw3),children:"PAGE NOT FOUND"})}),Object(Ze.jsxs)(dt.a,{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"row",children:[Object(Ze.jsx)(dt.a,{p:1,width:200,children:Object(Ze.jsx)(Yt.a,{variant:"outlined",color:"primary",fullWidth:!0,children:"GO BACK"})}),Object(Ze.jsx)(dt.a,{p:1,width:200,children:Object(Ze.jsx)(Yt.a,{variant:"outlined",color:"primary",fullWidth:!0,children:"HOME"})})]})]})})},gu=function(){var e=Object(Ke.c)(Ue).isAuthenticated;return Object(Ze.jsx)(wn,{children:Object(Ze.jsx)(Tn.a,{children:Object(Ze.jsxs)(Sn.d,{children:[Object(Ze.jsx)(Sn.b,{exact:!0,path:"/",children:Object(Ze.jsx)(Sn.a,{to:e?"/home":"/sign-in"})}),[].concat(Object(Me.a)(Mr()),Object(Me.a)(hu())).map((function(e){return e})),Object(Ze.jsx)(Sn.b,{component:xu})]})})})},yu=n(1162),wu=(n(1052),function(e){var t=e.children,n=Object(r.useState)(!0),a=Object(Pe.a)(n,2),c=a[0],i=a[1],o=za()().unix(),s=Object(Ke.b)(),l=function(){var e=localStorage.authToken;if(e){var t=Object($n.a)(e);if(!function(e){return za()(e.exp).diff(o)>0}(t))return s(nr()),void i(!1);s(rr(t)),Pn(e),i(!1)}else i(!1)};return Object(r.useEffect)((function(){_n.a.defaults.baseURL="api/",_n.a.defaults.headers.post["Content-Type"]="application/json",l(),function(e){_n.a.interceptors.response.use((function(e){return e}),(function(t){var n;return 401===(null===t||void 0===t||null===(n=t.response)||void 0===n?void 0:n.status)&&(e(nr()),window.location.href="/#/sign-in"),Promise.reject(t)}))}(s)})),Object(Ze.jsxs)(Ze.Fragment,{children:[!c&&t,Object(Ze.jsx)(er.a,{})]})}),Su={},Cu=function(){return Object(Ze.jsx)(Cr.b,{context:Su,children:Object(Ze.jsxs)(Ke.a,{store:Ne,children:[Object(Ze.jsxs)(Cr.a,{children:[Object(Ze.jsx)("meta",{charSet:"utf-8"}),Object(Ze.jsx)("title",{children:"MANEJA"}),Object(Ze.jsx)("link",{rel:"canonical",href:"http://app.autopro-fit.co.uk"})]}),Object(Ze.jsx)(yu.a,{theme:ut,children:Object(Ze.jsx)(wu,{children:Object(Ze.jsx)(gu,{})})})]})})},Tu=function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,1403)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};i.a.render(Object(Ze.jsx)(a.a.StrictMode,{children:Object(Ze.jsx)(Cu,{})}),document.getElementById("root")),Tu()},554:function(e,t,n){},555:function(e,t,n){},774:function(e,t){},776:function(e,t){},806:function(e,t){},807:function(e,t){},884:function(e,t){}},[[1053,1,3]]]);